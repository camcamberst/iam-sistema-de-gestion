(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6638],{7094:function(e,r,a){Promise.resolve().then(a.bind(a,1947))},1947:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return g}});var t=a(7437),s=a(2265),l=a(1396),d=a.n(l),i=a(4033),o=a(5922),n=a(9853),c=a(4930),m=a.n(c),h=a(3782),x=a(2344);let u=m()(()=>Promise.all([a.e(6918),a.e(4452),a.e(2296)]).then(a.bind(a,4452)),{loadableGenerated:{webpack:()=>[4452]},ssr:!1});function g(e){var r;let{children:a}=e,l=(0,i.usePathname)(),[c,m]=(0,s.useState)(null),[g,b]=(0,s.useState)(!1),[f,p]=(0,s.useState)(!1),[v,y]=(0,s.useState)(null),[k,j]=(0,s.useState)(null),w=(0,s.useRef)(null),[N,C]=(0,s.useState)(!1),[L,I]=(0,s.useState)(!1),[M,S]=(0,s.useState)(new Set),E=async()=>{try{var e,r,a,t;p(!0);let{data:s}=await o.supabase.auth.getUser(),l=null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.id;if(!l){y(null);return}let{data:d}=await o.supabase.from("users").select("id,name,email,role").eq("id",l).single(),i=[];if(d&&"super_admin"!==d.role){let{data:e}=await o.supabase.from("user_groups").select("groups(name)").eq("user_id",l);i=(e||[]).map(e=>{var r;return null===(r=e.groups)||void 0===r?void 0:r.name}).filter(Boolean)}y({id:(null==d?void 0:d.id)||l,name:(null==d?void 0:d.name)||(null===(a=s.user)||void 0===a?void 0:null===(r=a.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",email:(null==d?void 0:d.email)||(null===(t=s.user)||void 0===t?void 0:t.email)||"",role:(null==d?void 0:d.role)||"modelo",groups:i})}finally{p(!1)}};(0,s.useEffect)(()=>{C(!0)},[]),(0,s.useEffect)(()=>{I(!1)},[l]),(0,s.useEffect)(()=>(L?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[L]),(0,s.useEffect)(()=>{if(!v&&!f){try{let r=localStorage.getItem("user");if(r){let a=JSON.parse(r);if((null==a?void 0:a.id)&&(null==a?void 0:a.role)){var e;y({id:a.id,name:a.name||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"Usuario",email:a.email||"",role:a.role,groups:a.groups||[]})}}}catch(e){}E()}},[N]);let _=e=>{k&&(clearTimeout(k),j(null)),m(e)},A=()=>{j(setTimeout(()=>{m(null)},300))},B=()=>{k&&(clearTimeout(k),j(null))},G=()=>{j(setTimeout(()=>{m(null)},150))};(0,s.useEffect)(()=>()=>{k&&clearTimeout(k)},[k]),(0,s.useEffect)(()=>{let e=e=>{w.current&&!w.current.contains(e.target)&&b(!1)};return g&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[g]);let z=(0,s.useMemo)(()=>{let e="modelo";if(null==v?void 0:v.role)e=v.role;else if(N){let r=localStorage.getItem("user");if(r)try{e=JSON.parse(r).role||"modelo"}catch(e){console.error("Error parsing user data:",e)}}let r=[{id:"calculator",label:"modelo"===e?"Mi Calculadora":"Gesti\xf3n Calculadora",href:"#",subItems:"modelo"===e?[{label:"Ingresar Valores",href:"/model/calculator"}]:[]}];if("super_admin"===e||"admin"===e){r.unshift({id:"users",label:"Gesti\xf3n Usuarios",href:"#",subItems:[{label:"Crear Usuario",href:"/admin/users/create"},{label:"Consultar Usuarios",href:"/admin/users"}]}),r.push({id:"anticipos",label:"Gesti\xf3n Anticipos",href:"#",subItems:[{label:"Solicitudes Pendientes",href:"/admin/anticipos/pending"},{label:"Historial Anticipos",href:"/admin/anticipos/history"}]}),r.push({id:"sedes",label:"Gesti\xf3n Agencia",href:"#",subItems:[{label:"Gestionar Sedes",href:"/admin/sedes/gestionar"},{label:"Portafolio Modelos",href:"/admin/sedes/portafolio"},{label:"Dashboard Sedes",href:"/admin/sedes/dashboard"},{label:"Gestionar Afiliados",href:"/admin/affiliates/gestionar"}]});let e=r.findIndex(e=>"calculator"===e.id);-1!==e&&(r[e].subItems=[{label:"Definir RATES",href:"/admin/rates"},{label:"Crear Plataforma",href:"/admin/calculator/create-platform"},{label:"Configurar Calculadora",href:"/admin/calculator/config"},{label:"Ver Calculadora Modelo",href:"/admin/calculator/view-model"}])}return r},[v,N]),U=e=>l===e,P=e=>{var r;return null===(r=e.subItems)||void 0===r?void 0:r.some(e=>l===e.href)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[(0,t.jsx)("header",{className:"bg-white dark:bg-gray-900 backdrop-blur-md border border-white/20 dark:border-gray-700/30 sticky top-0 z-[99999] shadow-lg dark:shadow-lg dark:shadow-purple-900/15 dark:ring-0.5 dark:ring-purple-400/20",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-14 md:h-16",children:[(0,t.jsx)("div",{className:"flex items-center flex-1 min-w-0 pr-1 sm:pr-0",children:(0,t.jsxs)(d(),{href:"/superadmin/dashboard",className:"flex items-center space-x-1 sm:space-x-1.5 md:space-x-3 group",children:[(0,t.jsx)("div",{className:"w-6 h-6 sm:w-7 md:w-9 sm:h-7 md:h-9 bg-gradient-to-br from-gray-900 to-black dark:from-gray-100 dark:to-gray-300 rounded-md sm:rounded-lg md:rounded-xl flex items-center justify-center shadow-md border border-white/20 dark:border-gray-700/30 group-hover:shadow-lg transition-all duration-300 flex-shrink-0",children:(0,t.jsx)("span",{className:"text-white dark:text-gray-900 font-bold text-[9px] sm:text-[10px] md:text-sm tracking-wider",children:"AIM"})}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0 hidden sm:flex",children:[(0,t.jsx)("span",{className:"text-xs sm:text-sm md:text-lg font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent truncate leading-tight",children:"Sistema de Gesti\xf3n"}),(0,t.jsx)("span",{className:"hidden md:block text-xs text-gray-600 dark:text-gray-300 font-medium tracking-wide",children:"Agencia Innova"})]})]})}),(0,t.jsx)("nav",{className:"hidden md:flex items-center space-x-6",children:z.map(e=>(0,t.jsxs)("div",{className:"relative",onMouseEnter:()=>_(e.id),onMouseLeave:A,children:["#"===e.href?(0,t.jsx)("span",{className:"px-4 py-2 text-sm font-medium transition-all duration-300 cursor-default whitespace-nowrap rounded-lg hover:bg-white/60 dark:hover:bg-gray-800/60 hover:backdrop-blur-sm hover:shadow-sm ".concat(P(e)?"text-gray-900 dark:text-white bg-white/50 dark:bg-gray-800/50 shadow-sm":"text-gray-600 dark:text-white hover:text-gray-900 dark:hover:text-gray-200"),children:e.label}):(0,t.jsx)(d(),{href:e.href,className:"px-4 py-2 text-sm font-medium transition-all duration-300 whitespace-nowrap rounded-lg hover:bg-white/60 dark:hover:bg-gray-800/60 hover:backdrop-blur-sm hover:shadow-sm ".concat(U(e.href)||P(e)?"text-gray-900 dark:text-white bg-white/50 dark:bg-gray-800/50 shadow-sm":"text-gray-600 dark:text-white hover:text-gray-900 dark:hover:text-gray-200"),children:e.label}),c===e.id&&(0,t.jsx)("div",{className:"absolute top-full left-0 mt-2 w-72 sm:w-80 bg-white/95 backdrop-blur-md border border-white/30 rounded-xl shadow-xl z-[9999999] animate-in slide-in-from-top-2 duration-200",onMouseEnter:B,onMouseLeave:G,children:(0,t.jsx)("div",{className:"p-2",children:e.subItems.map(e=>(0,t.jsx)(d(),{href:e.href,className:"block px-4 py-3 text-sm transition-all duration-200 rounded-lg ".concat(U(e.href)?"bg-blue-50/80 text-blue-900 font-medium shadow-sm border border-blue-200/30":"text-gray-600 hover:bg-white/60 hover:text-gray-900 hover:shadow-sm"),children:e.label},e.href))})})]},e.id))}),(0,t.jsxs)("div",{className:"flex items-center space-x-1 sm:space-x-1.5 md:space-x-3 ".concat(L?"hidden":"flex"),children:[(0,t.jsx)("button",{className:"hidden md:flex p-2 md:p-2.5 text-gray-600 hover:text-gray-900 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",children:(0,t.jsx)("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,t.jsx)("div",{className:"scale-75 sm:scale-90 md:scale-100",children:(0,t.jsx)(x.Z,{})}),(0,t.jsxs)("div",{className:"relative",ref:w,children:[(0,t.jsxs)("button",{onClick:()=>{b(e=>!e),v||f||E()},className:"flex items-center justify-center text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 p-1 sm:p-1.5 md:px-3 md:py-2 rounded-lg border border-white/20 dark:border-gray-700/30 hover:bg-white/60 dark:hover:bg-gray-800/60 hover:shadow-sm transition-all duration-200 backdrop-blur-sm",children:[(0,t.jsx)("div",{className:"w-5 h-5 sm:w-6 md:w-7 sm:h-6 md:h-7 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 text-white flex items-center justify-center shadow-sm",children:(0,t.jsx)("svg",{className:"w-2.5 h-2.5 sm:w-3 md:w-4 sm:h-3 md:h-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M10 10a4 4 0 100-8 4 4 0 000 8zm-7 8a7 7 0 1114 0H3z"})})}),(0,t.jsx)("span",{className:"hidden md:block text-sm font-medium ml-2",children:"Cuenta"}),(0,t.jsx)("svg",{className:"hidden md:block w-4 h-4 text-gray-400 dark:text-gray-500 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g&&(0,t.jsx)("div",{className:"absolute right-0 mt-3 w-64 sm:w-72 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md border border-white/30 dark:border-gray-700/30 rounded-lg shadow-xl p-3 sm:p-4 z-50 animate-in slide-in-from-top-2 duration-200",children:f?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-gray-600 border-t-gray-400 rounded-full mx-auto mb-2"}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Cargandoâ€¦"})]}):v?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-gray-700 text-white flex items-center justify-center shadow-sm",children:(0,t.jsx)("span",{className:"text-sm font-semibold",children:v.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:v.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-300 truncate",children:[String(v.role).replace("_"," ").charAt(0).toUpperCase()+String(v.role).replace("_"," ").slice(1)," \xb7 ",v.email]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:["super_admin"!==v.role&&(null===(r=v.groups)||void 0===r?void 0:r.length)>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-400 font-medium",children:"modelo"===v.role?"Grupo":"Grupos"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 justify-end",children:v.groups.map((e,r)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-800 text-white rounded-md text-xs font-medium",children:e},r))})]}),(0,t.jsx)("div",{className:"space-y-1",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-400 font-medium",children:"ID"}),(0,t.jsx)("button",{onClick:()=>navigator.clipboard.writeText(v.id),className:"text-gray-200 font-mono text-xs hover:text-gray-400 transition-colors duration-200 cursor-pointer",title:"Hacer clic para copiar",children:v.id})]})})]}),(0,t.jsx)("div",{className:"pt-3 border-t border-gray-700",children:(0,t.jsxs)("button",{onClick:async()=>{await (0,n.P1)(),y(null),location.href="/"},className:"w-full px-3 py-2 text-xs rounded-md bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-200 hover:text-gray-100 transition-all duration-200 font-medium flex items-center justify-center space-x-1.5",children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,t.jsx)("span",{children:"Cerrar sesi\xf3n"})]})})]}):(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"No autenticado"})]})})]})]}),(0,t.jsx)("button",{onClick:()=>I(!L),className:"md:hidden text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 p-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-gray-800/60 transition-all duration-200 flex-shrink-0","aria-label":"Toggle mobile menu",children:L?(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})}),L&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999998] md:hidden",onClick:()=>I(!1)}),(0,t.jsx)("div",{className:"fixed top-14 md:top-16 left-0 right-0 bottom-0 bg-white dark:bg-gray-900 z-[9999999] md:hidden overflow-y-auto animate-in slide-in-from-top-2 duration-300",children:(0,t.jsxs)("div",{className:"p-4 space-y-2",children:[z.length>0?z.map(e=>{let r=M.has(e.id);return(0,t.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-2 mb-2",children:"#"===e.href?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>{if(e.subItems&&e.subItems.length>0){let r=new Set(M);r.has(e.id)?r.delete(e.id):r.add(e.id),S(r)}},className:"w-full flex items-center justify-between px-4 py-3 text-left rounded-lg transition-all duration-200 ".concat(P(e)?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"),children:[(0,t.jsx)("span",{className:"font-medium",children:e.label}),e.subItems&&e.subItems.length>0&&(0,t.jsx)("svg",{className:"w-5 h-5 transition-transform ".concat(r?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&e.subItems&&e.subItems.length>0&&(0,t.jsx)("div",{className:"mt-2 ml-4 space-y-1",children:e.subItems.map(e=>(0,t.jsx)(d(),{href:e.href,className:"block px-4 py-2 text-sm rounded-lg transition-all ".concat(U(e.href)?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"),onClick:()=>I(!1),children:e.label},e.href))})]}):(0,t.jsx)(d(),{href:e.href,className:"block px-4 py-3 rounded-lg transition-all duration-200 ".concat(U(e.href)?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"),onClick:()=>I(!1),children:e.label})},e.id)}):(0,t.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm px-4 py-3",children:"Cargando men\xfa..."}),v&&(0,t.jsx)("div",{className:"pt-4 mt-4 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 text-white flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-sm font-semibold",children:v.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:v.name}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:v.email})]})]}),(0,t.jsxs)("button",{onClick:async()=>{await (0,n.P1)(),y(null),I(!1),location.href="/"},className:"w-full px-4 py-2 text-sm rounded-lg bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30 transition-all duration-200 font-medium flex items-center justify-center space-x-2",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,t.jsx)("span",{children:"Cerrar sesi\xf3n"})]})]})})]})})]}),(0,t.jsx)("main",{className:"min-h-screen",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 md:py-8",children:a})}),v&&("super_admin"===v.role||"admin"===v.role||"modelo"===v.role)&&(0,t.jsx)(h.Z,{children:(0,t.jsx)(u,{userId:v.id,userRole:v.role})})]})}}},function(e){e.O(0,[5257,1396,2151,2971,4938,1744],function(){return e(e.s=7094)}),_N_E=e.O()}]);