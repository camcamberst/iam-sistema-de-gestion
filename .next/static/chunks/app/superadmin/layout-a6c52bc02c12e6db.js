(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6638],{7094:function(e,r,a){Promise.resolve().then(a.bind(a,1947))},1947:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return u}});var t=a(7437),s=a(2265),l=a(1396),i=a.n(l),o=a(4033),d=a(5922),n=a(9853),c=a(842),m=a(2344);function u(e){var r;let{children:a}=e,l=(0,o.usePathname)(),[u,h]=(0,s.useState)(null),[x,g]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null),[y,w]=(0,s.useState)(null),j=(0,s.useRef)(null),[k,N]=(0,s.useState)(!1),C=async()=>{try{var e,r,a,t;f(!0);let{data:s}=await d.O.auth.getUser(),l=null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.id;if(!l){v(null);return}let{data:i}=await d.O.from("users").select("id,name,email,role").eq("id",l).single(),o=[];if(i&&"super_admin"!==i.role){let{data:e}=await d.O.from("user_groups").select("groups(name)").eq("user_id",l);o=(e||[]).map(e=>{var r;return null===(r=e.groups)||void 0===r?void 0:r.name}).filter(Boolean)}v({id:(null==i?void 0:i.id)||l,name:(null==i?void 0:i.name)||(null===(a=s.user)||void 0===a?void 0:null===(r=a.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",email:(null==i?void 0:i.email)||(null===(t=s.user)||void 0===t?void 0:t.email)||"",role:(null==i?void 0:i.role)||"modelo",groups:o})}finally{f(!1)}};(0,s.useEffect)(()=>{N(!0)},[]),(0,s.useEffect)(()=>{if(!b&&!p){try{let r=localStorage.getItem("user");if(r){let a=JSON.parse(r);if((null==a?void 0:a.id)&&(null==a?void 0:a.role)){var e;v({id:a.id,name:a.name||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"Usuario",email:a.email||"",role:a.role,groups:a.groups||[]})}}}catch(e){}C()}},[k]);let S=e=>{y&&(clearTimeout(y),w(null)),h(e)},L=()=>{w(setTimeout(()=>{h(null)},300))},M=()=>{y&&(clearTimeout(y),w(null))},I=()=>{w(setTimeout(()=>{h(null)},150))};(0,s.useEffect)(()=>()=>{y&&clearTimeout(y)},[y]),(0,s.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&g(!1)};return x&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[x]);let _=(()=>{let e=localStorage.getItem("user"),r=e?JSON.parse(e).role:"modelo",a=[{id:"calculator",label:"modelo"===r?"Mi Calculadora":"Gesti\xf3n Calculadora",href:"#",subItems:"modelo"===r?[{label:"Ingresar Valores",href:"/model/calculator"}]:[]}];if("super_admin"===r||"admin"===r){a.unshift({id:"users",label:"Gesti\xf3n Usuarios",href:"#",subItems:[{label:"Crear Usuario",href:"/admin/users/create"},{label:"Consultar Usuarios",href:"/admin/users"}]}),a.push({id:"anticipos",label:"Gesti\xf3n Anticipos",href:"#",subItems:[{label:"Solicitudes Pendientes",href:"/admin/anticipos/pending"},{label:"Historial Anticipos",href:"/admin/anticipos/history"}]}),a.push({id:"sedes",label:"Gesti\xf3n Sedes",href:"#",subItems:[{label:"Gestionar Sedes",href:"/admin/sedes/gestionar"},{label:"Portafolio Modelos",href:"/admin/sedes/portafolio"},{label:"Dashboard Sedes",href:"/admin/sedes/dashboard"}]});let e=a.findIndex(e=>"calculator"===e.id);-1!==e&&(a[e].subItems=[{label:"Definir RATES",href:"/admin/rates"},{label:"Configurar Calculadora",href:"/admin/calculator/config"},{label:"Ver Calculadora Modelo",href:"/admin/calculator/view-model"}])}return a})(),E=e=>l===e,G=e=>{var r;return null===(r=e.subItems)||void 0===r?void 0:r.some(e=>l===e.href)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[(0,t.jsx)("header",{className:"bg-white dark:bg-gray-900 backdrop-blur-md border border-white/20 dark:border-gray-700/30 sticky top-0 z-[99999] shadow-lg dark:shadow-lg dark:shadow-purple-900/15 dark:ring-0.5 dark:ring-purple-400/20",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)(i(),{href:"/superadmin/dashboard",className:"flex items-center space-x-3 group",children:[(0,t.jsx)("div",{className:"w-9 h-9 bg-gradient-to-br from-gray-900 to-black dark:from-gray-100 dark:to-gray-300 rounded-xl flex items-center justify-center shadow-md border border-white/20 dark:border-gray-700/30 group-hover:shadow-lg transition-all duration-300",children:(0,t.jsx)("span",{className:"text-white dark:text-gray-900 font-bold text-sm tracking-wider",children:"AIM"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-lg font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent whitespace-nowrap",children:"Sistema de Gesti\xf3n"}),(0,t.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-300 font-medium tracking-wide",children:"Agencia Innova"})]})]})}),(0,t.jsx)("nav",{className:"hidden md:flex items-center space-x-6",children:_.map(e=>(0,t.jsxs)("div",{className:"relative",onMouseEnter:()=>S(e.id),onMouseLeave:L,children:["#"===e.href?(0,t.jsx)("span",{className:"px-4 py-2 text-sm font-medium transition-all duration-300 cursor-default whitespace-nowrap rounded-lg hover:bg-white/60 dark:hover:bg-gray-800/60 hover:backdrop-blur-sm hover:shadow-sm ".concat(G(e)?"text-gray-900 dark:text-white bg-white/50 dark:bg-gray-800/50 shadow-sm":"text-gray-600 dark:text-white hover:text-gray-900 dark:hover:text-gray-200"),children:e.label}):(0,t.jsx)(i(),{href:e.href,className:"px-4 py-2 text-sm font-medium transition-all duration-300 whitespace-nowrap rounded-lg hover:bg-white/60 dark:hover:bg-gray-800/60 hover:backdrop-blur-sm hover:shadow-sm ".concat(E(e.href)||G(e)?"text-gray-900 dark:text-white bg-white/50 dark:bg-gray-800/50 shadow-sm":"text-gray-600 dark:text-white hover:text-gray-900 dark:hover:text-gray-200"),children:e.label}),u===e.id&&(0,t.jsx)("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/95 backdrop-blur-md border border-white/30 rounded-xl shadow-xl z-[9999999] animate-in slide-in-from-top-2 duration-200",onMouseEnter:M,onMouseLeave:I,children:(0,t.jsx)("div",{className:"p-2",children:e.subItems.map(e=>(0,t.jsx)(i(),{href:e.href,className:"block px-4 py-3 text-sm transition-all duration-200 rounded-lg ".concat(E(e.href)?"bg-blue-50/80 text-blue-900 font-medium shadow-sm border border-blue-200/30":"text-gray-600 hover:bg-white/60 hover:text-gray-900 hover:shadow-sm"),children:e.label},e.href))})})]},e.id))}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("button",{className:"p-2.5 text-gray-600 hover:text-gray-900 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,t.jsx)(m.Z,{}),(0,t.jsxs)("div",{className:"relative",ref:j,children:[(0,t.jsxs)("button",{onClick:()=>{g(e=>!e),b||p||C()},className:"flex items-center space-x-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 px-3 py-2 rounded-lg border border-white/20 dark:border-gray-700/30 hover:bg-white/60 dark:hover:bg-gray-800/60 hover:shadow-sm transition-all duration-200 backdrop-blur-sm",children:[(0,t.jsx)("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 text-white flex items-center justify-center shadow-sm",children:(0,t.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M10 10a4 4 0 100-8 4 4 0 000 8zm-7 8a7 7 0 1114 0H3z"})})}),(0,t.jsx)("span",{className:"hidden sm:block text-sm font-medium",children:"Cuenta"}),(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),x&&(0,t.jsx)("div",{className:"absolute right-0 mt-3 w-72 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md border border-white/30 dark:border-gray-700/30 rounded-lg shadow-xl p-4 z-50 animate-in slide-in-from-top-2 duration-200",children:p?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-gray-600 border-t-gray-400 rounded-full mx-auto mb-2"}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Cargandoâ€¦"})]}):b?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-gray-700 text-white flex items-center justify-center shadow-sm",children:(0,t.jsx)("span",{className:"text-sm font-semibold",children:b.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:b.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-300 truncate",children:[String(b.role).replace("_"," ").charAt(0).toUpperCase()+String(b.role).replace("_"," ").slice(1)," \xb7 ",b.email]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:["super_admin"!==b.role&&(null===(r=b.groups)||void 0===r?void 0:r.length)>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-400 font-medium",children:"modelo"===b.role?"Grupo":"Grupos"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 justify-end",children:b.groups.map((e,r)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-800 text-white rounded-md text-xs font-medium",children:e},r))})]}),(0,t.jsx)("div",{className:"space-y-1",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-400 font-medium",children:"ID"}),(0,t.jsx)("button",{onClick:()=>navigator.clipboard.writeText(b.id),className:"text-gray-200 font-mono text-xs hover:text-gray-400 transition-colors duration-200 cursor-pointer",title:"Hacer clic para copiar",children:b.id})]})})]}),(0,t.jsx)("div",{className:"pt-3 border-t border-gray-700",children:(0,t.jsxs)("button",{onClick:async()=>{await (0,n.P1)(),v(null),location.href="/"},className:"w-full px-3 py-2 text-xs rounded-md bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-200 hover:text-gray-100 transition-all duration-200 font-medium flex items-center justify-center space-x-1.5",children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,t.jsx)("span",{children:"Cerrar sesi\xf3n"})]})})]}):(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"No autenticado"})]})})]})]}),(0,t.jsx)("div",{className:"md:hidden text-gray-600 hover:text-gray-900 p-2 cursor-default",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})}),(0,t.jsx)("main",{className:"min-h-screen",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a})}),b&&"super_admin"===b.role&&(0,t.jsx)(c.Z,{userId:b.id,userRole:b.role})]})}}},function(e){e.O(0,[5257,9922,3905,2971,4938,1744],function(){return e(e.s=7094)}),_N_E=e.O()}]);