(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6035,5922],{1881:function(e,r,s){Promise.resolve().then(s.bind(s,7896))},7896:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return i}});var a=s(7437),o=s(2265),t=s(4033),l=s(5922);function i(){var e,r,s,i,d,n;let[c,u]=(0,o.useState)(!1),[m,h]=(0,o.useState)(!1),[b,x]=(0,o.useState)(!1),[v,g]=(0,o.useState)(!1),[p,y]=(0,o.useState)(null),[D,f]=(0,o.useState)(null),[j,E]=(0,o.useState)(null);(0,t.useRouter)();let w=async()=>{try{let{data:{session:e},error:r}=await l.supabase.auth.getSession();if(r)return console.error("Error obteniendo sesi\xf3n:",r),null;if(!e)return console.error("No hay sesi\xf3n activa"),null;let s=e.expires_at;if(s){let r=Math.floor(Date.now()/1e3);if(s-r<60){let{data:{session:r},error:s}=await l.supabase.auth.refreshSession();if(s)return console.error("Error refrescando sesi\xf3n:",s),e.access_token;if(r)return r.access_token}}return e.access_token}catch(e){return console.error("Error obteniendo token:",e),null}},N=async()=>{h(!0),E(null),f(null);try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDD0D Verificando estado...");let r=await fetch("/api/admin/emergency-archive-p2/verify",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch(a){e={error:s||"Error ".concat(r.status,": ").concat(r.statusText)}}throw console.error("❌ Error en respuesta:",e),Error(e.error||"Error ".concat(r.status,": ").concat(r.statusText))}let s=await r.json();console.log("✅ Verificaci\xf3n exitosa:",s),f(s)}catch(e){console.error("❌ Error en handleVerify:",e),E(e.message||"Error desconocido")}finally{h(!1)}},_=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(confirm(e?'\uD83D\uDD25 \xbfEst\xe1s seguro de que quieres FORZAR la eliminaci\xf3n de TODOS los valores de P2 de diciembre?\n\n⚠️ PELIGRO: Esto eliminar\xe1 valores INCLUSO si NO est\xe1n archivados.\n\nSolo usa esto si est\xe1s seguro de que los valores ya fueron archivados o si necesitas resetear las calculadoras a "0".':'⚠️ \xbfEst\xe1s seguro de que quieres eliminar los valores de P2 de diciembre de "Mi Calculadora"?\n\nEsto eliminar\xe1 los valores de model_values SOLO si est\xe1n archivados en calculator_history.\n\nLos valores archivados en "Mi Historial" NO se ver\xe1n afectados.')){g(!0),E(null),y(null);try{let r;let s=await w();if(!s)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDDD1️ Eliminando valores..."),console.log("\uD83D\uDD10 Token obtenido:",s.substring(0,20)+"...");let a=await fetch(e?"/api/admin/emergency-archive-p2/delete?force=true":"/api/admin/emergency-archive-p2/delete",{method:"DELETE",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});405===a.status&&(console.log("⚠️ DELETE no permitido, intentando con POST..."),a=await fetch(e?"/api/admin/emergency-archive-p2/delete?force=true":"/api/admin/emergency-archive-p2/delete",{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:e?JSON.stringify({force:!0}):void 0})),console.log("\uD83D\uDCE1 Respuesta status:",a.status),console.log("\uD83D\uDCE1 Respuesta headers:",Object.fromEntries(a.headers.entries()));let o=await a.text();if(console.log("\uD83D\uDCE1 Respuesta body (raw):",o.substring(0,500)),!a.ok){let e;try{e=JSON.parse(o)}catch(r){e={error:o||"Error ".concat(a.status,": ").concat(a.statusText)}}throw console.error("❌ Error en respuesta:",e),Error(e.error||e.message||"Error ".concat(a.status,": ").concat(a.statusText))}try{r=JSON.parse(o)}catch(e){throw Error("Respuesta no v\xe1lida del servidor")}console.log("✅ Eliminaci\xf3n exitosa:",r),y(r),setTimeout(()=>{N()},1e3)}catch(e){console.error("❌ Error en handleDelete:",e),E(e.message||e.toString()||"Error desconocido"),console.error("❌ Stack trace:",e.stack)}finally{g(!1)}}},k=async()=>{if(confirm("⚠️ \xbfEst\xe1s seguro de que quieres eliminar los registros archivados del per\xedodo P2 de diciembre?\n\nEsto permitir\xe1 volver a archivar con los valores correctos.")){x(!0),E(null),y(null);try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83E\uDDF9 Limpiando registros incorrectos...");let r=await fetch("/api/admin/emergency-archive-p2/clean",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch(a){e={error:s||"Error ".concat(r.status,": ").concat(r.statusText)}}throw console.error("❌ Error en respuesta:",e),Error(e.error||"Error ".concat(r.status,": ").concat(r.statusText))}let s=await r.json();console.log("✅ Limpieza exitosa:",s),y(s),setTimeout(()=>{N()},1e3)}catch(e){console.error("❌ Error en handleClean:",e),E(e.message||"Error desconocido")}finally{x(!1)}}},O=async()=>{if(confirm("\xbfEst\xe1s seguro de que quieres archivar el per\xedodo 16-31 de diciembre?\n\nEsto archivar\xe1 los valores en calculator_history pero NO eliminar\xe1 los valores de model_values.")){u(!0),E(null),y(null);try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDE80 Iniciando archivado...");let r=await fetch("/api/admin/emergency-archive-p2",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch(a){e={error:s||"Error ".concat(r.status,": ").concat(r.statusText)}}throw console.error("❌ Error en respuesta:",e),Error(e.error||"Error ".concat(r.status,": ").concat(r.statusText))}let s=await r.json();console.log("✅ Archivado exitoso:",s),y(s),setTimeout(()=>{N()},1e3)}catch(e){console.error("❌ Error en handleArchive:",e),E(e.message||"Error desconocido")}finally{u(!1)}}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4 sm:p-6 lg:p-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 sm:p-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDEA8 Archivado de Emergencia: P2 de Diciembre 2025"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Archiva los valores por plataforma del per\xedodo 16-31 de diciembre en calculator_history"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h2",{className:"font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"⚠️ IMPORTANTE:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-sm text-yellow-700 dark:text-yellow-300 space-y-1",children:[(0,a.jsx)("li",{children:"Este proceso SOLO archiva, NO elimina valores de model_values"}),(0,a.jsx)("li",{children:"Los valores se mantienen en model_values para verificaci\xf3n"}),(0,a.jsx)("li",{children:"Solo archiva valores hasta las 23:59:59 del 31 de diciembre"}),(0,a.jsx)("li",{children:"Una vez verificado, puedes eliminar los valores residuales manualmente"})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("button",{onClick:N,disabled:m||c||b||v,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:m?"⏳ Verificando...":"\uD83D\uDD0D Verificar Estado"}),(0,a.jsx)("button",{onClick:k,disabled:c||m||b||v,className:"px-6 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:b?"⏳ Limpiando...":"\uD83E\uDDF9 Limpiar Registros Incorrectos"}),(0,a.jsx)("button",{onClick:O,disabled:c||m||b||v,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:c?"⏳ Archivando...":"\uD83D\uDE80 Archivar P2 de Diciembre"}),(0,a.jsx)("button",{onClick:()=>_(!1),disabled:c||m||b||v,className:"px-6 py-3 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:v?"⏳ Eliminando...":"\uD83D\uDDD1️ Eliminar Valores de Mi Calculadora"}),(0,a.jsx)("button",{onClick:()=>_(!0),disabled:c||m||b||v,className:"px-6 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:v?"⏳ Eliminando...":"\uD83D\uDD25 Forzar Eliminaci\xf3n (Sin Verificar Archivo)"})]}),(0,a.jsxs)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border-2 border-red-300 dark:border-red-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:"\uD83D\uDD04 Reset Completo de Calculadora:"}),(0,a.jsxs)("p",{className:"text-sm text-red-700 dark:text-red-300 mb-3",children:[(0,a.jsx)("strong",{children:"⚠️ PELIGRO:"})," Esto eliminar\xe1 TODOS los valores y totales de la calculadora, sin importar el per\xedodo. \xdasalo solo si necesitas resetear completamente una calculadora a cero."]}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",placeholder:"ID del modelo (UUID) - Dejar vac\xedo para resetear TODOS",id:"reset-model-id",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,a.jsx)("button",{onClick:async()=>{var e;let r=null===(e=document.getElementById("reset-model-id"))||void 0===e?void 0:e.value.trim(),s=!r;if(confirm(s?"\uD83D\uDD25 \xbfEst\xe1s seguro de que quieres RESETEAR COMPLETAMENTE TODAS las calculadoras?\n\n⚠️ PELIGRO EXTREMO: Esto eliminar\xe1 TODOS los valores y totales de TODAS las calculadoras, sin importar el per\xedodo.\n\nEsta acci\xf3n NO se puede deshacer.":"\uD83D\uDD25 \xbfEst\xe1s seguro de que quieres RESETEAR COMPLETAMENTE esta calculadora?\n\n⚠️ PELIGRO: Esto eliminar\xe1 TODOS los valores y totales de esta calculadora, sin importar el per\xedodo.\n\nEsta acci\xf3n NO se puede deshacer.")){g(!0),E(null),y(null);try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDD04 Reseteando calculadora(s)...");let a=await fetch("/api/admin/emergency-archive-p2/reset-calculator",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({modelId:r||null,resetAll:s})});if(!a.ok){let e;let r=await a.text();try{e=JSON.parse(r)}catch(s){e={error:r||"Error ".concat(a.status)}}throw Error(e.error||"Error ".concat(a.status))}let o=await a.json();y(o),console.log("✅ Reset completado:",o),setTimeout(()=>{N()},1e3)}catch(e){E(e.message||"Error desconocido")}finally{g(!1)}}},disabled:c||m||b||v,className:"w-full px-4 py-2 bg-red-700 hover:bg-red-800 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed",children:v?"⏳ Reseteando...":"\uD83D\uDD04 Resetear Calculadora(s) a Cero"})]})})]}),(0,a.jsxs)("div",{className:"mb-6 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-amber-800 dark:text-amber-200 mb-2",children:"\uD83D\uDD0D Diagn\xf3stico:"}),(0,a.jsx)("p",{className:"text-sm text-amber-700 dark:text-amber-300 mb-3",children:"Si las calculadoras no quedan en cero despu\xe9s de eliminar, usa estas herramientas para diagnosticar el problema."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:async()=>{try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa");let r=await fetch("/api/admin/emergency-archive-p2/list-models-with-values?period=p2-december",{headers:{Authorization:"Bearer ".concat(e)}}),s=await r.json();console.log("\uD83D\uDCCB Modelos con valores P2:",s),s.success&&s.models?alert("Se encontraron ".concat(s.models.length," modelo(s) con valores en P2 de diciembre.\n\nRevisa la consola del navegador para ver los detalles completos.")):alert("No se encontraron modelos con valores o hubo un error.")}catch(e){alert("Error: ".concat(e.message))}},className:"w-full px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg mb-2",children:"\uD83D\uDCCB Listar Modelos con Valores (P2 Diciembre)"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",placeholder:"ID del modelo (UUID) para diagn\xf3stico detallado",id:"diagnose-model-id",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,a.jsx)("button",{onClick:async()=>{var e,r,s,a,o,t,l,i,d;let n=null===(e=document.getElementById("diagnose-model-id"))||void 0===e?void 0:e.value;if(!n){alert("Por favor ingresa un ID de modelo");return}try{let e=await w();if(!e)throw Error("No hay sesi\xf3n activa");let c=await fetch("/api/admin/emergency-archive-p2/diagnose?modelId=".concat(n),{headers:{Authorization:"Bearer ".concat(e)}}),u=await c.json();console.log("\uD83D\uDD0D Diagn\xf3stico detallado:",u),alert("Diagn\xf3stico completado. Revisa la consola del navegador para ver los detalles.\n\nResumen:\n- Total valores (todos per\xedodos): ".concat((null===(s=u.diagnostic)||void 0===s?void 0:null===(r=s.summary)||void 0===r?void 0:r.total_values_all_periods)||0,"\n- Valores P2 (todos): ").concat((null===(o=u.diagnostic)||void 0===o?void 0:null===(a=o.summary)||void 0===a?void 0:a.p2_values_total)||0,"\n- Valores P2 despu\xe9s del l\xedmite: ").concat((null===(l=u.diagnostic)||void 0===l?void 0:null===(t=l.summary)||void 0===t?void 0:t.p2_values_after_limit)||0,"\n- Total totales: ").concat((null===(d=u.diagnostic)||void 0===d?void 0:null===(i=d.all_totals)||void 0===i?void 0:i.total)||0))}catch(e){alert("Error: ".concat(e.message))}},className:"w-full px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg",children:"\uD83D\uDD0D Diagnosticar Modelo Espec\xedfico"})]})]})]}),D&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-3",children:"\uD83D\uDCCA Estado Actual:"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,a.jsx)("strong",{children:"Registros en calculator_history:"})," ",(null===(e=D.resumen)||void 0===e?void 0:e.registros_en_history)||0]}),(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,a.jsx)("strong",{children:"Modelos archivados:"})," ",(null===(r=D.resumen)||void 0===r?void 0:r.modelos_en_history)||0]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,a.jsx)("strong",{children:"Valores en model_values:"})," ",(null===(s=D.resumen)||void 0===s?void 0:s.registros_en_model_values)||0]}),(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,a.jsx)("strong",{children:"Modelos con valores:"})," ",(null===(i=D.resumen)||void 0===i?void 0:i.modelos_en_model_values)||0]})]})]}),(null===(d=D.resumen)||void 0===d?void 0:d.modelos_solo_en_model_values)>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:[(0,a.jsxs)("p",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:["⚠️ ",D.resumen.modelos_solo_en_model_values," modelo(s) necesitan archivado"]}),D.detalles&&D.detalles.filter(e=>e.necesita_archivado).length>0&&(0,a.jsxs)("ul",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400 space-y-1 max-h-40 overflow-y-auto",children:[D.detalles.filter(e=>e.necesita_archivado).slice(0,10).map((e,r)=>(0,a.jsxs)("li",{children:["• ",e.email,": ",e.plataformas_en_model_values," plataforma(s)"]},r)),D.detalles.filter(e=>e.necesita_archivado).length>10&&(0,a.jsxs)("li",{children:["... y ",D.detalles.filter(e=>e.necesita_archivado).length-10," m\xe1s"]})]})]}),(null===(n=D.resumen)||void 0===n?void 0:n.registros_en_history)===0&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:(0,a.jsx)("p",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:"⚠️ No hay registros archivados. Ejecuta el archivado para crear el historial."})})]}),j&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:"❌ Error:"}),(0,a.jsx)("p",{className:"text-red-700 dark:text-red-300",children:j})]}),p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-green-800 dark:text-green-200 mb-2",children:"✅ Resultado:"}),(0,a.jsxs)("div",{className:"text-sm text-green-700 dark:text-green-300 space-y-1",children:[p.mensaje&&(0,a.jsx)("p",{className:"font-semibold text-base mb-2",children:p.mensaje}),p.resumen&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total modelos procesados:"})," ",p.resumen.total_modelos||0]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"✅ Exitosos:"})," ",p.resumen.exitosos||0]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"❌ Errores:"})," ",p.resumen.errores||0]}),void 0!==p.resumen.total_eliminados&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDDD1️ Valores eliminados:"})," ",p.resumen.total_eliminados||0]}),void 0!==p.resumen.total_archivados&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDCE6 Registros archivados:"})," ",p.resumen.total_archivados||0]}),void 0!==p.resumen.modelos_omitidos&&p.resumen.modelos_omitidos>0&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"⏭️ Modelos omitidos (sin archivo):"})," ",p.resumen.modelos_omitidos||0]}),void 0!==p.resumen.modelos_sin_archivo&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"⚠️ Modelos sin archivo:"})," ",p.resumen.modelos_sin_archivo||0]}),void 0!==p.resumen.residuales_restantes&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDD0D Valores residuales restantes:"})," ",p.resumen.residuales_restantes||0]})]}),void 0!==p.eliminados&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDDD1️ Total eliminados:"})," ",p.eliminados]})]})]}),p.resultados&&p.resultados.length>0&&(0,a.jsxs)(a.Fragment,{children:[p.resultados.filter(e=>!e.tiene_archivo).length>0&&(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:["⏭️ Modelos omitidos (sin archivo) (",p.resultados.filter(e=>!e.tiene_archivo).length,"):"]}),(0,a.jsx)("div",{className:"text-sm text-yellow-700 dark:text-yellow-300 space-y-2 max-h-60 overflow-y-auto",children:p.resultados.filter(e=>!e.tiene_archivo).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-yellow-200 dark:border-yellow-700 pb-2 last:border-0",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.email}),(0,a.jsx)("p",{className:"text-xs opacity-90 mt-1",children:"⏭️ Omitido: No tiene archivo en calculator_history"}),void 0!==e.valores_en_model_values&&e.valores_en_model_values>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["\uD83D\uDCCA Valores en model_values: ",e.valores_en_model_values," (no eliminados por seguridad)"]})]},r))}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-yellow-200 dark:border-yellow-700",children:(0,a.jsx)("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:'\uD83D\uDCA1 Estos modelos fueron omitidos por seguridad. Si necesitas eliminar sus valores, primero arch\xedvalos con "\uD83D\uDE80 Archivar P2 de Diciembre".'})})]}),p.resultados.filter(e=>e.tiene_archivo&&e.error).length>0&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:["❌ Modelos con errores (",p.resultados.filter(e=>e.tiene_archivo&&e.error).length,"):"]}),(0,a.jsx)("div",{className:"text-sm text-red-700 dark:text-red-300 space-y-2 max-h-60 overflow-y-auto",children:p.resultados.filter(e=>e.tiene_archivo&&e.error).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-red-200 dark:border-red-700 pb-2 last:border-0",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.email}),(0,a.jsx)("p",{className:"text-xs opacity-90 mt-1 break-words",children:e.error}),e.plataformas>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["Plataformas: ",e.plataformas]}),void 0!==e.registros_archivados&&e.registros_archivados>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["Registros archivados: ",e.registros_archivados]})]},r))})]}),p.resultados.filter(e=>!e.error&&e.valores_eliminados>0).length>0&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"✅ Modelos con valores eliminados exitosamente:"}),(0,a.jsx)("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-2 max-h-60 overflow-y-auto",children:p.resultados.filter(e=>!e.error&&e.valores_eliminados>0).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-blue-200 dark:border-blue-700 pb-2 last:border-0",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.email}),(0,a.jsxs)("p",{className:"text-xs opacity-90 mt-1",children:["✅ ",e.valores_eliminados," valor(es) eliminado(s)",e.registros_archivados>0&&" • ".concat(e.registros_archivados," registro(s) archivado(s)")]})]},r))})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"\uD83D\uDCCB Pr\xf3ximos pasos:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside text-sm text-gray-700 dark:text-gray-300 space-y-1",children:[(0,a.jsx)("li",{children:'Verificar en "Mi Historial" que los datos se muestran correctamente'}),(0,a.jsx)("li",{children:"Verificar en calculator_history que los registros est\xe1n completos"}),(0,a.jsx)("li",{children:"Una vez verificado, puedes eliminar los valores residuales de model_values si lo deseas"})]})]})]})]})})})}},5922:function(e,r,s){"use strict";s.r(r),s.d(r,{supabase:function(){return a}});let a=(0,s(5257).createClient)("https://mhernfrkvwigxdubiozm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oZXJuZnJrdndpZ3hkdWJpb3ptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MTY1NDcsImV4cCI6MjA3NDM5MjU0N30.v7qBceGTwaqyDZe5h9yLBjWwuuGEwAq6KVsAH_RNw8c")},622:function(e,r,s){"use strict";var a=s(2265),o=Symbol.for("react.element"),t=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function n(e,r,s){var a,t={},n=null,c=null;for(a in void 0!==s&&(n=""+s),void 0!==r.key&&(n=""+r.key),void 0!==r.ref&&(c=r.ref),r)l.call(r,a)&&!d.hasOwnProperty(a)&&(t[a]=r[a]);if(e&&e.defaultProps)for(a in r=e.defaultProps)void 0===t[a]&&(t[a]=r[a]);return{$$typeof:o,type:e,key:n,ref:c,props:t,_owner:i.current}}r.Fragment=t,r.jsx=n,r.jsxs=n},7437:function(e,r,s){"use strict";e.exports=s(622)},4033:function(e,r,s){e.exports=s(5313)}},function(e){e.O(0,[5257,2971,4938,1744],function(){return e(e.s=1881)}),_N_E=e.O()}]);