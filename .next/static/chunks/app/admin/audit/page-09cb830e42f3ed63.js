(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3708],{6328:function(e,t,r){Promise.resolve().then(r.bind(r,1479))},1479:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}});var a=r(7437),s=r(2265),l=r(883);function n(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[d,o]=(0,s.useState)({severity:"",action:"",success:""});(0,s.useEffect)(()=>{c()},[d]);let c=async()=>{try{n(!0);let e=await fetch("/api/audit"),r=await e.json();r.success&&t(r.logs)}catch(e){console.error("Error cargando logs:",e)}finally{n(!1)}},i=e=>{switch(e){case"critical":return"text-red-500 bg-red-900";case"high":return"text-orange-500 bg-orange-900";case"medium":return"text-yellow-500 bg-yellow-900";case"low":return"text-green-500 bg-green-900";default:return"text-gray-500 bg-gray-900"}},x=e.filter(e=>(!d.severity||e.severity===d.severity)&&(!d.action||!!e.action.includes(d.action))&&(""===d.success||e.success.toString()===d.success));return(0,a.jsx)("div",{className:"min-h-screen",style:{background:"radial-gradient(1200px 800px at 10% -10%, rgba(255,255,255,0.08), transparent), linear-gradient(180deg, rgb(16 18 27), rgb(16 18 27))"},children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white mb-6",children:"Auditor\xeda del Sistema"}),(0,a.jsxs)("div",{className:"bg-aim-card border border-aim-border rounded-xl p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Filtros"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Severidad"}),(0,a.jsx)(l.Z,{options:[{value:"",label:"Todas"},{value:"low",label:"Baja",badgeColor:"green"},{value:"medium",label:"Media",badgeColor:"yellow"},{value:"high",label:"Alta",badgeColor:"red"},{value:"critical",label:"Cr\xedtica",badgeColor:"red"}],value:d.severity,onChange:e=>o({...d,severity:e}),placeholder:"Todas las severidades",className:"bg-gray-800 border-gray-600 text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Acci\xf3n"}),(0,a.jsx)("input",{type:"text",value:d.action,onChange:e=>o({...d,action:e.target.value}),placeholder:"Buscar acci\xf3n...",className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Estado"}),(0,a.jsx)(l.Z,{options:[{value:"",label:"Todos"},{value:"true",label:"Exitoso",badgeColor:"green"},{value:"false",label:"Fallido",badgeColor:"red"}],value:d.success,onChange:e=>o({...d,success:e}),placeholder:"Todos los estados",className:"bg-gray-800 border-gray-600 text-white"})]})]})]}),(0,a.jsx)("div",{className:"bg-aim-card border border-aim-border rounded-xl",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-white mb-4",children:["Logs de Auditor\xeda (",x.length,")"]}),r?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("div",{className:"text-white text-xl",children:"Cargando logs..."})}):0===x.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("div",{className:"text-gray-400 text-lg",children:"No hay logs disponibles"})}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,a.jsx)("thead",{className:"border-b border-aim-border",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Timestamp"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Usuario"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Acci\xf3n"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Severidad"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Estado"}),(0,a.jsx)("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"IP"})]})}),(0,a.jsx)("tbody",{children:x.map(e=>(0,a.jsxs)("tr",{className:"border-b border-aim-border hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-gray-400",children:new Date(e.timestamp).toLocaleString()}),(0,a.jsxs)("td",{className:"px-6 py-4 text-white",children:[e.user_id.slice(0,8),"..."]}),(0,a.jsx)("td",{className:"px-6 py-4 text-white",children:e.action}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(i(e.severity)),children:e.severity.toUpperCase()})}),(0,a.jsx)("td",{className:"px-6 py-4 text-white",children:e.description}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.success?"text-green-400 bg-green-900":"text-red-400 bg-red-900"),children:e.success?"\xc9XITO":"FALLIDO"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.ip_address||"N/A"})]},e.id))})]})})]})})]})})}},883:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437),s=r(2265);let l={green:"bg-green-100 text-green-800",blue:"bg-blue-100 text-blue-800",red:"bg-red-100 text-red-800",yellow:"bg-yellow-100 text-yellow-800",gray:"bg-gray-100 text-gray-800"};function n(e){let{options:t,value:r,onChange:n,placeholder:d="Selecciona una opci\xf3n",className:o="",disabled:c=!1,maxHeight:i="max-h-60",autoOpen:x=!1}=e,[u,g]=(0,s.useState)(!1),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{x&&t.length>1?g(!0):x||g(!1)},[x,t.length]),(0,s.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&g(!1)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,s.useEffect)(()=>{u&&b.current&&setTimeout(()=>{var e;null===(e=b.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[u]);let m=t.find(e=>e.value===r),h=e=>{n(e),g(!1)};return(0,a.jsxs)("div",{className:"relative ".concat(o),ref:b,children:[(0,a.jsx)("button",{type:"button",className:"w-full px-3 py-2 text-sm text-left border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 cursor-pointer flex items-center justify-between hover:border-gray-400 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/50 transition-all duration-200 ".concat(c?"opacity-50 cursor-not-allowed":""),onClick:()=>!c&&g(!u),disabled:c,"aria-haspopup":"listbox","aria-expanded":u,children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("span",{className:m?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:m?m.label:d}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(null==m?void 0:m.badge)&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(l[m.badgeColor||"gray"]),children:m.badge}),(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-400 transition-transform duration-200 ".concat(u?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),u&&(0,a.jsx)("div",{className:"absolute z-[99998] w-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg dark:shadow-lg dark:shadow-cyan-900/10 dark:ring-0.5 dark:ring-cyan-500/15 ".concat(i," overflow-auto apple-scroll"),children:0===t.length?(0,a.jsx)("div",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:"No hay opciones disponibles"}):t.map((e,t)=>(0,a.jsxs)("div",{children:[t>0&&(0,a.jsx)("div",{className:"w-full h-px bg-gray-100 dark:bg-gray-600/50 dark:shadow-sm dark:shadow-blue-900/10"}),(0,a.jsxs)("div",{className:"px-4 py-3 text-sm cursor-pointer transition-colors duration-150 flex items-center justify-between ".concat(e.disabled?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"," ").concat(e.value===r?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100":""),onClick:()=>!e.disabled&&h(e.value),children:[(0,a.jsx)("span",{children:e.label}),e.badge&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(l[e.badgeColor||"gray"]),children:e.badge})]})]},e.value))})]})}},622:function(e,t,r){"use strict";var a=r(2265),s=Symbol.for("react.element"),l=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,d=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var a,l={},c=null,i=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(i=t.ref),t)n.call(t,a)&&!o.hasOwnProperty(a)&&(l[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===l[a]&&(l[a]=t[a]);return{$$typeof:s,type:e,key:c,ref:i,props:l,_owner:d.current}}t.Fragment=l,t.jsx=c,t.jsxs=c},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[2971,4938,1744],function(){return e(e.s=6328)}),_N_E=e.O()}]);