(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8289,5922],{8962:function(e,a,r){Promise.resolve().then(r.bind(r,9400))},9400:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return d}});var t=r(7437),s=r(2265),o=r(4033),l=r(883);function d(){var e,a,d,i,n;let[c,m]=(0,s.useState)(null),[u,x]=(0,s.useState)([]),[g,h]=(0,s.useState)([]),[p,b]=(0,s.useState)(null),[y,f]=(0,s.useState)(!0),[v,k]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[w,D]=(0,s.useState)({}),[S,M]=(0,s.useState)(!1),[I,C]=(0,s.useState)(!1),[E,A]=(0,s.useState)(null),[L,U]=(0,s.useState)(null),[_,O]=(0,s.useState)(""),[T,F]=(0,s.useState)({}),[P,V]=(0,s.useState)(!1),[B,z]=(0,s.useState)([]),[R,X]=(0,s.useState)([]),[W,$]=(0,s.useState)("all"),[G,J]=(0,s.useState)(""),[Z,H]=(0,s.useState)(""),q=(0,o.useRouter)(),Y=r(5922).supabase;(0,s.useEffect)(()=>{if(!p||!p.calculatorData)return;let e=p.calculatorData.platforms,a=p.calculatorData.rates;if(!e||!a)return;let r=0,t=0;e.forEach(e=>{var s,o;let l=w[e.id],d=(null===(o=p.calculatorData.values)||void 0===o?void 0:null===(s=o.find(a=>a.platform_id===e.id||a.platform===e.name))||void 0===s?void 0:s.value)||0,i=void 0!==l?parseFloat(l)||0:d,n=0;"EUR"===e.currency?"big7"===e.id?n=i*(a.eur_usd||1.01)*.84:"mondo"===e.id?n=i*(a.eur_usd||1.01)*.78:(e.id,n=i*(a.eur_usd||1.01)):"GBP"===e.currency?n="aw"===e.id?i*(a.gbp_usd||1.2)*.677:i*(a.gbp_usd||1.2):"USD"===e.currency&&(n="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*i:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*i:"dxlive"===e.id?.6*i:"secretfriends"===e.id?.5*i:i),r+=n;let c="superfoon"===e.id?n:n*e.percentage/100;t+=c});let s=t*(a.usd_cop||3900),o=t/470*100,l=(p.calculatorData.periodDate||new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"})).split("-"),d=parseInt(l[0]),i=parseInt(l[1]),n=parseInt(l[2]),c="".concat(d,"-").concat(String(i).padStart(2,"0"),"-").concat(n<=15?"01":"16");A({usdBruto:r,usdModelo:t,copModelo:s,objetivoBasico:470,porcentajeAlcanzado:o,normalizedPeriodDate:c})},[w,p]),(0,s.useEffect)(()=>{let e=e=>{L&&!e.target.closest(".absolute.z-50")&&U(null)};if(L)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[L]),(0,s.useEffect)(()=>{(async()=>{try{var e,a,r,t;f(!0);let{data:s}=await Y.auth.getUser(),o=null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.id;if(!o){m(null),f(!1);return}let{data:l}=await Y.from("users").select("id,name,email,role").eq("id",o).single(),d=[];if(l&&"super_admin"!==l.role){let{data:e}=await Y.from("user_groups").select("groups(name)").eq("user_id",o);d=(e||[]).map(e=>{var a;return null===(a=e.groups)||void 0===a?void 0:a.name}).filter(Boolean)}m({id:(null==l?void 0:l.id)||o,name:(null==l?void 0:l.name)||(null===(r=s.user)||void 0===r?void 0:null===(a=r.email)||void 0===a?void 0:a.split("@")[0])||"Usuario",email:(null==l?void 0:l.email)||(null===(t=s.user)||void 0===t?void 0:t.email)||"",role:(null==l?void 0:l.role)||"modelo",groups:d,organization_id:"",is_active:!0,last_login:new Date().toISOString()}),await K(o)}catch(e){console.error("Error loading user:",e),k(e.message||"Error al cargar usuario")}finally{f(!1)}})()},[]),(0,s.useEffect)(()=>{if(g.length>0&&!p&&c){let e=new URLSearchParams(window.location.search).get("modelId");if(e){console.log("\uD83D\uDD0D [UX-FIX] Restaurando modelo desde URL:",e);let a=g.find(a=>a.id===e);if(a)console.log("✅ [UX-FIX] Modelo encontrado, restaurando:",a.name),ee(a,!1);else{console.warn("⚠️ [UX-FIX] Modelo no encontrado, limpiando URL");let e=new URL(window.location.href);e.searchParams.delete("modelId"),window.history.replaceState({},"",e.pathname+e.search)}}else console.log("\uD83D\uDD0D [UX-FIX] Entrada directa detectada, limpiando localStorage"),localStorage.removeItem("admin-selected-model-id")}},[g,p,c]);let K=async e=>{try{let a=await fetch("/api/calculator/models?adminId=".concat(e)),r=await a.json();if(r.success){let e=r.models||[];h(e),x(e);let a=new Map;e.forEach(e=>{e.groups.forEach(e=>{e&&e.id&&e.name&&a.set(e.id,e)})});let t=Array.from(a.values());c&&"admin"===c.role&&(t=t.filter(e=>c.groups.includes(e.name))),X(t)}else k(r.error||"Error al cargar modelos")}catch(e){console.error("Error loading models:",e),k(e.message||"Error al cargar modelos")}},Q=async e=>{try{console.log("\uD83D\uDD0D [ADMIN-TOTALS] Loading calculated totals for model:",e);let a=await fetch("/api/calculator/admin-totals?modelId=".concat(e,"&adminId=").concat(null==c?void 0:c.id)),r=await a.json();r.success?(console.log("✅ [ADMIN-TOTALS] Totals loaded:",r.totals),A(r.totals)):(console.error("❌ [ADMIN-TOTALS] Error loading totals:",r.error),A(null))}catch(e){console.error("❌ [ADMIN-TOTALS] Error loading totals:",e),A(null)}},ee=async function(e){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{if(f(!0),k(null),a){let a=new URL(window.location.href);a.searchParams.set("modelId",e.id),window.history.replaceState({},"",a.pathname+a.search),localStorage.setItem("admin-selected-model-id",e.id),console.log("\uD83D\uDCBE [UX-FIX] Selecci\xf3n persistida:",e.name)}let t=await fetch("/api/calculator/admin-view?modelId=".concat(e.id,"&adminId=").concat(null==c?void 0:c.id)),s=await t.json();if(s.success){var r;if(console.log("\uD83D\uDD0D [ADMIN-VIEW] Calculator data received:",s),console.log("\uD83D\uDD0D [ADMIN-VIEW] Platforms:",s.platforms),console.log("\uD83D\uDD0D [ADMIN-VIEW] Values:",s.values),console.log("\uD83D\uDD0D [ADMIN-VIEW] Values count:",(null===(r=s.values)||void 0===r?void 0:r.length)||0),console.log("\uD83D\uDD0D [ADMIN-VIEW] Period date:",s.periodDate),b({...e,calculatorData:s}),s.periodDate){let e=s.periodDate.split("-"),a=parseInt(e[2],10);V(a>=16),console.log("\uD83D\uDD0D [ADMIN-VIEW] Period check:",{periodDate:s.periodDate,day:a,isP2:a>=16})}s.frozenPlatforms?(z(s.frozenPlatforms),console.log("\uD83E\uDDCA [ADMIN-VIEW] Frozen platforms:",s.frozenPlatforms)):z([]),await Q(e.id)}else k(s.error||"Error al cargar datos de la calculadora")}catch(e){console.error("Error loading calculator data:",e),k(e.message||"Error al cargar datos de la calculadora")}finally{f(!1)}},ea=e=>{J(e),er(W,e)},er=(e,a)=>{let r=g;if("all"!==e&&(r=r.filter(a=>a.groups.some(a=>a.id===e))),a.trim()){let e=a.toLowerCase().trim();r=r.filter(a=>a.name.toLowerCase().includes(e)||a.email.toLowerCase().includes(e)||a.email.split("@")[0].toLowerCase().includes(e))}x(r),Z&&!r.find(e=>e.id===Z)&&H("")},et=(e,a)=>{console.log("\uD83D\uDD0D [VALUE-CHANGE] Platform:",e,"Value:",a),D(r=>{let t={...r,[e]:a};return console.log("\uD83D\uDD0D [VALUE-CHANGE] Updated editValues:",t),t}),M(!0)};(0,s.useEffect)(()=>{if(!p||!c||!S||j)return;console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Iniciando timer de autosave...");let e=new AbortController,a=setTimeout(async()=>{try{console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Ejecutando autosave despu\xe9s de 40 segundos de inactividad...");let a={};Object.entries(w).forEach(e=>{let[r,t]=e,s=Number.parseFloat(t)||0;a[r]=s});let r=await fetch("/api/calculator/model-values-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:p.id,values:a,periodDate:p.calculatorData.periodDate}),signal:e.signal}),t=await r.json();if(t.success){console.log("✅ [ADMIN-AUTOSAVE] Autosave completado exitosamente"),E&&(console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Actualizando totales tambi\xe9n con fecha normalizada:",E.normalizedPeriodDate),await fetch("/api/calculator/totals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:p.id,periodDate:E.normalizedPeriodDate,totalUsdBruto:E.usdBruto,totalUsdModelo:E.usdModelo,totalCopModelo:E.copModelo}),signal:e.signal})),M(!1);let a=document.createElement("div");a.className="fixed top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50",a.innerHTML="Guardado autom\xe1tico completado",document.body.appendChild(a),setTimeout(()=>a.style.transform="translateX(0)",100),setTimeout(()=>{a.style.transform="translateX(100%)",setTimeout(()=>document.body.removeChild(a),300)},2e3)}else console.warn("⚠️ [ADMIN-AUTOSAVE] Error en autosave:",t.error)}catch(e){console.warn("⚠️ [ADMIN-AUTOSAVE] Excepci\xf3n en autosave:",e)}},4e4);return()=>{clearTimeout(a),e.abort()}},[w,p,c,S,j]);let es=async()=>{if(p&&c){console.log("\uD83D\uDD0D [ADMIN-SAVE] Starting save process"),console.log("\uD83D\uDD0D [ADMIN-SAVE] Current editValues:",w),console.log("\uD83D\uDD0D [ADMIN-SAVE] Has changes:",S);try{N(!0),k(null);let e={};Object.entries(w).forEach(a=>{let[r,t]=a,s=Number.parseFloat(t)||0;e[r]=s}),console.log("\uD83D\uDD0D [ADMIN-EDIT] Saving values:",e);let a=await fetch("/api/calculator/model-values-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:p.id,values:e,periodDate:p.calculatorData.periodDate})}),r=await a.json();if(console.log("\uD83D\uDD0D [ADMIN-EDIT] Save result:",r),!r.success)throw Error(r.error||"Error al guardar");console.log("✅ [ADMIN-EDIT] Values saved successfully"),E&&(console.log("\uD83D\uDCBE [ADMIN-EDIT] Updating calculator_totals with normalized date:",{date:E.normalizedPeriodDate,totalUsdBruto:E.usdBruto,totalUsdModelo:E.usdModelo,totalCopModelo:E.copModelo}),await fetch("/api/calculator/totals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:p.id,periodDate:E.normalizedPeriodDate,totalUsdBruto:E.usdBruto,totalUsdModelo:E.usdModelo,totalCopModelo:E.copModelo})}),console.log("✅ [ADMIN-EDIT] Totals updated successfully")),D({}),M(!1),await ee(p);let t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50",t.innerHTML="Valores guardados correctamente",document.body.appendChild(t),setTimeout(()=>{t.style.transform="translateX(0)"},100),setTimeout(()=>{t.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(t)},300)},3e3)}catch(e){console.error("❌ [ADMIN-EDIT] Save error:",e),k(e.message||"Error al guardar valores")}finally{N(!1)}}};return y?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Cargando..."})]})}):v?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:(0,t.jsx)("div",{className:"relative bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 dark:border-gray-600/20 p-8 max-w-md dark:shadow-lg dark:shadow-red-900/15 dark:ring-0.5 dark:ring-red-400/20",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,t.jsx)("p",{className:"text-red-600 dark:text-red-400 mb-4 text-sm",children:v}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 text-sm shadow-md hover:shadow-lg transform hover:scale-105",children:"Reintentar"})]})})}):c&&("admin"===c.role||"super_admin"===c.role||"superadmin_aff"===c.role)?p?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-6 pt-16",children:[(0,t.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:(0,t.jsxs)("button",{onClick:()=>{b(null),H(""),D({}),M(!1),V(!1),z([]),localStorage.removeItem("admin-selected-model-id");let e=new URL(window.location.href);e.searchParams.delete("modelId"),window.history.replaceState({},"",e.pathname+e.search),console.log("\uD83E\uDDF9 [UX-FIX] Selecci\xf3n limpiada")},className:"flex items-center space-x-1.5 sm:space-x-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors active:scale-95 touch-manipulation",children:[(0,t.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,t.jsx)("span",{className:"font-medium text-sm sm:text-base",children:"Volver"})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("h1",{className:"text-base sm:text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:["Calculadora de ",p.name]}),(0,t.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 text-xs sm:text-sm truncate",children:[p.email," • ",p.groups.map(e=>e.name).join(", ")]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 flex-shrink-0",children:[(0,t.jsx)("button",{onClick:()=>q.push("/admin/model/calculator/historial?modelId=".concat(p.id)),className:"px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs font-medium bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:scale-95 touch-manipulation",children:"Historial"}),(0,t.jsx)("button",{onClick:es,disabled:j||!S,className:"px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs font-medium rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-300 shadow-md transform hover:-translate-y-0.5 whitespace-nowrap active:scale-95 touch-manipulation ".concat(S&&!j?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:j?"Guardando...":"Guardar"})]})]})]}),p.calculatorData?(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-4 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h2",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3 flex items-center",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-blue-500 rounded-full mr-1.5 sm:mr-2"}),"Tasas Actualizadas"]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg sm:rounded-xl border border-blue-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-blue-700 mb-0.5 sm:mb-1",children:["$",(null===(d=p.calculatorData.rates)||void 0===d?void 0:d.usd_cop)||3900]}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-blue-600 bg-blue-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD→COP"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg sm:rounded-xl border border-green-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsx)("div",{className:"text-base sm:text-xl font-bold text-green-700 mb-0.5 sm:mb-1",children:(null===(i=p.calculatorData.rates)||void 0===i?void 0:i.eur_usd)||1.01}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-green-600 bg-green-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"EUR→USD"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg sm:rounded-xl border border-purple-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsx)("div",{className:"text-base sm:text-xl font-bold text-purple-700 mb-0.5 sm:mb-1",children:(null===(n=p.calculatorData.rates)||void 0===n?void 0:n.gbp_usd)||1.2}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-purple-600 bg-purple-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"GBP→USD"})]})]}),(0,t.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 mt-2 sm:mt-3 text-center font-medium",children:"Configuradas por tu administrador"})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-6 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h2",{className:"text-sm sm:text-base font-semibold text-gray-900 dark:text-gray-100 mb-3 sm:mb-4 flex items-center",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-green-500 rounded-full mr-1.5 sm:mr-2"}),"Calculadora de Ingresos"]}),p.calculatorData.isConfigured&&p.calculatorData.platforms&&0!==p.calculatorData.platforms.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"md:hidden space-y-3",children:p.calculatorData.platforms.map(e=>{var a,r;let s=(null===(r=p.calculatorData.values)||void 0===r?void 0:null===(a=r.find(a=>a.platform_id===e.id||a.platform===e.name))||void 0===a?void 0:a.value)||0,o=p.calculatorData.rates,l=0;"EUR"===e.currency?"big7"===e.id?l=s*((null==o?void 0:o.eur_usd)||1.01)*.84:"mondo"===e.id?l=s*((null==o?void 0:o.eur_usd)||1.01)*.78:(e.id,l=s*((null==o?void 0:o.eur_usd)||1.01)):"GBP"===e.currency?l="aw"===e.id?s*((null==o?void 0:o.gbp_usd)||1.2)*.677:s*((null==o?void 0:o.gbp_usd)||1.2):"USD"===e.currency&&(l="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*s:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*s:"dxlive"===e.id?.6*s:"secretfriends"===e.id?.5*s:s);let d="superfoon"===e.id?l:l*e.percentage/100,i=d*((null==o?void 0:o.usd_cop)||3900),n=B.includes(e.id);return T[e.id],(0,t.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-600/50 rounded-lg border ".concat(n?"border-gray-200 dark:border-gray-500":"border-gray-200 dark:border-gray-600"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Reparto: ","superfoon"===e.id?"100%":"".concat(e.percentage,"%")]})]}),n&&(0,t.jsx)("span",{className:"text-[10px] font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 px-1.5 py-0.5 rounded",children:"\uD83D\uDD12 Cerrado"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-1 block",children:"Valor"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"text",inputMode:"decimal",disabled:n,value:void 0!==w[e.id]?w[e.id]:s.toFixed(2),onChange:a=>{if(n)return;let r=a.target.value.replace(/[^0-9.,]/g,"").replace(",","."),t=r.split("."),s=t.length>2?"".concat(t[0],".").concat(t.slice(1).join("")):r;et(e.id,s)},className:"flex-1 px-2 py-1.5 text-sm font-medium rounded-lg border transition-all ".concat(n?"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-500 cursor-not-allowed":"text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),placeholder:n?"Locked":"0.00"}),(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-600 px-2 py-1 rounded-md",children:e.currency||"USD"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"USD Bruto"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",l.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"USD Modelo"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",d.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"COP Modelo"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",i.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})]})]},e.id)})}),(0,t.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[(0,t.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"PLATAFORMAS"}),(0,t.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"VALORES"}),(0,t.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"USD BRUTO"}),(0,t.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"USD MODELO"}),(0,t.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"COP MODELO"})]})}),(0,t.jsx)("tbody",{children:p.calculatorData.platforms.map(e=>{var a,r;let s=(null===(r=p.calculatorData.values)||void 0===r?void 0:null===(a=r.find(a=>a.platform_id===e.id||a.platform===e.name))||void 0===a?void 0:a.value)||0;console.log("\uD83D\uDD0D [ADMIN-VIEW] Platform:",e.name,"ID:",e.id,"Value:",s);let o=p.calculatorData.rates,l=0;"EUR"===e.currency?"big7"===e.id?l=s*((null==o?void 0:o.eur_usd)||1.01)*.84:"mondo"===e.id?l=s*((null==o?void 0:o.eur_usd)||1.01)*.78:(e.id,l=s*((null==o?void 0:o.eur_usd)||1.01)):"GBP"===e.currency?l="aw"===e.id?s*((null==o?void 0:o.gbp_usd)||1.2)*.677:s*((null==o?void 0:o.gbp_usd)||1.2):"USD"===e.currency&&(l="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*s:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*s:"dxlive"===e.id?.6*s:"secretfriends"===e.id?.5*s:s);let d="superfoon"===e.id?l:l*e.percentage/100,i=d*((null==o?void 0:o.usd_cop)||3900),n=B.includes(e.id),c=T[e.id]||0;return(0,t.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors duration-200 group ".concat(n?"bg-gray-50/50 dark:bg-gray-800/50":""),children:[(0,t.jsxs)("td",{className:"py-3 px-3 relative",children:[(0,t.jsxs)("div",{className:"font-medium text-sm text-left transition-colors flex items-center gap-2 group ".concat(n?"text-gray-400 dark:text-gray-500 cursor-not-allowed":P?"text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer":"text-gray-900 dark:text-gray-100 cursor-default"),onClick:a=>{a.stopPropagation(),!n&&P&&(U(e.id),O(String(T[e.id]||"")))},title:n?"Plataforma cerrada por horario europeo":P?"Click para ingresar valor de P1":"Solo disponible en el segundo periodo (16-Fin de mes)",children:[(0,t.jsx)("span",{className:"".concat(!n&&P&&"underline decoration-dotted decoration-gray-400 underline-offset-2 hover:decoration-blue-500"),children:e.name}),!n&&P&&(0,t.jsx)("span",{className:"opacity-0 group-hover:opacity-100 text-xs text-blue-500 transition-all duration-200 transform translate-x-[-4px] group-hover:translate-x-0",children:"✎"}),n&&(0,t.jsx)("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",children:"\uD83D\uDD12 Cerrado"})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Reparto: ","superfoon"===e.id?"100%":"".concat(e.percentage,"%")]}),c>0&&(0,t.jsxs)("div",{className:"mt-1 flex items-center gap-1 bg-blue-50 dark:bg-blue-900/20 px-1.5 py-0.5 rounded border border-blue-100 dark:border-blue-800/30 w-fit",children:[(0,t.jsx)("span",{className:"text-[10px] font-semibold text-blue-600 dark:text-blue-400",children:"P1:"}),(0,t.jsx)("span",{className:"text-[10px] font-mono text-blue-700 dark:text-blue-300",children:c.toLocaleString("es-CO")})]}),L===e.id&&!n&&P&&(0,t.jsx)("div",{className:"absolute z-50 bg-white dark:bg-gray-800 border border-blue-400 dark:border-blue-500 rounded-lg shadow-lg p-2",style:{top:"100%",left:"12px",marginTop:"4px"},onClick:e=>e.stopPropagation(),children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium text-gray-600 dark:text-gray-400 whitespace-nowrap",children:"P1:"}),(0,t.jsx)("input",{type:"text",inputMode:"decimal",value:_,onChange:e=>{O(e.target.value.replace(",","."))},onKeyDown:a=>{if("Enter"===a.key){let a=Number.parseFloat(_)||0;F(r=>({...r,[e.id]:a})),U(null)}else"Escape"===a.key&&U(null)},autoFocus:!0,className:"w-16 px-1.5 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"0.00"}),(0,t.jsx)("button",{onClick:()=>{let a=Number.parseFloat(_)||0;F(r=>({...r,[e.id]:a})),U(null)},className:"px-2 py-1 bg-blue-500 text-white rounded text-[10px] font-medium hover:bg-blue-600 transition-colors",title:"Guardar",children:"✓"}),(0,t.jsx)("button",{onClick:()=>{U(null)},className:"px-2 py-1 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded text-[10px] font-medium hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",title:"Cancelar",children:"✕"})]})})]}),(0,t.jsx)("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"text",inputMode:"decimal",disabled:n,value:void 0!==w[e.id]?w[e.id]:s.toFixed(2),onChange:a=>{if(n)return;let r=a.target.value.replace(/[^0-9.,]/g,"").replace(",","."),t=r.split("."),s=t.length>2?"".concat(t[0],".").concat(t.slice(1).join("")):r;et(e.id,s)},className:"w-24 px-3 py-2 text-sm font-medium transition-all duration-200 rounded-lg ".concat(n?"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-500 cursor-not-allowed":"text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-300 dark:hover:border-gray-500 focus:shadow-lg focus:shadow-blue-100"),placeholder:n?"Locked":"0.00",title:n?"Plataforma cerrada por horario europeo":"Ingresa el valor generado"}),(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-600 px-2 py-1 rounded-md",children:e.currency||"USD"})]}),void 0!==w[e.id]&&w[e.id]!==s.toFixed(2)&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"})]})}),(0,t.jsx)("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",l.toFixed(2)," USD"]})}),(0,t.jsx)("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",d.toFixed(2)," USD"]})}),(0,t.jsx)("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",i.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})," COP"]})})]},e.id)})})]})})]}):(0,t.jsxs)("div",{className:"text-center py-6 sm:py-8",children:[(0,t.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4"}),(0,t.jsx)("h4",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No hay plataformas habilitadas"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-500 dark:text-gray-400 mb-3 sm:mb-4",children:"Esta modelo no tiene configuraci\xf3n de calculadora o plataformas habilitadas."}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-400 dark:text-gray-500",children:"Contacta al administrador para que configure las plataformas."})]})]}),p.calculatorData.platforms&&p.calculatorData.platforms.length>0&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-4 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h3",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3 flex items-center",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-green-500 rounded-full mr-1.5 sm:mr-2"}),"Totales y Alertas"]}),E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg sm:rounded-xl border border-blue-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-blue-700 mb-0.5 sm:mb-1",children:["$",E.usdBruto.toFixed(2)]}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-blue-600 bg-blue-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD Bruto"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg sm:rounded-xl border border-green-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-green-700 mb-0.5 sm:mb-1",children:["$",E.usdModelo.toFixed(2)]}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-green-600 bg-green-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD Modelo"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg sm:rounded-xl border border-purple-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-purple-700 mb-0.5 sm:mb-1",children:["$",E.copModelo.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})]}),(0,t.jsx)("div",{className:"text-[10px] sm:text-xs font-medium text-purple-600 bg-purple-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"COP Modelo"})]})]}),(0,t.jsx)("div",{className:"mb-6",children:(()=>{let e=Math.max(0,Math.min(100,E.porcentajeAlcanzado||0)),a={r:16,g:185,b:129},r=(e,a,r)=>({r:Math.round(e.r+(a.r-e.r)*r),g:Math.round(e.g+(a.g-e.g)*r),b:Math.round(e.b+(a.b-e.b)*r)}),s=e=>"#".concat([e.r,e.g,e.b].map(e=>e.toString(16).padStart(2,"0")).join("")),o=(e,a)=>r(e,{r:0,g:0,b:0},a),l=(e,a)=>r(e,{r:255,g:255,b:255},a),d=e/100,i=d<=.5?r({r:59,g:130,b:246},a,d/.5):r(a,{r:168,g:85,b:247},(d-.5)/.5),n=l(i,.35),c=s(l(n,.1)),m=s(o(n,.05));return(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-50/80 to-gray-100/80 dark:from-gray-700/50 dark:to-gray-800/50 backdrop-blur-sm rounded-lg sm:rounded-xl p-2.5 sm:p-4 border border-gray-200/50 dark:border-gray-600/30 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[(0,t.jsx)("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center shadow-sm",style:{background:"linear-gradient(135deg, ".concat(s(o(i,0)),", ").concat(s(o(i,.2)),")")},children:(0,t.jsx)("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100",children:["Objetivo B\xe1sico ",E.estaPorDebajo?"en Progreso":"Alcanzado"]}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:["Meta: $",E.cuotaMinima," USD"]})]})]}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-0.5 sm:py-1 rounded-lg text-white shadow-sm",style:{background:"linear-gradient(135deg, ".concat(s(o(n,.05)),", ").concat(s(o(n,.12)),")"),border:"1px solid ".concat(s(o(n,.25)))},children:[e.toFixed(1),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200/80 dark:bg-gray-700/80 rounded-full h-3 sm:h-4 overflow-hidden shadow-inner mb-1.5 sm:mb-2",children:(0,t.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ease-out relative overflow-hidden",style:{width:"".concat(e,"%"),background:"linear-gradient(90deg, ".concat(c,", ").concat(m,")")},children:(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent"})})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 pt-1.5 sm:pt-2 border-t border-gray-200/50 dark:border-gray-600/30",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-[9px] sm:text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-0.5 sm:mb-1",children:"Alcanzado"}),(0,t.jsxs)("div",{className:"inline-block px-2 sm:px-2.5 py-0.5 sm:py-1 rounded-md text-[10px] sm:text-xs font-bold text-white shadow-sm",style:{background:"linear-gradient(135deg, ".concat(s(o(i,.15)),", ").concat(s(o(i,.3)),")"),border:"1px solid ".concat(s(o(i,.45)))},children:["$",Math.max(0,E.usdModelo).toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1",children:"Faltante"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:["$",Math.max(0,E.cuotaMinima-E.usdModelo).toFixed(2)," USD"]})]})]})]})})()}),(0,t.jsx)("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[(0,t.jsx)("strong",{children:"90% de anticipo disponible:"})," $",E.anticipoDisponible.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})," COP"]})})]}):(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Calculando totales..."})]})]})]}):(0,t.jsx)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-4"}),(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:["Calculadora de ",p.name]}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Cargando datos de la calculadora..."}),(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:[(0,t.jsx)("div",{className:"mb-8 sm:mb-12",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-indigo-600/10 rounded-xl blur-xl"}),(0,t.jsx)("div",{className:"relative bg-white/80 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20",children:(0,t.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-3",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h1",{className:"text-base sm:text-lg md:text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:"Ver Calculadora de Modelo"}),(0,t.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300 hidden sm:block",children:"Selecciona un modelo para ver y editar su calculadora"})]})]})})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 space-y-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15 z-[99999]",children:[R.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Filtrar por Grupo"}),(0,t.jsx)(l.Z,{options:[{value:"all",label:"Todos los grupos"},...R.map(e=>({value:e.id,label:e.name}))],value:W,onChange:e=>{$(e),er(e,G)},placeholder:"Selecciona un grupo",className:"text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Buscar por Nombre"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:G,onChange:e=>ea(e.target.value),placeholder:"Buscar modelo...",className:"w-full px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:shadow-lg focus:shadow-blue-100 pr-10 text-gray-900 dark:text-gray-100"}),G&&(0,t.jsx)("button",{onClick:()=>ea(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),G&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:['\uD83D\uDD0D Filtrando por: "',G,'" - ',u.length," resultado",1!==u.length?"s":""]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Seleccionar Modelo"}),(0,t.jsx)(l.Z,{options:[{value:"",label:0===u.length?"No hay modelos disponibles":"Selecciona un modelo"},...u.map(e=>{var a,r;return{value:e.id,label:e.email.split("@")[0],badge:(null===(a=e.currentConfig)||void 0===a?void 0:a.active)?"Configurada":"Sin configurar",badgeColor:(null===(r=e.currentConfig)||void 0===r?void 0:r.active)?"green":"gray"}})],value:Z,onChange:e=>{if(H(e),e){let a=u.find(a=>a.id===e);a&&ee(a)}},placeholder:0===u.length?G?'No hay modelos que contengan "'.concat(G,'"'):"No hay modelos disponibles":"".concat(u.length," modelo").concat(1!==u.length?"s":""," disponible").concat(1!==u.length?"s":""),autoOpen:G.length>0&&u.length>0,className:"text-sm"}),Z&&u.find(e=>e.id===Z)&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:(()=>{let e=u.find(e=>e.id===Z);return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:e.email.split("@")[0]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:e.email}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.groups.map(e=>(0,t.jsx)("span",{className:"inline-block px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 text-xs rounded-full",children:e.name},e.id))})]}):null})()}),0===u.length&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-600/80 rounded-lg text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2 text-2xl",children:"\uD83D\uDC65"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:G||"all"!==W?"No se encontraron modelos con los filtros aplicados":"No hay modelos disponibles"}),(G||"all"!==W)&&(0,t.jsx)("button",{onClick:()=>{J(""),$("all"),H(""),x(g)},className:"px-3 py-1.5 text-xs font-medium bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 shadow-md",children:"Limpiar filtros"})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Mostrando ",u.length," de ",g.length," modelos"]}),"all"!==W&&(0,t.jsxs)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Filtrado por: ",null===(e=R.find(e=>e.id===W))||void 0===e?void 0:e.name]}),G&&(0,t.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:['B\xfasqueda: "',G,'"']})]})]})}),(0,t.jsx)("div",{className:"hidden lg:block lg:col-span-2",children:(0,t.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Informaci\xf3n"}),Z&&u.find(e=>e.id===Z)?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-green-500 mb-4 text-4xl",children:"✅"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Modelo seleccionado"}),(0,t.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:[null===(a=u.find(e=>e.id===Z))||void 0===a?void 0:a.email.split("@")[0]," est\xe1 listo para ver su calculadora"]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"La calculadora se abrir\xe1 autom\xe1ticamente"})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-4 text-4xl",children:"\uD83D\uDC48"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Selecciona un modelo"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Usa los filtros de la izquierda para encontrar y seleccionar un modelo"})]})]})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:(0,t.jsx)("div",{className:"relative bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 dark:border-gray-600/20 p-8 max-w-md dark:shadow-lg dark:shadow-red-900/15 dark:ring-0.5 dark:ring-red-400/20",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,t.jsx)("p",{className:"text-red-600 dark:text-red-400 mb-4 text-sm",children:"No tienes permisos para acceder a esta funci\xf3n"}),(0,t.jsx)("button",{onClick:()=>q.push("/admin/dashboard"),className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 text-sm shadow-md hover:shadow-lg transform hover:scale-105",children:"Volver al Dashboard"})]})})})}},883:function(e,a,r){"use strict";r.d(a,{Z:function(){return l}});var t=r(7437),s=r(2265);let o={green:"bg-green-100 text-green-800",blue:"bg-blue-100 text-blue-800",red:"bg-red-100 text-red-800",yellow:"bg-yellow-100 text-yellow-800",gray:"bg-gray-100 text-gray-800"};function l(e){let{options:a,value:r,onChange:l,placeholder:d="Selecciona una opci\xf3n",className:i="",disabled:n=!1,maxHeight:c="max-h-60",autoOpen:m=!1}=e,[u,x]=(0,s.useState)(!1),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{m&&a.length>1?x(!0):m||x(!1)},[m,a.length]),(0,s.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&x(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&x(!1)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,s.useEffect)(()=>{u&&g.current&&setTimeout(()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[u]);let h=a.find(e=>e.value===r),p=e=>{l(e),x(!1)};return(0,t.jsxs)("div",{className:"relative ".concat(i),ref:g,children:[(0,t.jsx)("button",{type:"button",className:"w-full px-3 py-2 text-sm text-left border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 cursor-pointer flex items-center justify-between hover:border-gray-400 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/50 transition-all duration-200 ".concat(n?"opacity-50 cursor-not-allowed":""),onClick:()=>!n&&x(!u),disabled:n,"aria-haspopup":"listbox","aria-expanded":u,children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsx)("span",{className:h?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:h?h.label:d}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(null==h?void 0:h.badge)&&(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(o[h.badgeColor||"gray"]),children:h.badge}),(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-400 transition-transform duration-200 ".concat(u?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),u&&(0,t.jsx)("div",{className:"absolute z-[99998] w-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg dark:shadow-lg dark:shadow-cyan-900/10 dark:ring-0.5 dark:ring-cyan-500/15 ".concat(c," overflow-auto apple-scroll"),children:0===a.length?(0,t.jsx)("div",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:"No hay opciones disponibles"}):a.map((e,a)=>(0,t.jsxs)("div",{children:[a>0&&(0,t.jsx)("div",{className:"w-full h-px bg-gray-100 dark:bg-gray-600/50 dark:shadow-sm dark:shadow-blue-900/10"}),(0,t.jsxs)("div",{className:"px-4 py-3 text-sm cursor-pointer transition-colors duration-150 flex items-center justify-between ".concat(e.disabled?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"," ").concat(e.value===r?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100":""),onClick:()=>!e.disabled&&p(e.value),children:[(0,t.jsx)("span",{children:e.label}),e.badge&&(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(o[e.badgeColor||"gray"]),children:e.badge})]})]},e.value))})]})}},5922:function(e,a,r){"use strict";r.r(a),r.d(a,{supabase:function(){return t}});let t=(0,r(5257).createClient)("https://mhernfrkvwigxdubiozm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oZXJuZnJrdndpZ3hkdWJpb3ptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MTY1NDcsImV4cCI6MjA3NDM5MjU0N30.v7qBceGTwaqyDZe5h9yLBjWwuuGEwAq6KVsAH_RNw8c")},622:function(e,a,r){"use strict";var t=r(2265),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function n(e,a,r){var t,o={},n=null,c=null;for(t in void 0!==r&&(n=""+r),void 0!==a.key&&(n=""+a.key),void 0!==a.ref&&(c=a.ref),a)l.call(a,t)&&!i.hasOwnProperty(t)&&(o[t]=a[t]);if(e&&e.defaultProps)for(t in a=e.defaultProps)void 0===o[t]&&(o[t]=a[t]);return{$$typeof:s,type:e,key:n,ref:c,props:o,_owner:d.current}}a.Fragment=o,a.jsx=n,a.jsxs=n},7437:function(e,a,r){"use strict";e.exports=r(622)},4033:function(e,a,r){e.exports=r(5313)}},function(e){e.O(0,[5257,2971,4938,1744],function(){return e(e.s=8962)}),_N_E=e.O()}]);