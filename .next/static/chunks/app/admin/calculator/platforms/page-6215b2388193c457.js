(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3345],{2146:function(e,t,r){Promise.resolve().then(r.bind(r,6487))},6487:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=r(7437),s=r(2265),i=r(1396),d=r.n(i),n=r(4033);let l=(0,r(5257).createClient)("https://mhernfrkvwigxdubiozm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oZXJuZnJrdndpZ3hkdWJpb3ptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MTY1NDcsImV4cCI6MjA3NDM5MjU0N30.v7qBceGTwaqyDZe5h9yLBjWwuuGEwAq6KVsAH_RNw8c");function o(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[c,m]=(0,s.useState)(null),[x,h]=(0,s.useState)(null),[u,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{g()},[]);let g=async()=>{try{let{data:{user:t}}=await l.auth.getUser();if(!t){e.push("/");return}let{data:r,error:a}=await l.from("users").select("id, role").eq("id",t.id).single();if(a||!r||"super_admin"!==r.role){e.push("/admin/dashboard");return}h(r),await f()}catch(t){console.error("Error de autenticaci\xf3n:",t),e.push("/admin/dashboard")}},f=async()=>{try{o(!0);let e=await fetch("/api/calculator/platforms"),t=await e.json();if(!t.success)throw Error(t.error||"Error al cargar plataformas");r(t.config.platforms||[])}catch(e){m(e.message)}finally{o(!1)}},b=async(e,t)=>{if(confirm('\xbfEst\xe1s seguro de que deseas eliminar la plataforma "'.concat(t,'"? Esta acci\xf3n no se puede deshacer.')))try{p(e);let t=await fetch("/api/calculator/platforms?id=".concat(e,"&deleted_by=").concat(x.id),{method:"DELETE"}),r=await t.json();if(!r.success)throw Error(r.error);await f(),sessionStorage.setItem("platforms_updated",Date.now().toString())}catch(e){alert("Error al eliminar: "+e.message)}finally{p(null)}};return i&&!t.length?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Cargando plataformas..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,a.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:[(0,a.jsx)("div",{className:"mb-8 sm:mb-12",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-indigo-600/10 rounded-xl blur-xl"}),(0,a.jsx)("div",{className:"relative bg-white/80 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:(0,a.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("h1",{className:"text-base sm:text-lg md:text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:"Gesti\xf3n de Plataformas"}),(0,a.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300 hidden sm:block",children:"Administra las plataformas disponibles en la calculadora"})]})]}),(0,a.jsxs)(d(),{href:"/admin/calculator/create-platform",className:"w-full md:w-auto px-4 py-2.5 sm:px-5 sm:py-3 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 flex items-center justify-center space-x-2 shadow-md hover:shadow-lg transform hover:scale-[1.02] md:hover:scale-105 font-medium text-sm sm:text-base",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{children:"Nueva Plataforma"})]})]})})]})}),c&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-200 rounded-lg",children:c}),(0,a.jsx)("div",{className:"relative bg-white/70 dark:bg-gray-800/80 backdrop-blur-sm border border-white/20 dark:border-gray-600/40 rounded-xl shadow-md transition-all duration-300 apple-scroll overflow-y-auto max-h-[70vh] p-0 z-10 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,a.jsxs)("div",{className:"pt-4 sm:pt-6 px-3 sm:px-6 pb-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)("div",{className:"w-5 h-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-md flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,a.jsxs)("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:["Plataformas (",t.length,")"]})]}),0!==t.length||i?(0,a.jsx)("div",{className:"overflow-x-auto -mx-3 sm:mx-0",children:(0,a.jsx)("div",{className:"inline-block min-w-full align-middle",children:(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full text-left text-xs md:table-fixed",children:[(0,a.jsx)("thead",{className:"border-b border-white/20 dark:border-gray-600/40 bg-gradient-to-r from-gray-50/80 to-blue-50/60 dark:from-gray-700/90 dark:to-gray-600/70 backdrop-blur-sm",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-2 sm:px-4 py-3 sm:py-4 min-w-[140px] sm:w-[25%] text-gray-700 dark:text-white font-medium text-xs sm:text-sm uppercase tracking-wide text-left",children:"Plataforma"}),(0,a.jsx)("th",{className:"px-2 sm:px-4 py-3 sm:py-4 min-w-[100px] sm:w-[18%] text-gray-700 dark:text-white font-medium text-xs sm:text-sm uppercase tracking-wide text-center",children:"Tipo / Moneda"}),(0,a.jsx)("th",{className:"px-2 sm:px-4 py-3 sm:py-4 min-w-[120px] sm:w-[25%] text-gray-700 dark:text-white font-medium text-xs sm:text-sm uppercase tracking-wide text-center",children:"Configuraci\xf3n"}),(0,a.jsx)("th",{className:"px-2 sm:px-4 py-3 sm:py-4 min-w-[100px] sm:w-[15%] text-gray-700 dark:text-white font-medium text-xs sm:text-sm uppercase tracking-wide text-center",children:"Frecuencia"}),(0,a.jsx)("th",{className:"px-2 sm:px-4 py-3 sm:py-4 min-w-[100px] sm:w-[17%] text-gray-700 dark:text-white font-medium text-xs sm:text-sm uppercase tracking-wide text-center sm:text-right",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white/30 dark:bg-gray-800/50 backdrop-blur-sm divide-y divide-white/20 dark:divide-gray-700/50",children:t.map(e=>{let t="Est\xe1ndar";return e.token_rate?t="Tokens":e.direct_payout&&(t="Pago Directo"),(0,a.jsxs)("tr",{className:"border-b border-white/10 dark:border-gray-700/50 hover:bg-white/60 dark:hover:bg-gray-700/70 hover:shadow-sm transition-all duration-200 h-auto sm:h-12 group",children:[(0,a.jsx)("td",{className:"px-2 sm:px-4 py-2",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-6 w-6 sm:h-8 sm:w-8 flex-shrink-0 rounded-lg bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-300 font-bold text-sm sm:text-lg border border-blue-200 dark:border-blue-700/50",children:e.name.charAt(0)}),(0,a.jsxs)("div",{className:"ml-2 sm:ml-4 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white text-xs sm:text-sm truncate",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-300 font-mono text-[10px] sm:text-xs truncate",children:e.id})]})]})}),(0,a.jsx)("td",{className:"px-2 sm:px-4 py-2",children:(0,a.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm font-medium text-gray-900 dark:text-white",children:e.currency}),(0,a.jsx)("span",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-300",children:t})]})}),(0,a.jsx)("td",{className:"px-2 sm:px-4 py-2",children:(0,a.jsxs)("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-200 space-y-0.5 sm:space-y-1 text-center",children:[e.token_rate&&(0,a.jsxs)("div",{children:["Token: ",(0,a.jsx)("span",{className:"font-mono",children:e.token_rate})]}),e.discount_factor&&(0,a.jsxs)("div",{children:["Desc: ",(0,a.jsxs)("span",{className:"font-mono",children:[(100*e.discount_factor).toFixed(1),"%"]})]}),e.tax_rate&&(0,a.jsxs)("div",{children:["Imp: ",(0,a.jsxs)("span",{className:"font-mono",children:[(100*e.tax_rate).toFixed(1),"%"]})]})]})}),(0,a.jsx)("td",{className:"px-2 sm:px-4 py-2",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("span",{className:"inline-flex items-center justify-center min-w-[70px] sm:min-w-[80px] px-2 sm:px-3 py-1 rounded-full text-[10px] sm:text-xs font-medium border ".concat("quincenal"===e.payment_frequency?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300 border-green-200 dark:border-green-700/50":"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300 border-purple-200 dark:border-purple-700/50"),children:e.payment_frequency})})}),(0,a.jsx)("td",{className:"px-2 sm:px-4 py-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-center sm:justify-end gap-2 sm:gap-3",children:[(0,a.jsx)(d(),{href:"/admin/calculator/platforms/".concat(e.id,"/edit"),className:"text-blue-600 hover:text-blue-900 dark:text-blue-300 dark:hover:text-blue-200 font-medium text-xs sm:text-sm transition-colors touch-manipulation",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>b(e.id,e.name),disabled:u===e.id,className:"text-red-600 hover:text-red-900 dark:text-red-300 dark:hover:text-red-200 font-medium text-xs sm:text-sm disabled:opacity-50 transition-colors touch-manipulation",children:u===e.id?"...":"Eliminar"})]})})]},e.id)})})]})})})}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay plataformas activas."})]})]})})]})})}},622:function(e,t,r){"use strict";var a=r(2265),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,n=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,r){var a,i={},o=null,c=null;for(a in void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(c=t.ref),t)d.call(t,a)&&!l.hasOwnProperty(a)&&(i[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===i[a]&&(i[a]=t[a]);return{$$typeof:s,type:e,key:o,ref:c,props:i,_owner:n.current}}t.Fragment=i,t.jsx=o,t.jsxs=o},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[5257,1396,2971,4938,1744],function(){return e(e.s=2146)}),_N_E=e.O()}]);