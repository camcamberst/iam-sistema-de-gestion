(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3466],{9168:function(e,a,t){Promise.resolve().then(t.bind(t,9553))},9553:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l}});var s=t(7437),r=t(2265);function l(){let[e,a]=(0,r.useState)(!1),[t,l]=(0,r.useState)(null),n=async()=>{try{a(!0),console.log("\uD83E\uDDF9 [AUTO-CLEANUP-TEST] Ejecutando limpieza autom\xe1tica...");let e=await fetch("/api/chat/auto-cleanup",{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();console.log("\uD83E\uDDF9 [AUTO-CLEANUP-TEST] Resultado:",t),l(t)}catch(e){console.error("❌ [AUTO-CLEANUP-TEST] Error:",e),l({error:(null==e?void 0:e.message)||"Error desconocido"})}finally{a(!1)}},d=async()=>{try{a(!0),console.log("\uD83D\uDCCA [AUTO-CLEANUP-TEST] Obteniendo estad\xedsticas...");let e=await fetch("/api/chat/auto-cleanup",{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();console.log("\uD83D\uDCCA [AUTO-CLEANUP-TEST] Estad\xedsticas:",t),l(t)}catch(e){console.error("❌ [AUTO-CLEANUP-TEST] Error:",e),l({error:(null==e?void 0:e.message)||"Error desconocido"})}finally{a(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"\uD83E\uDDF9 Limpieza Autom\xe1tica de Usuarios Inactivos"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Herramienta para probar la limpieza autom\xe1tica de usuarios que no han enviado heartbeat en los \xfaltimos 2 minutos"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:n,disabled:e,className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:e?"Ejecutando...":"Ejecutar Limpieza"}),(0,s.jsx)("button",{onClick:d,disabled:e,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:e?"Obteniendo...":"Ver Estad\xedsticas"})]})]}),t&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"\uD83D\uDCCA Resultados"}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:(0,s.jsx)("pre",{className:"text-sm text-gray-600 dark:text-gray-300 whitespace-pre-wrap",children:JSON.stringify(t,null,2)})}),t.success&&t.stats&&(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.stats.total}),(0,s.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Total Usuarios"})]}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.stats.online}),(0,s.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:"En L\xednea"})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:t.stats.offline}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Offline"})]}),(0,s.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:t.stats.potentiallyInactive}),(0,s.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Potencialmente Inactivos"})]})]}),t.success&&t.cleanedCount>0&&(0,s.jsxs)("div",{className:"mt-6 bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-100 mb-2",children:"✅ Usuarios Limpiados"}),(0,s.jsxs)("p",{className:"text-green-700 dark:text-green-300",children:["Se marcaron como offline ",t.cleanedCount," usuarios inactivos"]}),t.cleanedUsers&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("p",{className:"text-sm text-green-600 dark:text-green-400",children:["IDs: ",t.cleanedUsers.join(", ")]})})]}),t.error&&(0,s.jsxs)("div",{className:"mt-6 bg-red-50 dark:bg-red-900/20 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-red-900 dark:text-red-100 mb-2",children:"❌ Error"}),(0,s.jsx)("p",{className:"text-red-700 dark:text-red-300",children:t.error})]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"ℹ️ Informaci\xf3n"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[(0,s.jsx)("li",{children:"• La limpieza marca como offline usuarios que no han enviado heartbeat en 2+ minutos"}),(0,s.jsx)("li",{children:"• Los usuarios se marcan autom\xe1ticamente como online al hacer login"}),(0,s.jsx)("li",{children:"• El heartbeat se env\xeda cada 30 segundos cuando la pesta\xf1a est\xe1 activa"}),(0,s.jsx)("li",{children:"• Se detecta p\xe9rdida de conexi\xf3n a internet autom\xe1ticamente"}),(0,s.jsx)("li",{children:"• Al cerrar la pesta\xf1a/navegador se marca como offline"})]})]})]})})}},622:function(e,a,t){"use strict";var s=t(2265),r=Symbol.for("react.element"),l=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(e,a,t){var s,l={},i=null,c=null;for(s in void 0!==t&&(i=""+t),void 0!==a.key&&(i=""+a.key),void 0!==a.ref&&(c=a.ref),a)n.call(a,s)&&!o.hasOwnProperty(s)&&(l[s]=a[s]);if(e&&e.defaultProps)for(s in a=e.defaultProps)void 0===l[s]&&(l[s]=a[s]);return{$$typeof:r,type:e,key:i,ref:c,props:l,_owner:d.current}}a.Fragment=l,a.jsx=i,a.jsxs=i},7437:function(e,a,t){"use strict";e.exports=t(622)}},function(e){e.O(0,[2971,4938,1744],function(){return e(e.s=9168)}),_N_E=e.O()}]);