"use strict";exports.id=2360,exports.ids=[2360],exports.modules={8421:(e,t,r)=>{r.d(t,{Z:()=>d});var a=r(95344),s=r(3729);function d({compact:e=!1,showTitle:t=!0,refreshTrigger:r}){let[d,l]=(0,s.useState)([]),[i,n]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null);async function x(){try{n(!0),c(null);let e=await fetch("/api/rates?activeOnly=true"),t=await e.json();if(!t.success)throw Error(t.error||"Error al cargar tasas");let r=new Date,a=["USD→COP","EUR→USD","GBP→USD"],s=t.data.filter(e=>{let t=e.valid_to?new Date(e.valid_to):null;return(!t||t>r)&&a.includes(e.kind)}).sort((e,t)=>new Date(t.valid_from).getTime()-new Date(e.valid_from).getTime()).reduce((e,t)=>(e.find(e=>e.kind===t.kind)||e.push(t),e),[]).sort((e,t)=>{let r={"USD→COP":1,"EUR→USD":2,"GBP→USD":3};return(r[e.kind]||4)-(r[t.kind]||4)});l(s)}catch(e){c(e.message||"Error inesperado")}finally{n(!1)}}(0,s.useEffect)(()=>{x()},[]),(0,s.useEffect)(()=>{void 0!==r&&x()},[r]);let m=e=>{switch(e){case"USD→COP":return"USD → COP";case"EUR→USD":return"EUR → USD";case"GBP→USD":return"GBP → USD";default:return e}},u=e=>"global"===e?"Global":e.startsWith("group:")?`Grupo: ${e.replace("group:","")}`:e,h=e=>{switch(e){case"manual":return"✏️";case"ECB":return"\uD83C\uDFDB️";case"system":return"\uD83E\uDD16";case"OXR":return"\uD83D\uDCCA";default:return"\uD83D\uDCCB"}};return e?(0,a.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-4 hover:shadow-xl hover:bg-white/95 dark:hover:bg-gray-600/80 hover:scale-[1.02] transition-all duration-300 cursor-pointer",children:[t&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Tasas de Calculadora"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-300",children:"Solo manuales"})]}),i&&a.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin ml-auto"})]}),o?a.jsx("p",{className:"text-red-600 text-xs",children:o}):a.jsx("div",{className:"space-y-1",children:0===d.length?a.jsx("p",{className:"text-gray-500 dark:text-gray-300 text-xs text-center py-2",children:"No hay tasas de calculadora"}):d.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-1 px-2 bg-gray-50 dark:bg-white rounded-md",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-xs",children:h(e.source)}),a.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-900",children:m(e.kind)})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"text-xs font-semibold text-gray-900 dark:text-gray-900",children:e.value}),a.jsx("div",{className:"text-xs text-gray-800 dark:text-gray-900",children:u(e.scope)})]})]},e.id))})]}):(0,a.jsxs)("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 dark:border-gray-600/20 shadow-md dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Tasas de Calculadora"}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Solo tasas manuales"})]})]}),a.jsx("button",{onClick:x,className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-blue-50/80 backdrop-blur-sm border border-blue-200/50 rounded-lg hover:bg-blue-100/80 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200",disabled:i,children:i?"Actualizando...":"Actualizar"})]}),o?(0,a.jsxs)("div",{className:"text-center py-6",children:[a.jsx("div",{className:"w-10 h-10 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),a.jsx("p",{className:"text-red-600 text-xs mb-3",children:o}),a.jsx("button",{onClick:x,className:"px-3 py-1.5 text-xs font-medium text-red-600 bg-red-50/80 backdrop-blur-sm border border-red-200/50 rounded-lg hover:bg-red-100/80 focus:ring-2 focus:ring-red-500/20 transition-all duration-200",children:"Reintentar"})]}):a.jsx("div",{className:"space-y-2",children:0===d.length?(0,a.jsxs)("div",{className:"text-center py-6",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsx("p",{className:"text-gray-500 dark:text-gray-300 text-sm font-medium mb-1",children:"No hay tasas de calculadora"}),a.jsx("p",{className:"text-gray-400 dark:text-gray-400 text-xs",children:"Configura las tasas manualmente"})]}):d.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-white dark:bg-white backdrop-blur-sm rounded-lg border border-gray-200/30 dark:border-gray-500/30 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-6 h-6 bg-gray-50 dark:bg-gray-50 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-xs",children:h(e.source)})}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-900 dark:text-gray-900",children:m(e.kind)}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-900",children:u(e.scope)})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-gray-900",children:e.value}),a.jsx("div",{className:"text-xs text-gray-800 dark:text-gray-900",children:new Date(e.valid_from).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})})]})]},e.id))})]})}},70577:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(95344),s=r(3729),d=r(20783),l=r.n(d),i=r(92509);function n({userRole:e,userId:t,userGroups:r=[]}){let[d,n]=(0,s.useState)(null),[o,c]=(0,s.useState)([]),[x,m]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null),[g,p]=(0,s.useState)("current"),b=(e,t="USD")=>"COP"===t?new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e):new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),y=async(a=!1)=>{try{a||m(!0),h(null);let s=new Date().toISOString().split("T")[0];if("period-1"===g){let e=new Date;s=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-15`}else if("period-2"===g){let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();s=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`}let d=new URLSearchParams({adminId:t,userRole:e,periodDate:s}),l=await fetch(`/api/admin/billing-summary?${d}`),i=await l.json();if(!i.success)throw Error(i.error||"Error al cargar los datos");let o=i.data||[];"admin"===e&&r.length>0&&(o=o.filter(e=>r.includes(e.groupName)));let x={totalModels:o.length,totalUsdBruto:o.reduce((e,t)=>e+t.usdBruto,0),totalUsdModelo:o.reduce((e,t)=>e+t.usdModelo,0),totalUsdSede:o.reduce((e,t)=>e+t.usdSede,0),totalCopModelo:o.reduce((e,t)=>e+t.copModelo,0),totalCopSede:o.reduce((e,t)=>e+t.copSede,0)},u=new Map;o.forEach(e=>{let t=e.organizationId||"unknown",r=e.groupId||"unknown";u.has(t)||u.set(t,{sedeId:t,sedeName:(e.organizationId,"Agencia Innova"),totalModels:0,groups:[],totalUsdBruto:0,totalUsdModelo:0,totalUsdSede:0});let a=u.get(t);a.totalModels++,a.totalUsdBruto+=e.usdBruto,a.totalUsdModelo+=e.usdModelo,a.totalUsdSede+=e.usdSede;let s=a.groups.find(e=>e.groupId===r);s||(s={groupId:r,groupName:e.groupName||"Grupo Desconocido",totalModels:0,totalUsdBruto:0,totalUsdModelo:0,totalUsdSede:0},a.groups.push(s)),s.totalModels++,s.totalUsdBruto+=e.usdBruto,s.totalUsdModelo+=e.usdModelo,s.totalUsdSede+=e.usdSede}),n(x),c(Array.from(u.values()))}catch(e){console.error("Error loading billing data:",e),h(e.message||"Error al cargar los datos")}finally{a||m(!1)}},{isPolling:v,isSilentUpdating:f}=(0,i.t)(y,[t,e,r],{refreshInterval:3e4,enabled:!0,silentUpdate:!0,onRefresh:()=>{console.log("\uD83D\uDD04 [BILLING-SUMMARY-COMPACT] Datos actualizados autom\xe1ticamente")}});return((0,s.useEffect)(()=>{t&&e&&y()},[t,e,r,g]),x)?(0,a.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-700/20 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),a.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Resumen de Facturaci\xf3n"})]}),a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-500"})})]}):u?(0,a.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-700/20 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-red-500 to-red-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Resumen de Facturaci\xf3n"})]}),(0,a.jsxs)("div",{className:"text-center py-4",children:[a.jsx("div",{className:"text-sm text-red-600 mb-2",children:u}),a.jsx("button",{onClick:()=>y(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Reintentar"})]})]}):(0,a.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md dark:shadow-lg dark:shadow-green-900/10 dark:ring-0.5 dark:ring-green-500/15 border border-white/20 dark:border-gray-600/20 p-4 hover:shadow-xl hover:bg-white/95 dark:hover:bg-gray-600/80 hover:scale-[1.02] transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-green-500 to-emerald-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),a.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Resumen de Facturaci\xf3n"})]}),a.jsx(l(),{href:"/admin/sedes/dashboard",className:"text-xs text-blue-600 dark:text-white hover:text-blue-800 dark:hover:text-gray-200 font-medium",children:"Ver completo →"})]}),d&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsxs)("div",{className:"text-center p-2 rounded-lg bg-gray-50/80",children:[(0,a.jsxs)("div",{className:"text-sm font-bold text-gray-900 dark:text-gray-900",children:["$",b(d.totalUsdBruto)]}),a.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:"USD Bruto"})]}),(0,a.jsxs)("div",{className:"text-center p-2 rounded-lg bg-green-50/80",children:[(0,a.jsxs)("div",{className:"text-sm font-bold text-green-600",children:["$",b(d.totalUsdModelo)]}),a.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:"USD Modelo"})]}),(0,a.jsxs)("div",{className:"text-center p-2 rounded-lg bg-orange-50/80",children:[(0,a.jsxs)("div",{className:"text-sm font-bold text-orange-600",children:["$",b(d.totalUsdSede)]}),a.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:"USD Sede"})]})]}),o.length>0&&(0,a.jsxs)("div",{className:"border-t border-gray-200/50 pt-3",children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-gray-900 dark:text-white mb-2",children:[d.totalModels," modelos • ","super_admin"===e?"Todas las sedes":"Tu sede"]}),a.jsx("div",{className:"max-h-48 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:a.jsx("div",{className:"space-y-2 pr-2",children:o.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-white rounded-lg border border-gray-200/40 dark:border-gray-600/40 p-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded flex items-center justify-center",children:a.jsx("svg",{className:"w-2.5 h-2.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-900 dark:text-gray-900",children:e.sedeName}),(0,a.jsxs)("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:[e.totalModels," modelos • ",e.groups.length," grupos"]})]})]}),e.groups.length>0&&a.jsx("div",{className:"ml-6 space-y-1",children:e.groups.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-1.5 bg-gray-50/60 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-gray-400/20 to-gray-500/20 rounded flex items-center justify-center",children:a.jsx("svg",{className:"w-1.5 h-1.5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-medium text-gray-900 dark:text-gray-900",children:e.groupName}),(0,a.jsxs)("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:[e.totalModels," modelos"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-xs font-semibold text-gray-900 dark:text-gray-900",children:["$",b(e.totalUsdBruto)]}),a.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-900",children:"USD Bruto"})]})]},e.groupId))})]},e.sedeId))})})]})]})]})}},8228:(e,t,r)=>{r.d(t,{Z:()=>c});var a=r(95344),s=r(3729),d=r(25545),l=r(66262),i=r(67970);let n=(0,r(97075).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var o=r(33265);function c({userRole:e,userGroups:t}){let[r,c]=(0,s.useState)([]),[x,m]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{g()},[e,t]),(0,s.useEffect)(()=>{r.length>0&&console.log("\uD83D\uDD0D Timeline requests con fechas:",r.map(e=>({id:e.id,status:e.status,requested_at:e.requested_at,delivered_at:e.delivered_at,confirmed_at:e.confirmed_at,deactivated_at:e.deactivated_at,reverted_at:e.reverted_at,updated_at:e.updated_at})))},[r]);let g=async()=>{try{m(!0),h(null);let r=await fetch("/api/modelo-plataformas/timeline",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userRole:e,userGroups:t||[]})});if(!r.ok)throw Error("Error al cargar timeline");let a=await r.json();c(a.requests||[])}catch(e){h(e instanceof Error?e.message:"Error desconocido")}finally{m(!1)}},p=async e=>{try{if(!(await fetch(`/api/modelo-plataformas/timeline/${e}/close`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw Error("Error al cerrar solicitud");await g()}catch(e){h(e instanceof Error?e.message:"Error al cerrar solicitud")}},b=e=>{switch(e){case"solicitada":return"#93c5fd";case"pendiente":return"#fde047";case"entregada":return"#86efac";case"inviable":return"#fca5a5";default:return"#e2e8f0"}},y=e=>{switch(e){case"solicitada":case"pendiente":default:return a.jsx(d.Z,{className:"w-4 h-4"});case"entregada":return a.jsx(l.Z,{className:"w-4 h-4"});case"inviable":return a.jsx(i.Z,{className:"w-4 h-4"})}},v=e=>"entregada"===e||"inviable"===e;return x?a.jsx("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md dark:shadow-lg dark:shadow-purple-900/10 dark:ring-0.5 dark:ring-purple-500/15 border border-white/20 dark:border-gray-600/20 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300 text-sm",children:"Cargando timeline..."})]})}):u?a.jsx("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md dark:shadow-lg dark:shadow-purple-900/10 dark:ring-0.5 dark:ring-purple-500/15 border border-white/20 dark:border-gray-600/20 p-4",children:(0,a.jsxs)("div",{className:"text-center py-4",children:[a.jsx(i.Z,{className:"w-6 h-6 text-red-500 mx-auto mb-2"}),a.jsx("p",{className:"text-red-600 text-sm",children:u})]})}):(0,a.jsxs)("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md dark:shadow-lg dark:shadow-purple-900/10 dark:ring-0.5 dark:ring-purple-500/15 border border-white/20 dark:border-gray-600/20 p-4",style:{overflow:"visible"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 flex items-center",children:[a.jsx(d.Z,{className:"w-4 h-4 mr-2"}),"Timeline Portafolio Modelos"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-300",children:[r.length," solicitud",1!==r.length?"es":""]})]}),0===r.length?(0,a.jsxs)("div",{className:"text-center py-4",children:[a.jsx(d.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-300 text-sm",children:"No hay solicitudes de plataformas activas"})]}):(0,a.jsxs)("div",{className:"max-h-80 overflow-y-auto space-y-3 relative",style:{overflowX:"visible"},children:[r.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-lg border border-white/30 dark:border-gray-600/30 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:b(e.status)}}),a.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:(0,o.W)(e.model_email)}),a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:"•"}),a.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded-full text-white",style:{backgroundColor:b(e.status),textShadow:"0 1px 2px rgba(0,0,0,0.3)",display:"inline-block"},children:e.platform_name}),a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:"•"}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:e.group_name})]}),v(e.status)&&a.jsx("button",{onClick:()=>p(e.id),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Cerrar solicitud",children:a.jsx(n,{className:"w-3 h-3"})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",style:{marginLeft:"calc(2rem + 1.5rem + 0.5rem + 1.5rem + 0.5rem + 3.5rem)"},children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsxs)("div",{className:"relative group",children:[a.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-xs cursor-help",style:{backgroundColor:b("solicitada")},children:y("solicitada")}),(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-[99999]",children:[new Date(e.requested_at).toLocaleDateString()," ",new Date(e.requested_at).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-3 border-r-3 border-t-3 border-transparent border-t-gray-900"})]})]}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Solicitada"})]}),["pendiente","entregada","inviable"].includes(e.status)&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-6 h-0.5 bg-gray-300"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsxs)("div",{className:"relative group",children:[a.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-xs cursor-help",style:{backgroundColor:b("pendiente")},children:y("pendiente")}),(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-[99999]",children:[e.updated_at?`${new Date(e.updated_at).toLocaleDateString()} ${new Date(e.updated_at).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}`:"Sin fecha",a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-3 border-r-3 border-t-3 border-transparent border-t-gray-900"})]})]}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Pendiente"})]})]}),["entregada","inviable"].includes(e.status)&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-6 h-0.5 bg-gray-300"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsxs)("div",{className:"relative group",children:[a.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-xs cursor-help",style:{backgroundColor:b(e.status)},children:y(e.status)}),(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-[99999]",children:["entregada"===e.status&&e.delivered_at?`${new Date(e.delivered_at).toLocaleDateString()} ${new Date(e.delivered_at).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}`:"inviable"===e.status&&e.reverted_at?`${new Date(e.reverted_at).toLocaleDateString()} ${new Date(e.reverted_at).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}`:"Finalizado",a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-3 border-r-3 border-t-3 border-transparent border-t-gray-900"})]})]}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 capitalize",children:"entregada"===e.status?"Entregada":"Inviable"})]})]})]})]},e.id)),r.length>5&&a.jsx("div",{className:"text-center py-2",children:(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:["Y ",r.length-5," solicitud",r.length-5!=1?"es":""," m\xe1s..."]})})]})]})}},92509:(e,t,r)=>{r.d(t,{t:()=>s});var a=r(3729);function s(e,t,r={}){let{refreshInterval:s=3e4,enabled:d=!0,onRefresh:l,silentUpdate:i=!0}=r,n=(0,a.useRef)(null),o=(0,a.useRef)(!0),[c,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),h=(0,a.useCallback)(()=>{l&&l(),e()},[e,l]),g=(0,a.useCallback)(async()=>{if(o.current){u(!0);try{l&&l(),await e(!0)}catch(e){console.error("\uD83D\uDD04 [BILLING-POLLING] Error en actualizaci\xf3n silenciosa:",e)}finally{o.current&&u(!1)}}},[e,l]);return(0,a.useEffect)(()=>(o.current=!0,()=>{o.current=!1}),[]),(0,a.useEffect)(()=>(n.current&&clearInterval(n.current),d&&o.current?(x(!0),n.current=setInterval(()=>{o.current&&(console.log("\uD83D\uDD04 [BILLING-POLLING] Actualizaci\xf3n silenciosa iniciada"),i?g():(l&&l(),e()))},s)):x(!1),()=>{n.current&&clearInterval(n.current)}),[s,d,e,l,i,g,...t]),(0,a.useEffect)(()=>()=>{n.current&&clearInterval(n.current)},[]),{isPolling:c,isSilentUpdating:m,manualRefresh:h}}},66262:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(97075).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},67970:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(97075).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},15807:(e,t,r)=>{r.d(t,{dB:()=>a,iR:()=>s});let a=()=>(console.warn("⚠️ getCalculatorDate() is deprecated. Use getColombiaDate() instead."),s()),s=()=>new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"})},33265:(e,t,r)=>{r.d(t,{W:()=>a});let a=e=>e?e.split("@")[0].split(".").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(""):""}};