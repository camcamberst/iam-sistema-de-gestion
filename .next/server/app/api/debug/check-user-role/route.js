"use strict";(()=>{var e={};e.id=7524,e.ids=[7524],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},43687:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>E,originalPathname:()=>g,patchFetch:()=>R,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>D,staticGenerationBailout:()=>h});var t={};o.r(t),o.d(t,{GET:()=>d,dynamic:()=>l});var s=o(95419),a=o(69108),u=o(99678),n=o(78070),i=o(66569);let l="force-dynamic";async function d(e){try{console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] Starting debug check...");let r=e.headers.get("authorization");if(console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] Auth header present:",!!r),!r)return n.Z.json({error:"No autorizado"},{status:401});let o=r.replace("Bearer ","");console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] Token length:",o.length);let{data:{user:t},error:s}=await i.R.auth.getUser(o);if(console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] Auth result:",{userId:t?.id,userEmail:t?.email,error:s?.message}),s||!t)return n.Z.json({error:"Token inv\xe1lido"},{status:401});let{data:a,error:u}=await i.R.from("users").select("id, role, name, email").eq("id",t.id).single();if(console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] User row query:",{userRow:a,error:u?.message}),u)return console.error("❌ [DEBUG-USER-ROLE] Error querying user:",u),n.Z.json({error:"Error consultando usuario",details:u.message},{status:500});if(!a)return console.error("❌ [DEBUG-USER-ROLE] User not found in database"),n.Z.json({error:"Usuario no encontrado"},{status:404});let l=(a.role||"").toString();return console.log("\uD83D\uDD0D [DEBUG-USER-ROLE] Final role check:",{role:l,isAdmin:"admin"===l,isSuperAdmin:"super_admin"===l,userInfo:a}),n.Z.json({success:!0,user:{id:a.id,name:a.name,email:a.email,role:a.role,isAdmin:"admin"===l,isSuperAdmin:"super_admin"===l,canSendIndividual:"admin"===l||"super_admin"===l}})}catch(e){return console.error("❌ [DEBUG-USER-ROLE] Error:",e),n.Z.json({error:e.message||"Internal server error"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/debug/check-user-role/route",pathname:"/api/debug/check-user-role",filename:"route",bundlePath:"app/api/debug/check-user-role/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\debug\\check-user-role\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:D,serverHooks:m,headerHooks:E,staticGenerationBailout:h}=c,g="/api/debug/check-user-role/route";function R(){return(0,u.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:D})}},66569:(e,r,o)=>{o.d(r,{A:()=>n,R:()=>u});var t=o(72964);let s="https://mhernfrkvwigxdubiozm.supabase.co",a=process.env.SUPABASE_SERVICE_ROLE_KEY||"",u=(0,t.createClient)(s,a,{auth:{autoRefreshToken:!1,persistSession:!1}}),n=(0,t.createClient)(s,a,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[1638,6206,2964],()=>o(43687));module.exports=t})();