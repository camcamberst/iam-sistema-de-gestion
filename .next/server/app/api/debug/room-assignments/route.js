"use strict";(()=>{var e={};e.id=1005,e.ids=[1005],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},92270:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>_,originalPathname:()=>v,patchFetch:()=>b,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>g});var s={};o.r(s),o.d(s,{GET:()=>m});var a=o(95419),t=o(69108),n=o(99678),i=o(78070),d=o(72964);async function m(e){try{let e=process.env.SUPABASE_SERVICE_ROLE_KEY,r=(0,d.createClient)("https://mhernfrkvwigxdubiozm.supabase.co",e),{data:o,error:s}=await r.from("modelo_assignments").select(`
        id,
        model_id,
        room_id,
        jornada,
        is_active,
        assigned_at
      `).eq("is_active",!0).order("assigned_at",{ascending:!1});if(s)return i.Z.json({success:!1,error:`Error obteniendo todas las asignaciones: ${s.message}`});let{data:a,error:t}=await r.from("group_rooms").select("id, room_name, group_id");if(t)return i.Z.json({success:!1,error:`Error obteniendo rooms: ${t.message}`});let{data:n,error:m}=await r.from("users").select("id, name, email, role").eq("role","modelo").eq("is_active",!0);if(m)return i.Z.json({success:!1,error:`Error obteniendo modelos: ${m.message}`});let u=o?.map(e=>{let r=a?.find(r=>r.id===e.room_id),o=n?.find(r=>r.id===e.model_id);return{assignment_id:e.id,room_name:r?.room_name||"Room no encontrado",room_id:e.room_id,jornada:e.jornada,model_name:o?.name||"Modelo no encontrado",model_email:o?.email||"Email no encontrado",model_id:e.model_id,assigned_at:e.assigned_at,is_active:e.is_active}})||[];return i.Z.json({success:!0,total_assignments:u.length,assignments:u,summary:{by_room:u.reduce((e,r)=>{let o=r.room_name;return e[o]||(e[o]={}),e[o][r.jornada]||(e[o][r.jornada]=[]),e[o][r.jornada].push(r.model_name),e},{}),duplicates:u.filter((e,r)=>u.findIndex(r=>r.room_id===e.room_id&&r.jornada===e.jornada&&r.model_id===e.model_id)!==r)}})}catch(e){return console.error("Error en debug room assignments:",e),i.Z.json({success:!1,error:"Error interno del servidor"})}}let u=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/debug/room-assignments/route",pathname:"/api/debug/room-assignments",filename:"route",bundlePath:"app/api/debug/room-assignments/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\debug\\room-assignments\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:p,headerHooks:_,staticGenerationBailout:g}=u,v="/api/debug/room-assignments/route";function b(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:c})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),s=r.X(0,[1638,6206,2964],()=>o(92270));module.exports=s})();