"use strict";(()=>{var e={};e.id=2049,e.ids=[2049],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},25644:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>l,originalPathname:()=>v,patchFetch:()=>b,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var t={};s.r(t),s.d(t,{GET:()=>d,dynamic:()=>c});var a=s(95419),o=s(69108),i=s(99678),n=s(78070),u=s(66569);let c="force-dynamic";async function d(e){try{let r=e.headers.get("authorization");if(!r)return n.Z.json({error:"No autorizado"},{status:401});let s=r.replace("Bearer ",""),{data:{user:t},error:a}=await u.R.auth.getUser(s);if(a||!t)return n.Z.json({error:"Token inv\xe1lido"},{status:401});let{data:o,error:i}=await u.R.from("chat_sessions").select("id").eq("user_id",t.id).eq("is_active",!0);if(i)return console.error("Error fetching user sessions for debug:",i),n.Z.json({error:i.message},{status:500});if(!o||0===o.length)return n.Z.json({success:!0,messages:[],count:0,debug:"No active sessions found for user"});let c=o.map(e=>e.id),{data:d,error:p}=await u.R.from("chat_messages").select("*").in("session_id",c).order("created_at",{ascending:!0});if(p)return console.error("Error fetching chat messages for debug:",p),n.Z.json({error:p.message},{status:500});return n.Z.json({success:!0,messages:d,count:d.length})}catch(e){return console.error("Error in /api/debug/chat-messages:",e),n.Z.json({error:e.message||"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/debug/chat-messages/route",pathname:"/api/debug/chat-messages",filename:"route",bundlePath:"app/api/debug/chat-messages/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\debug\\chat-messages\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:l,staticGenerationBailout:f}=p,v="/api/debug/chat-messages/route";function b(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},66569:(e,r,s)=>{s.d(r,{A:()=>n,R:()=>i});var t=s(72964);let a="https://mhernfrkvwigxdubiozm.supabase.co",o=process.env.SUPABASE_SERVICE_ROLE_KEY||"",i=(0,t.createClient)(a,o,{auth:{autoRefreshToken:!1,persistSession:!1}}),n=(0,t.createClient)(a,o,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[1638,6206,2964],()=>s(25644));module.exports=t})();