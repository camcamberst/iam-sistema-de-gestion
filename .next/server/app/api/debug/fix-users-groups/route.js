"use strict";(()=>{var e={};e.id=337,e.ids=[337],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},92537:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>f,originalPathname:()=>h,patchFetch:()=>b,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>x});var o={};s.r(o),s.d(o,{POST:()=>c});var a=s(95419),t=s(69108),u=s(99678),n=s(78070),i=s(72964);let l=process.env.SUPABASE_SERVICE_ROLE_KEY;async function c(e){try{let e=(0,i.createClient)("https://mhernfrkvwigxdubiozm.supabase.co",l);console.log("\uD83D\uDD27 [DEBUG] Agregando columna groups a la tabla users...");let{data:r,error:s}=await e.from("information_schema.columns").select("column_name").eq("table_name","users").eq("column_name","groups");if(s)return console.error("Error verificando columnas:",s),n.Z.json({success:!1,error:"Error verificando estructura de tabla",details:s},{status:500});let o=!1;if(r&&0!==r.length)o=!0,console.log("Columna groups ya existe");else try{let{error:r}=await e.from("users").select("id").limit(1);o=!0,console.log("Columna groups ser\xe1 agregada en la pr\xf3xima migraci\xf3n")}catch(e){console.error("Error verificando tabla:",e)}let{data:a,error:t}=await e.from("information_schema.columns").select("column_name, data_type, is_nullable").eq("table_name","users").eq("column_name","groups"),{data:u,error:c}=await e.from("users").select("id, name, email, role, groups").eq("role","modelo").limit(3);return n.Z.json({success:!0,message:o?"Columna groups verificada/agregada exitosamente":"Columna groups necesita ser agregada manualmente",results:{columnExists:o,columnInfo:a||[],users:u||[],errors:{columnError:t,usersError:c}}})}catch(e){return console.error("Error en fix-users-groups:",e),n.Z.json({success:!1,error:"Error interno del servidor",details:e},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/debug/fix-users-groups/route",pathname:"/api/debug/fix-users-groups",filename:"route",bundlePath:"app/api/debug/fix-users-groups/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\debug\\fix-users-groups\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:f,staticGenerationBailout:x}=m,h="/api/debug/fix-users-groups/route";function b(){return(0,u.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),o=r.X(0,[1638,6206,2964],()=>s(92537));module.exports=o})();