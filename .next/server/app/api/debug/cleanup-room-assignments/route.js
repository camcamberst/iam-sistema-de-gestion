"use strict";(()=>{var e={};e.id=4544,e.ids=[4544],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},70253:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>p,originalPathname:()=>A,patchFetch:()=>_,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>f});var o={};s.r(o),s.d(o,{POST:()=>u});var a=s(95419),n=s(69108),t=s(99678),i=s(78070),c=s(72964);async function u(e){try{let e=process.env.SUPABASE_SERVICE_ROLE_KEY,r=(0,c.createClient)("https://mhernfrkvwigxdubiozm.supabase.co",e);console.log("\uD83E\uDDF9 [CLEANUP] Iniciando limpieza de asignaciones de ROOM01...");let{data:s,error:o}=await r.from("modelo_assignments").select("*").eq("room_id","17227f3e-9150-428e-a8a8-cca92ee6978c");if(o)return i.Z.json({success:!1,error:`Error obteniendo asignaciones: ${o.message}`});console.log("\uD83D\uDD0D [CLEANUP] Asignaciones encontradas:",s?.length||0),console.log("\uD83D\uDD0D [CLEANUP] Asignaciones:",s);let{error:a}=await r.from("modelo_assignments").delete().eq("room_id","17227f3e-9150-428e-a8a8-cca92ee6978c");if(a)return i.Z.json({success:!1,error:`Error eliminando asignaciones: ${a.message}`});console.log("✅ [CLEANUP] Todas las asignaciones de ROOM01 eliminadas");let{data:n,error:t}=await r.from("modelo_assignments").insert({model_id:"fe54995d-1828-4721-8153-53fce6f4fe56",room_id:"17227f3e-9150-428e-a8a8-cca92ee6978c",jornada:"MA\xd1ANA",is_active:!0,assigned_at:new Date().toISOString()}).select().single();if(t)return i.Z.json({success:!1,error:`Error creando asignaci\xf3n de MA\xd1ANA: ${t.message}`});console.log("✅ [CLEANUP] Asignaci\xf3n de MA\xd1ANA recreada:",n);let{data:u,error:d}=await r.from("modelo_assignments").select("*").eq("room_id","17227f3e-9150-428e-a8a8-cca92ee6978c").eq("is_active",!0);if(d)return i.Z.json({success:!1,error:`Error verificando estado final: ${d.message}`});return i.Z.json({success:!0,message:"Limpieza completada exitosamente",deleted_count:s?.length||0,created_assignment:n,final_assignments:u,summary:{before_cleanup:s?.length||0,after_cleanup:u?.length||0,only_morning_assigned:!0}})}catch(e){return console.error("❌ [CLEANUP] Error general:",e),i.Z.json({success:!1,error:"Error interno del servidor"})}}let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/debug/cleanup-room-assignments/route",pathname:"/api/debug/cleanup-room-assignments",filename:"route",bundlePath:"app/api/debug/cleanup-room-assignments/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\debug\\cleanup-room-assignments\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g,headerHooks:p,staticGenerationBailout:f}=d,A="/api/debug/cleanup-room-assignments/route";function _(){return(0,t.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),o=r.X(0,[1638,6206,2964],()=>s(70253));module.exports=o})();