"use strict";(()=>{var e={};e.id=2087,e.ids=[2087],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},72017:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>g});var o={};r.r(o),r.d(o,{GET:()=>n,dynamic:()=>l});var a=r(95419),i=r(69108),d=r(99678),s=r(78070),c=r(72964);let l="force-dynamic",_=(0,c.createClient)("https://mhernfrkvwigxdubiozm.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function n(e){try{let e={},{data:t,error:r}=await _.from("calculator_history").select("id, model_id, platform_id, value, period_date, period_type, archived_at",{count:"exact"}).eq("period_date","2025-12-01").eq("period_type","1-15");e.search_by_2025_12_01={count:t?.length||0,error:r?.message,sample:t?.slice(0,5)};let{data:o,error:a}=await _.from("calculator_history").select("id, model_id, platform_id, value, period_date, period_type, archived_at",{count:"exact"}).eq("period_date","2025-12-15").eq("period_type","1-15");e.search_by_2025_12_15={count:o?.length||0,error:a?.message,sample:o?.slice(0,5)};let{data:i,error:d}=await _.from("calculator_history").select("id, model_id, platform_id, value, period_date, period_type, archived_at",{count:"exact"}).gte("period_date","2025-12-01").lte("period_date","2025-12-15").eq("period_type","1-15");e.search_by_range_01_to_15={count:i?.length||0,error:d?.message,sample:i?.slice(0,10)};let{data:c,error:l}=await _.from("calculator_history").select("period_date, period_type",{count:"exact"}).gte("period_date","2025-12-01").lte("period_date","2025-12-31"),n={};c?.forEach(e=>{let t=`${e.period_date} (${e.period_type})`;n[t]=(n[t]||0)+1}),e.all_december_2025={count:c?.length||0,error:l?.message,distribution:n};let p=new Date;p.setHours(p.getHours()-24);let{data:u,error:h}=await _.from("calculator_history").select("id, model_id, platform_id, value, period_date, period_type, archived_at",{count:"exact"}).gte("archived_at",p.toISOString());e.recent_24h={count:u?.length||0,error:h?.message,sample:u?.slice(0,10),date_range:{from:p.toISOString(),to:new Date().toISOString()}};let{data:m,error:y}=await _.from("calculator_history").select("id, model_id, platform_id, value, period_date, period_type, archived_at",{count:"exact"}).eq("period_date","2025-12-16").eq("period_type","1-15");e.search_2025_12_16_with_type_1_15={count:m?.length||0,error:y?.message,sample:m?.slice(0,10)};let{data:g,error:f}=await _.from("calculator_history").select("period_date, period_type, model_id").order("period_date",{ascending:!1}).limit(1e3),v={};g?.forEach(e=>{let t=`${e.period_date} (${e.period_type})`;v[t]||(v[t]={count:0,models:new Set}),v[t].count++,v[t].models.add(e.model_id)});let x={};return Object.keys(v).forEach(e=>{x[e]={count:v[e].count,unique_models:v[e].models.size}}),e.full_distribution={total_records:g?.length||0,error:f?.message,by_period:x},s.Z.json({success:!0,search_results:e,summary:{found_in_2025_12_01:t?.length||0,found_in_2025_12_15:o?.length||0,found_in_range_01_15:i?.length||0,found_recent_24h:u?.length||0,found_2025_12_16_type_1_15:m?.length||0}})}catch(e){return console.error("âŒ [SEARCH-HISTORY] Error:",e),s.Z.json({success:!1,error:e instanceof Error?e.message:"Error interno"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/calculator/search-history/route",pathname:"/api/calculator/search-history",filename:"route",bundlePath:"app/api/calculator/search-history/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\calculator\\search-history\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:y,staticGenerationBailout:g}=p,f="/api/calculator/search-history/route";function v(){return(0,d.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[1638,6206,2964],()=>r(72017));module.exports=o})();