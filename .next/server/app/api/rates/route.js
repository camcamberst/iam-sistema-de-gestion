"use strict";(()=>{var e={};e.id=6742,e.ids=[6742],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},20187:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>S,originalPathname:()=>w,patchFetch:()=>I,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>d,dynamic:()=>c});var a=t(95419),o=t(69108),i=t(99678),n=t(78070),u=t(72964);let c="force-dynamic",l=(0,u.createClient)("https://mhernfrkvwigxdubiozm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oZXJuZnJrdndpZ3hkdWJpb3ptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MTY1NDcsImV4cCI6MjA3NDM5MjU0N30.v7qBceGTwaqyDZe5h9yLBjWwuuGEwAq6KVsAH_RNw8c");async function p(e){try{let{searchParams:r}=new URL(e.url),t=r.get("scope")||"global",s="true"===r.get("activeOnly"),a=l.from("rates").select("*").order("valid_from",{ascending:!1});"global"!==t&&(a=a.eq("scope",t)),s&&(a=a.is("valid_to",null));let{data:o,error:i}=await a;if(i)throw Error(`Error de Supabase: ${i.message}`);return n.Z.json({success:!0,data:o||[],meta:{total:o?.length||0,scope:t,activeOnly:s}})}catch(e){return console.error("Error en GET /api/rates:",e),n.Z.json({success:!1,error:e?.message??"Error al obtener tasas"},{status:500})}}async function d(e){try{let r=await e.json(),{scope:t,kind:s,value:a,author_id:o}=r;if(!t||!s||void 0===a)return n.Z.json({success:!1,error:"Datos requeridos: scope, kind, value"},{status:400});if(!["USD→COP","EUR→USD","GBP→USD"].includes(s))return n.Z.json({success:!1,error:"kind debe ser USD→COP, EUR→USD o GBP→USD"},{status:400});await l.from("rates").update({valid_to:new Date().toISOString()}).eq("kind",s).eq("scope",t).is("valid_to",null);let{data:i,error:u}=await l.from("rates").insert({kind:s,value:parseFloat(a),scope:t||"global",scope_id:r.scope_id||null,author_id:o||null,valid_from:new Date().toISOString()}).select().single();if(u)throw Error(`Error de Supabase: ${u.message}`);return n.Z.json({success:!0,data:i,message:"Tasa creada exitosamente"})}catch(e){return console.error("Error en POST /api/rates:",e),n.Z.json({success:!1,error:e?.message??"Error al crear tasa"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/rates/route",pathname:"/api/rates",filename:"route",bundlePath:"app/api/rates/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\rates\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:v,headerHooks:S,staticGenerationBailout:f}=m,w="/api/rates/route";function I(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,2964],()=>t(20187));module.exports=s})();