"use strict";(()=>{var e={};e.id=5808,e.ids=[5808],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},92613:(e,r,a)=>{a.r(r),a.d(r,{headerHooks:()=>f,originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>g});var o={};a.r(o),a.d(o,{POST:()=>u});var t=a(95419),s=a(69108),i=a(99678),l=a(78070);let n=(0,a(72964).createClient)("https://mhernfrkvwigxdubiozm.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function u(e){try{console.log("\uD83E\uDDF9 Limpiando completamente los datos de las modelos (excluyendo un ID espec\xedfico)...");let{data:e,error:r}=await n.from("users").select("id, email").eq("role","modelo").neq("id","fe54995d-1828-4721-8153-53fce6f4fe56");if(r)return console.error("Error obteniendo usuarios objetivo:",r),l.Z.json({success:!1,error:r.message},{status:500});if(!e||0===e.length)return l.Z.json({success:!0,message:"No hay modelos para limpiar (o solo la modelo excluida).",cleaned:0});let a=e.map(e=>e.id);console.log(`📋 Modelos encontradas para limpieza completa: ${e.length}`);let{error:o}=await n.from("modelo_plataformas").delete().in("model_id",a);if(o)return console.error("Error eliminando portafolios:",o),l.Z.json({success:!1,error:o.message},{status:500});let{error:t}=await n.from("calculator_config").delete().in("model_id",a);if(t)return console.error("Error eliminando configuraciones de calculadora:",t),l.Z.json({success:!1,error:t.message},{status:500});let s=e.map(e=>({email:e.email,user_id:e.id,status:"Limpieza completa realizada"}));return console.log("✅ Limpieza completa realizada exitosamente"),l.Z.json({success:!0,message:`Limpieza completa realizada. ${e.length} modelos preparadas para configuraci\xf3n inicial`,cleaned:e.length,results:s})}catch(e){return console.error("❌ Error en limpieza completa:",e),l.Z.json({success:!1,error:e.message||"Error interno del servidor"},{status:500})}}let c=new t.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/cleanup-all-model-data/route",pathname:"/api/cleanup-all-model-data",filename:"route",bundlePath:"app/api/cleanup-all-model-data/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\cleanup-all-model-data\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:f,staticGenerationBailout:g}=c,h="/api/cleanup-all-model-data/route";function x(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var r=require("../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),o=r.X(0,[1638,6206,2964],()=>a(92613));module.exports=o})();