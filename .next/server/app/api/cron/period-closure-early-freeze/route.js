"use strict";(()=>{var e={};e.id=9198,e.ids=[9198],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},65062:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>h,patchFetch:()=>D,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>u,staticGenerationBailout:()=>E});var o={};r.r(o),r.d(o,{GET:()=>p});var a=r(95419),i=r(69108),n=r(99678),s=r(78070),l=r(18539);async function p(e){try{if(console.log("\uD83D\uDD50 [CRON-EARLY-FREEZE] Verificando congelaci\xf3n anticipada..."),!(0,l.UX)()){let e=new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"}),t=parseInt(e.split("-")[2]);return s.Z.json({success:!0,message:"No es el \xfaltimo d\xeda de un per\xedodo (debe ser d\xeda 15 o el \xfaltimo d\xeda del mes)",current_day:t})}if(!(0,l.a9)())return s.Z.json({success:!0,message:"No es momento de congelaci\xf3n anticipada (medianoche Europa Central)"});let t=process.env.VERCEL_PROJECT_PRODUCTION_URL?.trim(),r=e.nextUrl?.origin,o="http://localhost:3000".trim()||(t?`https://${t}`:"")||r||"https://iam-sistema-de-gestion.vercel.app",a=await fetch(`${o}/api/calculator/period-closure/early-freeze`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.CRON_SECRET_KEY||"cron-secret"}`}});if(!a.ok){let e=await a.json();return console.error("❌ [CRON-EARLY-FREEZE] Error en early-freeze:",e),s.Z.json({success:!1,error:"Error ejecutando congelaci\xf3n anticipada",details:e},{status:500})}let i=await a.json();return console.log("✅ [CRON-EARLY-FREEZE] Congelaci\xf3n anticipada ejecutada:",i),s.Z.json({success:!0,message:"Congelaci\xf3n anticipada ejecutada exitosamente",execution_time:new Date().toISOString(),result:i})}catch(e){return console.error("❌ [CRON-EARLY-FREEZE] Error:",e),s.Z.json({success:!1,error:"Error interno del servidor",details:e instanceof Error?e.message:"Error desconocido"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/cron/period-closure-early-freeze/route",pathname:"/api/cron/period-closure-early-freeze",filename:"route",bundlePath:"app/api/cron/period-closure-early-freeze/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\cron\\period-closure-early-freeze\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:u,serverHooks:m,headerHooks:g,staticGenerationBailout:E}=c,h="/api/cron/period-closure-early-freeze/route";function D(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:u})}},18539:(e,t,r)=>{r.d(t,{Bm:()=>a,Ck:()=>u,UX:()=>m,Y:()=>s,a9:()=>n,g5:()=>l,iR:()=>o,im:()=>p,ns:()=>d,o8:()=>i,sF:()=>c});let o=()=>new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"}),a=()=>new Date().toLocaleString("sv-SE",{timeZone:"America/Bogota"}),i=e=>{let t=e||new Date,r=new Intl.DateTimeFormat("en-CA",{timeZone:"Europe/Berlin",year:"numeric",month:"2-digit",day:"2-digit"}).format(t),o=new Intl.DateTimeFormat("en-US",{timeZone:"Europe/Berlin",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(t),a={};o.forEach(e=>{"literal"!==e.type&&(a[e.type]=e.value)});let i=new Date(`${a.year}-${a.month}-${a.day}T00:00:00Z`),n=null;for(let e of[1,2]){let t=new Date(i.getTime()-36e5*e);if("00:00:00"===new Intl.DateTimeFormat("en-US",{timeZone:"Europe/Berlin",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(t)){n=t;break}}n||(n=new Date(i.getTime()-54e5));let s=new Intl.DateTimeFormat("en-US",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(n),l={};return s.forEach(e=>{"literal"!==e.type&&(l[e.type]=e.value)}),{colombiaTime:`${l.hour}:${l.minute}:${l.second}`||"00:00:00",colombiaDate:`${l.year}-${l.month}-${l.day}`,colombiaDateTime:n,europeDate:r}},n=()=>{let e=new Date,t=a(),r=i(e),[o,n]=t.split(" ")[1]?.split(":")||["00","00"],[s,l]=r.colombiaTime.split(":");return 5>=Math.abs(60*parseInt(o)+parseInt(n)-(60*parseInt(s)+parseInt(l)))},s=()=>{let e=a(),[t,r]=e.split(" ")[1]?.split(":")||["00","00"],o=parseInt(t),i=parseInt(r);return 0===o&&i>=0&&i<=15},l=["superfoon","livecreator","mdh","777","xmodels","big7","mondo","vx","babestation","dirtyfans"],p=()=>{let e=parseInt(o().split("-")[2]);return e>=1&&e<=15?"1-15":"16-31"},c=()=>{let e=o(),[t,r,a]=e.split("-").map(Number);if(1===a){let e=1===r?12:r-1,o=1===r?t-1:t;return new Date(o,e,0).getDate(),{periodDate:`${o}-${String(e).padStart(2,"0")}-16`,periodType:"16-31"}}return 16===a?{periodDate:`${t}-${String(r).padStart(2,"0")}-01`,periodType:"1-15"}:{periodDate:e,periodType:a<=15?"1-15":"16-31"}},d=()=>{let e=o(),[t,r,a]=e.split("-").map(Number);return 1===a?{periodDate:e,periodType:"1-15"}:16===a?{periodDate:e,periodType:"16-31"}:{periodDate:e,periodType:a<=15?"1-15":"16-31"}},u=()=>{let e=parseInt(o().split("-")[2]);return 1===e||16===e},m=()=>{let[e,t,r]=o().split("-").map(Number);return 15===r||r===new Date(e,t,0).getDate()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[1638,6206],()=>r(65062));module.exports=o})();