"use strict";(()=>{var e={};e.id=9524,e.ids=[9524],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},77424:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>D});var o={};r.r(o),r.d(o,{GET:()=>c});var i=r(95419),a=r(69108),n=r(99678),s=r(78070),l=r(18539);async function c(e){try{if(console.log("\uD83D\uDD50 [CRON-FULL-CLOSE] Verificando cierre completo..."),!(0,l.Ck)()){let e=new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"}),t=parseInt(e.split("-")[2]);return s.Z.json({success:!0,message:"No es d\xeda de cierre (1 o 16)",current_day:t})}if(!(0,l.Y)())return s.Z.json({success:!0,message:"No es momento de cierre completo (00:00 Colombia)"});let t=process.env.VERCEL_PROJECT_PRODUCTION_URL?.trim(),r=e.nextUrl?.origin,o="http://localhost:3000".trim()||(t?`https://${t}`:"")||r||"https://iam-sistema-de-gestion.vercel.app",i=await fetch(`${o}/api/calculator/period-closure/close-period`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.CRON_SECRET_KEY||"cron-secret"}`}});if(!i.ok){let e=await i.json();return console.error("❌ [CRON-FULL-CLOSE] Error en close-period:",e),s.Z.json({success:!1,error:"Error ejecutando cierre completo",details:e},{status:500})}let a=await i.json();return console.log("✅ [CRON-FULL-CLOSE] Cierre completo ejecutado:",a),s.Z.json({success:!0,message:"Cierre completo ejecutado exitosamente",execution_time:new Date().toISOString(),result:a})}catch(e){return console.error("❌ [CRON-FULL-CLOSE] Error:",e),s.Z.json({success:!1,error:"Error interno del servidor",details:e instanceof Error?e.message:"Error desconocido"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/cron/period-closure-full-close/route",pathname:"/api/cron/period-closure-full-close",filename:"route",bundlePath:"app/api/cron/period-closure-full-close/route"},resolvedPagePath:"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\api\\cron\\period-closure-full-close\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:g,staticGenerationBailout:D}=p,h="/api/cron/period-closure-full-close/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},18539:(e,t,r)=>{r.d(t,{Bm:()=>i,Ck:()=>d,UX:()=>m,Y:()=>s,a9:()=>n,g5:()=>l,iR:()=>o,im:()=>c,ns:()=>u,o8:()=>a,sF:()=>p});let o=()=>new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"}),i=()=>new Date().toLocaleString("sv-SE",{timeZone:"America/Bogota"}),a=e=>{let t=e||new Date,r=new Intl.DateTimeFormat("en-CA",{timeZone:"Europe/Berlin",year:"numeric",month:"2-digit",day:"2-digit"}).format(t),o=new Intl.DateTimeFormat("en-US",{timeZone:"Europe/Berlin",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(t),i={};o.forEach(e=>{"literal"!==e.type&&(i[e.type]=e.value)});let a=new Date(`${i.year}-${i.month}-${i.day}T00:00:00Z`),n=null;for(let e of[1,2]){let t=new Date(a.getTime()-36e5*e);if("00:00:00"===new Intl.DateTimeFormat("en-US",{timeZone:"Europe/Berlin",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(t)){n=t;break}}n||(n=new Date(a.getTime()-54e5));let s=new Intl.DateTimeFormat("en-US",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(n),l={};return s.forEach(e=>{"literal"!==e.type&&(l[e.type]=e.value)}),{colombiaTime:`${l.hour}:${l.minute}:${l.second}`||"00:00:00",colombiaDate:`${l.year}-${l.month}-${l.day}`,colombiaDateTime:n,europeDate:r}},n=()=>{let e=new Date,t=i(),r=a(e),[o,n]=t.split(" ")[1]?.split(":")||["00","00"],[s,l]=r.colombiaTime.split(":");return 5>=Math.abs(60*parseInt(o)+parseInt(n)-(60*parseInt(s)+parseInt(l)))},s=()=>{let e=i(),[t,r]=e.split(" ")[1]?.split(":")||["00","00"],o=parseInt(t),a=parseInt(r);return 0===o&&a>=0&&a<=15},l=["superfoon","livecreator","mdh","777","xmodels","big7","mondo","vx","babestation","dirtyfans"],c=()=>{let e=parseInt(o().split("-")[2]);return e>=1&&e<=15?"1-15":"16-31"},p=()=>{let e=o(),[t,r,i]=e.split("-").map(Number);if(1===i){let e=1===r?12:r-1,o=1===r?t-1:t;return new Date(o,e,0).getDate(),{periodDate:`${o}-${String(e).padStart(2,"0")}-16`,periodType:"16-31"}}return 16===i?{periodDate:`${t}-${String(r).padStart(2,"0")}-01`,periodType:"1-15"}:{periodDate:e,periodType:i<=15?"1-15":"16-31"}},u=()=>{let e=o(),[t,r,i]=e.split("-").map(Number);return 1===i?{periodDate:e,periodType:"1-15"}:16===i?{periodDate:e,periodType:"16-31"}:{periodDate:e,periodType:i<=15?"1-15":"16-31"}},d=()=>{let e=parseInt(o().split("-")[2]);return 1===e||16===e},m=()=>{let[e,t,r]=o().split("-").map(Number);return 15===r||r===new Date(e,t,0).getDate()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[1638,6206],()=>r(77424));module.exports=o})();