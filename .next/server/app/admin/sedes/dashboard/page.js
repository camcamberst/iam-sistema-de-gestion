(()=>{var e={};e.id=9726,e.ids=[9726],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},19918:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>g,tree:()=>n});var a=t(50482),s=t(69108),d=t(62563),l=t.n(d),i=t(68300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(r,o);let n=["",{children:["admin",{children:["sedes",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,73186)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\sedes\\dashboard\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,66294)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,41878)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\sedes\\dashboard\\page.tsx"],x="/admin/sedes/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/sedes/dashboard/page",pathname:"/admin/sedes/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},18792:(e,r,t)=>{Promise.resolve().then(t.bind(t,34517))},34517:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var a=t(95344),s=t(3729),d=t(15807),l=t(92509);function i({userRole:e,userId:r,userGroups:t=[],selectedDate:i,selectedPeriod:o}){console.log("\uD83D\uDD0D [BILLING-SUMMARY] Componente renderizado:",{userRole:e,userId:r});let[n,c]=(0,s.useState)([]),[x,m]=(0,s.useState)([]),[g,u]=(0,s.useState)(null),[h,b]=(0,s.useState)(!0),[p,y]=(0,s.useState)(null),[j,k]=(0,s.useState)(i||(0,d.iR)()),[v,f]=(0,s.useState)(""),[N,w]=(0,s.useState)(o||"current"),[D,S]=(0,s.useState)([]),[L,M]=(0,s.useState)(new Set),[C,A]=(0,s.useState)(new Set),[$,B]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"super_admin"===e&&I()},[e]),(0,s.useEffect)(()=>{U()},[j,v,N,r]);let I=async()=>{try{let e=await fetch("/api/groups"),r=await e.json();r.success&&S(r.data||[])}catch(e){console.error("Error al cargar sedes:",e)}},U=async(a=!1)=>{try{console.log("\uD83D\uDD0D [BILLING-SUMMARY] Iniciando carga de datos:",{userId:r,userRole:e,selectedDate:j,selectedSede:v,selectedPeriod:N,userGroups:t,silent:a}),a||b(!0),y(null),a||(c([]),m([]),u(null));let s=j;if("period-1"===N){let e=new Date(j);s=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-15`}else if("period-2"===N){let e=new Date(j),r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();s=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`}let d=new URLSearchParams({adminId:r,periodDate:s});v&&d.append("sedeId",v),console.log("\uD83D\uDD0D [BILLING-SUMMARY] Par\xe1metros:",d.toString());let l=`/api/admin/billing-summary?${d}&_t=${Date.now()}`;console.log("\uD83D\uDD0D [BILLING-SUMMARY] URL completa:",l);let i=await fetch(l,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}}),o=await i.json();if(console.log("\uD83D\uDD0D [BILLING-SUMMARY] Respuesta API:",o),!o.success)throw Error(o.error||"Error al cargar datos");console.log("\uD83D\uDD0D [BILLING-SUMMARY] Estableciendo nuevos datos:",{billingDataLength:o.data?.length||0,summary:o.summary,groupedDataLength:o.groupedData?.length||0,groupedData:o.groupedData,userGroups:t});let n=o.data||[],x=o.groupedData||[],g=o.summary||null;c(n),m(x),u(g)}catch(e){console.error("Error al cargar resumen de facturaci\xf3n:",e),y(e.message||"Error al cargar datos")}finally{a||b(!1)}},{isPolling:_,isSilentUpdating:E,manualRefresh:P}=(0,l.t)(U,[j,v,r],{refreshInterval:3e4,enabled:!0,silentUpdate:!0,onRefresh:()=>{console.log("\uD83D\uDD04 [BILLING-SUMMARY] Datos actualizados autom\xe1ticamente")}}),R=(e,r="USD")=>"COP"===r?e.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}):e.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),z=e=>{let r=new Set(L);r.has(e)?r.delete(e):r.add(e),M(r)},O=e=>{let r=new Set(C);r.has(e)?r.delete(e):r.add(e),A(r)};return h?a.jsx("div",{className:"mb-10",children:a.jsx("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-600 dark:text-gray-500 dark:text-gray-300",children:"Cargando resumen de facturaci\xf3n..."})]})})}):p?a.jsx("div",{className:"mb-10",children:a.jsx("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-red-500 text-lg mb-2",children:"⚠️"}),a.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium",children:"Error al cargar datos"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-600 dark:text-gray-500 dark:text-gray-600 dark:text-gray-500 text-sm mt-1",children:p}),a.jsx("button",{onClick:()=>U(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"})]})})}):a.jsx("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl p-4 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md",children:a.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Resumen de Facturaci\xf3n"}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-white",children:"super_admin"===e?"Vista consolidada de todas las sedes":"Vista de tus sedes asignadas"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[a.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${_?"bg-green-500":"bg-gray-400"} ${E?"animate-pulse":""}`}),a.jsx("span",{className:"text-xs text-gray-500 dark:text-white",children:E?"Actualizando...":_?"Actualizaci\xf3n autom\xe1tica":"Manual"})]}),a.jsx("button",{onClick:P,disabled:h,className:"flex items-center justify-center w-8 h-8 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",title:h?"Actualizando...":"Actualizar",children:a.jsx("svg",{className:`w-3.5 h-3.5 ${h?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"date",value:j,onChange:e=>k(e.target.value),className:"px-2 py-1.5 bg-gray-50/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:bg-gray-50/90 dark:hover:bg-gray-600/90 text-xs text-gray-700 dark:text-white"})})]})]}),(0,a.jsxs)("div",{className:"px-4 pb-4",children:[g&&(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6 mt-6",children:[a.jsx("div",{className:"bg-blue-50/80 dark:bg-blue-50/90 backdrop-blur-sm rounded-lg p-4 hover:shadow-md transition-all duration-300 border border-blue-200/50 dark:border-blue-200/50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-600 mb-2",children:["$",R(g.totalUsdBruto)]}),a.jsx("div",{className:"inline-block bg-blue-100/80 dark:bg-blue-200/80 text-blue-700 dark:text-blue-700 px-2 py-1 rounded-full text-xs font-medium",children:"USD Bruto"})]})}),a.jsx("div",{className:"bg-green-50/80 dark:bg-green-50/90 backdrop-blur-sm rounded-lg p-4 hover:shadow-md transition-all duration-300 border border-green-200/50 dark:border-green-200/50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-xl font-bold text-green-600 dark:text-green-600 mb-2",children:["$",R(g.totalUsdModelo)]}),a.jsx("div",{className:"inline-block bg-green-100/80 dark:bg-green-200/80 text-green-700 dark:text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:"USD Modelo"})]})}),a.jsx("div",{className:"bg-purple-50/80 dark:bg-purple-50/90 backdrop-blur-sm rounded-lg p-4 hover:shadow-md transition-all duration-300 border border-purple-200/50 dark:border-purple-200/50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-600 mb-2",children:["$",R(g.totalUsdSede)]}),a.jsx("div",{className:"inline-block bg-purple-100/80 dark:bg-purple-200/80 text-purple-700 dark:text-purple-700 px-2 py-1 rounded-full text-xs font-medium",children:"USD Sede"})]})})]}),"super_admin"===e&&x&&x.length>0?a.jsx("div",{className:"space-y-4",children:x.map(e=>(0,a.jsxs)("div",{className:"bg-white/70 dark:bg-white backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-200/50 overflow-hidden hover:shadow-lg transition-all duration-300",children:[a.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-gray-50/50 dark:hover:bg-gray-600/50 transition-all duration-200",onClick:()=>z(e.sedeId),children:a.jsx("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:a.jsx("svg",{className:`w-4 h-4 text-gray-600 dark:text-gray-600 dark:text-gray-500 transition-transform duration-200 ${L.has(e.sedeId)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-900",children:e.sedeName}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:[e.totalModels," modelos • ",e.groups?.length||0," grupos"]})]})]})})}),L.has(e.sedeId)&&a.jsx("div",{className:"bg-gray-50/30 dark:bg-gray-600/30 border-t border-gray-200/50 dark:border-gray-500/50",children:e.groups?.map(e=>a.jsxs("div",{className:"border-b border-gray-200/30 last:border-b-0",children:[a.jsx("div",{className:"px-6 py-4 cursor-pointer hover:bg-white/50 transition-all duration-200",onClick:()=>O(e.groupId),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:`w-3 h-3 text-gray-600 dark:text-gray-600 dark:text-gray-500 transition-transform duration-200 ${C.has(e.groupId)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-base font-semibold text-gray-900 dark:text-gray-900",children:e.groupName}),a.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-600 dark:text-gray-500",children:[e.totalModels," modelos"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["$",R(e.totalUsdBruto)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(e.totalUsdModelo)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-purple-600 dark:text-purple-400",children:["$",R(e.totalUsdSede)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]})}),C.has(e.groupId)&&a.jsx("div",{className:"bg-white/40 border-t border-gray-200/30",children:a.jsx("div",{className:"px-6 py-4",children:a.jsx("div",{className:"space-y-3",children:e.models.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/70 rounded-xl shadow-sm border border-white/20 hover:shadow-md hover:bg-white/80 transition-all duration-300",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-600 dark:text-gray-500",children:e.email.charAt(0).toUpperCase()})}),a.jsx("div",{children:a.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-800",children:e.email})})]}),a.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["$",R(e.usdBruto)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(e.usdModelo)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-semibold text-purple-600 dark:text-purple-400",children:["$",R(e.usdSede)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]},e.modelId))})})})]},e.groupId))})]},e.sedeId))}):n.length>0?a.jsx("div",{className:"space-y-3",children:x&&x.length>0?a.jsx("div",{className:"space-y-3",children:x.map(e=>(0,a.jsxs)("div",{className:"bg-white/70 dark:bg-white backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-200/50 overflow-hidden hover:shadow-lg transition-all duration-300",children:[a.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-gray-50/50 dark:hover:bg-gray-600/50 transition-all duration-200",onClick:()=>z(e.sedeId),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:a.jsx("svg",{className:`w-4 h-4 text-gray-600 dark:text-gray-600 dark:text-gray-500 transition-transform duration-200 ${L.has(e.sedeId)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-900",children:e.sedeName}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-600 dark:text-gray-500",children:[e.totalModels," modelos • ",e.groups?.length||0," grupos"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["$",R(e.totalUsdBruto)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(e.totalUsdModelo)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-purple-600 dark:text-purple-400",children:["$",R(e.totalUsdSede)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]})}),L.has(e.sedeId)&&a.jsx("div",{className:"bg-gray-50/30 dark:bg-gray-600/30 border-t border-gray-200/50 dark:border-gray-500/50",children:a.jsx("div",{className:"space-y-2 p-4",children:e.models.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/60 rounded-lg border border-gray-200/40 hover:bg-white/80 transition-all duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400",children:e.email.charAt(0).toUpperCase()})}),a.jsx("div",{children:a.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-800 text-sm",children:e.email})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-700 dark:text-gray-700",children:["$",R(e.usdBruto)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(e.usdModelo)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-orange-600 dark:text-orange-400",children:["$",R(e.usdSede)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]},e.modelId))})})]},e.sedeId))}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/70 rounded-xl border border-gray-200/50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>B(!$),className:"w-8 h-8 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-lg flex items-center justify-center hover:bg-blue-500/20 transition-all duration-200",children:a.jsx("svg",{className:`w-4 h-4 text-blue-600 dark:text-blue-400 transition-transform duration-200 ${$?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5l7 7-7 7"})})}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-800",children:"admin"===e?`Mis Modelos (${n.length})`:`Todos los Modelos (${n.length})`}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-600 dark:text-gray-500",children:["Haz clic para ",$?"ocultar":"mostrar"," detalles"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-700 dark:text-gray-700",children:["$",R(n.reduce((e,r)=>e+r.usdBruto,0))]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(n.reduce((e,r)=>e+r.usdModelo,0))]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-orange-600 dark:text-orange-400",children:["$",R(n.reduce((e,r)=>e+r.usdSede,0))]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]}),$&&a.jsx("div",{className:"space-y-2",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/60 rounded-xl border border-gray-200/40 hover:bg-white/80 transition-all duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400",children:e.email.charAt(0).toUpperCase()})}),a.jsx("div",{children:a.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-800",children:e.email})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-700 dark:text-gray-700",children:["$",R(e.usdBruto)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Bruto"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",R(e.usdModelo)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Modelo"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-orange-600 dark:text-orange-400",children:["$",R(e.usdSede)]}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"USD Sede"})]})]})]},e.modelId))})]})}):(0,a.jsxs)("div",{className:"text-center py-12 text-gray-400 dark:text-gray-500",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100/60 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-600 dark:text-gray-500 mb-1",children:"No hay datos disponibles"}),a.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-600 dark:text-gray-500",children:"No se encontraron modelos con datos para el per\xedodo seleccionado"})]})]})]})})}function o(){let[e,r]=(0,s.useState)({totalSedes:0,totalRooms:0,totalModelos:0,asignacionesActivas:0,sedesConRooms:0,sedesSinRooms:0}),[t,d]=(0,s.useState)(!1),[l,o]=(0,s.useState)(""),[n,c]=(0,s.useState)(""),[x,m]=(0,s.useState)("P1"),[g,u]=(0,s.useState)(""),[h,b]=(0,s.useState)(!0),[p,y]=(0,s.useState)(null),[j,k]=(0,s.useState)("admin"),[v,f]=(0,s.useState)([]),[N,w]=(0,s.useState)(""),[D,S]=(0,s.useState)(""),[L,M]=(0,s.useState)(null),[C,A]=(0,s.useState)(!1),[$,B]=(0,s.useState)([]),[I,U]=(0,s.useState)(null),_=e=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e)-1]||"",E=()=>{let e;if(!l||!n)return;let r=parseInt(n),t=parseInt(l);e="P1"===x?15:new Date(r,t,0).getDate(),u(`${r}-${String(t).padStart(2,"0")}-${String(e).padStart(2,"0")}`)};(0,s.useEffect)(()=>{window.scrollTo(0,0),P()},[]),(0,s.useEffect)(()=>{l&&n&&x&&E()},[l,n,x]),(0,s.useEffect)(()=>{I&&setTimeout(()=>{let e=document.querySelector(".dropdown-container");e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[I]),(0,s.useEffect)(()=>{let e=e=>{let r=e.target;I&&!r.closest(".dropdown-container")&&U(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[I]),(0,s.useEffect)(()=>{j&&v.length>=0&&z()},[j,v]),(0,s.useEffect)(()=>{D&&$.length>0&&R(D)},[D,$]);let P=()=>{try{let e=localStorage.getItem("user");if(e){let r=JSON.parse(e);k(r.role||"admin"),f(r.groups?.map(e=>e.id)||[]),w(r.id||"")}}catch(e){console.warn("Error parsing user data from localStorage:",e)}},R=async e=>{if(!e){M(null);return}try{A(!0),console.log("\uD83D\uDD0D [DASHBOARD] Cargando disponibilidad para sede:",e);let r=await fetch("/api/groups/rooms"),t=await r.json();if(!t.success)throw Error("Error obteniendo rooms");let a=t.rooms.filter(r=>r.group_id===e);console.log("\uD83D\uDD0D [DASHBOARD] Rooms de la sede:",a.length);let s=a.map(async e=>{try{let r=await fetch(`/api/room-assignments?roomId=${e.id}`),t=await r.json();return t.success?t.assignments:[]}catch(r){return console.warn(`Error obteniendo asignaciones para room ${e.id}:`,r),[]}}),d=(await Promise.all(s)).flat(),l={manana:0,tarde:0,noche:0},i={manana:0,tarde:0,noche:0};["MA\xd1ANA","TARDE","NOCHE"].forEach((e,r)=>{let t=0===r?"manana":1===r?"tarde":"noche",s=d.filter(r=>r.jornada===e),o=new Set(s.map(e=>e.model_id)),n=Math.max(0,a.length-o.size);l[t]=n;let c=Math.max(0,s.length-o.size);i[t]=c});let o=$.find(r=>r.id===e),n={sede_id:e,sede_nombre:o?.name||"Sede Desconocida",rooms_disponibles:a.filter(e=>e.is_active).length,rooms_totales:a.length,jornadas_disponibles:l,jornadas_dobladas:i,total_espacios:3*a.length};M(n),console.log("✅ [DASHBOARD] Disponibilidad calculada:",n)}catch(e){console.error("❌ [DASHBOARD] Error cargando disponibilidad:",e),y("Error cargando disponibilidad de la sede")}finally{A(!1)}},z=async()=>{try{b(!0),y(null);let[e,t,a,s]=await Promise.all([fetch("/api/groups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userRole:j,userGroups:v})}),fetch("/api/groups/rooms"),fetch("/api/users"),fetch("/api/assignments/all")]),[d,l,i,o]=await Promise.all([e.json(),t.json(),a.json(),s.json()]),n=d.success&&d.groups||[],c=l.success&&l.rooms||[],x=o.success&&o.assignments||[];"super_admin"!==j&&v.length>0&&(c=c.filter(e=>v.includes(e.group_id)),x=x.filter(e=>v.includes(e.group_id)));let m=n.filter(e=>"Otros"!==e.name&&"Sat\xe9lites"!==e.name);B(m);let g=n.length,u=c.length,h=0;console.log("\uD83D\uDD0D [DASHBOARD] usersData:",i),i.success&&i.users&&Array.isArray(i.users)?(h=i.users.filter(e=>"modelo"===e.role&&e.is_active).length,console.log("✅ [DASHBOARD] Modelos encontrados:",h)):console.error("❌ [DASHBOARD] Error en usersData:",{success:i.success,hasUsers:!!i.users,isArray:Array.isArray(i.users),error:i.error});let p=x.length,k=n.filter(e=>c.some(r=>r.group_id===e.id)).length;r({totalSedes:g,totalRooms:u,totalModelos:h,asignacionesActivas:p,sedesConRooms:k,sedesSinRooms:g-k})}catch(e){console.error("Error cargando datos del dashboard:",e),y("Error cargando datos del dashboard")}finally{b(!1)}};return h?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:a.jsx("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Cargando dashboard..."})]})})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 pb-48",children:(0,a.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:["admin"===j&&0===$.length&&a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"bg-gradient-to-r from-yellow-50/80 to-orange-50/80 dark:bg-yellow-900/20 dark:border-yellow-700/50 backdrop-blur-sm rounded-xl p-6 border border-yellow-200/30 dark:border-yellow-700/50",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-200",children:"Sin Sedes Asignadas"}),a.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"No tienes sedes asignadas para ver estad\xedsticas. Contacta al Super Admin para que te asigne sedes."})]})]})})}),a.jsx("div",{className:"mb-12",children:a.jsx("div",{className:"bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-md",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Dashboard Sedes"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"super_admin"===j?"Vista global del estado de todas las sedes y asignaciones":"Vista del estado de tus sedes asignadas"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Acceso: ",a.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400 dark:text-blue-400",children:"super_admin"===j?"Super Admin":"Admin"})]})]})})}),N&&("super_admin"===j||"admin"===j)&&a.jsx(i,{userRole:j,userId:N,userGroups:v,selectedDate:g,selectedPeriod:x}),a.jsx("div",{className:"mb-8 relative z-[99999]",children:(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-md",children:a.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Consulta Hist\xf3rica"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Consulta per\xedodos hist\xf3ricos de facturaci\xf3n"})]})]}),a.jsx("button",{onClick:()=>d(!t),className:"px-3 py-1.5 text-xs font-medium bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 shadow-md",children:t?"Ocultar":"Consultar Per\xedodos"})]}),t&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"dropdown-container",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"A\xf1o"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>U("year"===I?null:"year"),className:"w-full px-3 py-2 border-0 bg-gray-50/80 dark:bg-gray-700/80 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:bg-white dark:focus:bg-gray-600 text-sm text-gray-700 dark:text-gray-200 transition-all duration-200 flex items-center justify-between",children:[a.jsx("span",{children:n||"Seleccionar a\xf1o"}),a.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${"year"===I?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),"year"===I&&a.jsx("div",{className:"absolute z-[999999] mt-2 left-0 w-full bg-white dark:bg-gray-700 backdrop-blur-sm border border-gray-200 dark:border-gray-600 rounded-xl shadow-lg max-h-56 overflow-auto",children:a.jsx("div",{className:"py-2",children:Array.from({length:5},(e,r)=>{let t=new Date().getFullYear()-r;return(0,a.jsxs)("button",{onClick:()=>{c(t.toString()),U(null)},className:`w-full text-left px-4 py-3 text-sm transition-colors duration-200 flex items-center justify-between ${r<4?"border-b border-gray-100/50 dark:border-gray-600/50":""} ${n===t.toString()?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-300 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100"}`,children:[a.jsx("span",{children:t}),n===t.toString()&&a.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},t)})})})]})]}),(0,a.jsxs)("div",{className:"dropdown-container",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Mes"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>U("month"===I?null:"month"),className:"w-full px-3 py-2 border-0 bg-gray-50/80 dark:bg-gray-700/80 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:bg-white dark:focus:bg-gray-600 text-sm text-gray-700 dark:text-gray-200 transition-all duration-200 flex items-center justify-between",children:[a.jsx("span",{children:l?_(l):"Seleccionar mes"}),a.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${"month"===I?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),"month"===I&&a.jsx("div",{className:"absolute z-[999999] mt-2 left-0 w-full bg-white dark:bg-gray-700 backdrop-blur-sm border border-gray-200 dark:border-gray-600 rounded-xl shadow-lg max-h-56 overflow-auto",children:a.jsx("div",{className:"py-2",children:Array.from({length:12},(e,r)=>{let t=r+1,s=_(t.toString());return(0,a.jsxs)("button",{onClick:()=>{o(t.toString()),U(null)},className:`w-full text-left px-4 py-3 text-sm transition-colors duration-200 flex items-center justify-between ${r<11?"border-b border-gray-100/50 dark:border-gray-600/50":""} ${l===t.toString()?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-300 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100"}`,children:[a.jsx("span",{children:s}),l===t.toString()&&a.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},t)})})})]})]}),(0,a.jsxs)("div",{className:"dropdown-container",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Per\xedodo"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>U("period"===I?null:"period"),className:"w-full px-3 py-2 border-0 bg-gray-50/80 dark:bg-gray-700/80 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:bg-white dark:focus:bg-gray-600 text-sm text-gray-700 dark:text-gray-200 transition-all duration-200 flex items-center justify-between",children:[a.jsx("span",{children:x}),a.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${"period"===I?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),"period"===I&&a.jsx("div",{className:"absolute z-[999999] mt-2 left-0 w-full bg-white dark:bg-gray-700 backdrop-blur-sm border border-gray-200 dark:border-gray-600 rounded-xl shadow-lg max-h-56 overflow-auto",children:a.jsx("div",{className:"py-2",children:["P1","P2"].map((e,r)=>(0,a.jsxs)("button",{onClick:()=>{m(e),U(null)},className:`w-full text-left px-4 py-3 text-sm transition-colors duration-200 flex items-center justify-between ${r<1?"border-b border-gray-100/50 dark:border-gray-600/50":""} ${x===e?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-300 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100"}`,children:[a.jsx("span",{children:e}),x===e&&a.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e))})})]})]}),a.jsx("div",{className:"flex items-end",children:l&&n&&x&&(0,a.jsxs)("div",{className:"w-full p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-blue-800",children:[_(l)," ",n," - ",x]}),a.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"P1"===x?"D\xedas 1-15":"D\xedas 16-31"})]})})]})]})}),p&&a.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 dark:border-red-700/50 border border-red-200 dark:border-red-700/50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-red-800 dark:text-red-400",children:p})})]})}),a.jsx("div",{className:"mb-6 relative z-[99998] overflow-visible",children:a.jsx("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 pb-8 overflow-visible dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Consultar Disponibilidad:"})]}),a.jsx("div",{className:"flex-1 max-w-xs relative",children:(0,a.jsxs)("div",{className:"relative dropdown-container",children:[(0,a.jsxs)("button",{onClick:()=>U("sede"===I?null:"sede"),className:"w-full px-4 py-3 border-0 bg-gray-50/80 dark:bg-gray-700/80 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:bg-white dark:focus:bg-gray-600 text-sm text-gray-700 dark:text-gray-200 transition-all duration-200 cursor-pointer text-left flex items-center justify-between",children:[a.jsx("span",{className:D?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:D&&$.find(e=>e.id===D)?.name||"Selecciona una sede..."}),a.jsx("svg",{className:`w-4 h-4 text-gray-500 dark:text-gray-400 transition-transform duration-200 ${"sede"===I?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),"sede"===I&&a.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 dark:border-gray-700/20 z-[99999] max-h-60 overflow-y-auto",children:(0,a.jsxs)("div",{className:"py-2",children:[a.jsx("button",{onClick:()=>{S(""),U(null)},className:"w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-blue-50/80 dark:hover:bg-blue-900/20 transition-colors duration-200 flex items-center border-b border-gray-100/50 dark:border-gray-700/50",children:a.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Selecciona una sede..."})}),$.map((e,r)=>(0,a.jsxs)("button",{onClick:()=>{S(e.id),U(null)},className:`w-full px-4 py-3 text-left text-sm transition-colors duration-200 flex items-center ${r<$.length-1?"border-b border-gray-100/50 dark:border-gray-700/50":""} ${D===e.id?"bg-blue-50/80 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100 font-medium":"text-gray-700 dark:text-gray-200 hover:bg-gray-50/80 dark:hover:bg-gray-700/50"}`,children:[a.jsx("span",{children:e.name}),D===e.id&&a.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 dark:text-blue-400 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.id))]})})]})}),D&&a.jsx("button",{onClick:()=>S(""),className:"p-2 hover:bg-gray-100/80 rounded-lg transition-colors duration-200",title:"Cerrar consulta",children:a.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),D&&a.jsx("div",{className:"mb-10 relative z-0",children:(0,a.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200/50 dark:border-gray-600/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-md flex items-center justify-center",children:a.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Resumen de Disponibilidad"})]}),a.jsx("button",{onClick:()=>S(""),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors duration-200",title:"Cerrar consulta",children:a.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"space-y-4",children:C?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando disponibilidad..."})]}):L?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-4 border border-blue-200/50 dark:border-blue-700/50",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:L.sede_nombre}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 dark:text-blue-400",children:[L.rooms_disponibles,"/",L.rooms_totales]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rooms Disponibles"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:L.total_espacios}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Espacios"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:Object.values(L.jornadas_dobladas).reduce((e,r)=>e+r,0)}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Doblajes Activos"})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{key:"manana",label:"Ma\xf1ana",color:"from-orange-500 to-amber-600"},{key:"tarde",label:"Tarde",color:"from-blue-500 to-indigo-600"},{key:"noche",label:"Noche",color:"from-purple-500 to-violet-600"}].map(e=>(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-gray-600/80 backdrop-blur-sm rounded-lg p-4 border border-gray-200/50 dark:border-gray-500/50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:`w-3 h-3 bg-gradient-to-r ${e.color} rounded-full`}),a.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.label})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Disponibles:"}),a.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:L.jornadas_disponibles[e.key]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Dobladas:"}),a.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400 dark:text-blue-400",children:L.jornadas_dobladas[e.key]})]})]})]},e.key))}),a.jsx("div",{className:"bg-gray-50/80 dark:bg-gray-600/80 rounded-lg p-4 border border-gray-200/50 dark:border-gray-500/50",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center mt-0.5",children:a.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 8 8",children:a.jsx("circle",{cx:"4",cy:"4",r:"3"})})}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[a.jsx("p",{className:"font-medium mb-1",children:"Informaci\xf3n para nuevas modelos:"}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Disponibles:"})," Espacios libres para asignar nuevas modelos"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Dobladas:"})," Modelos que trabajan en m\xfaltiples jornadas"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Total Espacios:"})," Capacidad m\xe1xima (rooms \xd7 3 jornadas)"]})]})]})})]}):a.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a.jsx("p",{children:"No se pudo cargar la disponibilidad de esta sede"})})})})]})})]})})}},92509:(e,r,t)=>{"use strict";t.d(r,{t:()=>s});var a=t(3729);function s(e,r,t={}){let{refreshInterval:s=3e4,enabled:d=!0,onRefresh:l,silentUpdate:i=!0}=t,o=(0,a.useRef)(null),n=(0,a.useRef)(!0),[c,x]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),u=(0,a.useCallback)(()=>{l&&l(),e()},[e,l]),h=(0,a.useCallback)(async()=>{if(n.current){g(!0);try{l&&l(),await e(!0)}catch(e){console.error("\uD83D\uDD04 [BILLING-POLLING] Error en actualizaci\xf3n silenciosa:",e)}finally{n.current&&g(!1)}}},[e,l]);return(0,a.useEffect)(()=>(n.current=!0,()=>{n.current=!1}),[]),(0,a.useEffect)(()=>(o.current&&clearInterval(o.current),d&&n.current?(x(!0),o.current=setInterval(()=>{n.current&&(console.log("\uD83D\uDD04 [BILLING-POLLING] Actualizaci\xf3n silenciosa iniciada"),i?h():(l&&l(),e()))},s)):x(!1),()=>{o.current&&clearInterval(o.current)}),[s,d,e,l,i,h,...r]),(0,a.useEffect)(()=>()=>{o.current&&clearInterval(o.current)},[]),{isPolling:c,isSilentUpdating:m,manualRefresh:u}}},15807:(e,r,t)=>{"use strict";t.d(r,{dB:()=>a,iR:()=>s});let a=()=>(console.warn("⚠️ getCalculatorDate() is deprecated. Use getColombiaDate() instead."),s()),s=()=>new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"})},73186:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>d,__esModule:()=>s,default:()=>l});let a=(0,t(86843).createProxy)(String.raw`C:\Users\camca\OneDrive\Documentos\GitHub\iam-sistema-de-gestion\app\admin\sedes\dashboard\page.tsx`),{__esModule:s,$$typeof:d}=a,l=a.default}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1638,6611,6654,551,9609,1110],()=>t(19918));module.exports=a})();