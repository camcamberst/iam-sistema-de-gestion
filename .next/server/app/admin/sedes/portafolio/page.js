(()=>{var e={};e.id=6249,e.ids=[6249],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},53426:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>g,tree:()=>n});var t=r(50482),s=r(69108),l=r(62563),o=r.n(l),d=r(68300),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);r.d(a,i);let n=["",{children:["admin",{children:["sedes",{children:["portafolio",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,24512)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\sedes\\portafolio\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,66294)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,41878)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\sedes\\portafolio\\page.tsx"],m="/admin/sedes/portafolio/page",u={require:r,loadChunk:()=>Promise.resolve()},g=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/sedes/portafolio/page",pathname:"/admin/sedes/portafolio",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},50008:(e,a,r)=>{Promise.resolve().then(r.bind(r,54628))},54628:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>E});var t=r(95344),s=r(3729),l=r(22254),o=r(53148),d=r(25545),i=r(95269),n=r(66262),c=r(97075);let m=(0,c.Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var u=r(67970);let g=(0,c.Z)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),x=(0,c.Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var p=r(18822),h=r(91700);let b=(0,c.Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var f=r(47958),y=r(46985),v=r(43995),j=r(33265),k=r(25390);let w=(0,c.Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),N=(0,c.Z)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var _=r(13746);let C=(0,c.Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var S=r(2768);function D({isOpen:e,onClose:a,modelId:r,modelName:l,modelEmail:o,userId:d}){let[c,m]=(0,s.useState)({folderUrl:null,folderId:null}),[u,g]=(0,s.useState)(!0),[x,p]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),[y,j]=(0,s.useState)(""),[D,E]=(0,s.useState)(""),[A,P]=(0,s.useState)(""),[Z,$]=(0,s.useState)([]),[O,G]=(0,s.useState)(!1),[q,M]=(0,s.useState)(null),[I,L]=(0,s.useState)(null),[T,U]=(0,s.useState)({}),[z,B]=(0,s.useState)(!1),R=e=>{try{let a=e.match(/\/folders\/([a-zA-Z0-9_-]+)/);return a?a[1]:null}catch{return null}};(0,s.useEffect)(()=>{e&&r&&F()},[e,r]);let F=async()=>{try{g(!0),E("");let e=await fetch(`/api/models/google-drive-config?modelId=${r}`),a=await e.json();a.success?(m({folderUrl:a.folderUrl||null,folderId:a.folderId||null}),j(a.folderUrl||"")):E(a.error||"Error al cargar configuraci\xf3n")}catch(e){E("Error al cargar configuraci\xf3n"),console.error("Error loading Google Drive config:",e)}finally{g(!1)}},X=async()=>{if(!y.trim()){E("Por favor ingresa una URL v\xe1lida de Google Drive");return}let e=R(y);if(!e){E("URL inv\xe1lida. Debe ser un enlace de carpeta de Google Drive (formato: https://drive.google.com/drive/folders/...)");return}try{p(!0),E(""),P("");let a=await fetch("/api/models/google-drive-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:r,folderUrl:y.trim(),folderId:e})}),t=await a.json();t.success?(m({folderUrl:y.trim(),folderId:e}),f(!1),P("Configuraci\xf3n guardada correctamente"),setTimeout(()=>P(""),3e3)):E(t.error||"Error al guardar configuraci\xf3n")}catch(e){E("Error al guardar configuraci\xf3n"),console.error("Error saving Google Drive config:",e)}finally{p(!1)}},H=(0,s.useCallback)(async()=>{if(c.folderId&&d)try{G(!0),E("");let e=await fetch(`/api/google-drive/folders?folderId=${c.folderId}&userId=${d}`),a=await e.json();if(a.success)$(a.folders||[]);else if(a.requiresAuth){let e=await fetch(`/api/google-drive/auth?userId=${d}`),a=await e.json();a.success&&a.authUrl&&(window.location.href=a.authUrl)}else a.requiresSetup?E("Google OAuth no est\xe1 configurado. Por favor, contacta al administrador."):E(a.error||"Error al cargar carpetas")}catch(e){E("Error al cargar carpetas"),console.error("Error loading folders:",e)}finally{G(!1)}},[c.folderId,d]);(0,s.useEffect)(()=>{c.folderId&&!h&&e&&((async()=>{try{let e=await fetch(`/api/google-drive/verify-scope?userId=${d}`),a=await e.json();a.success&&a.needsReauth&&E("Necesitas reautenticarte con permisos completos de Google Drive. Intenta subir un archivo para iniciar la autenticaci\xf3n.")}catch(e){console.error("Error verificando scope:",e)}})(),H())},[c.folderId,h,e,H,d]);let W=(0,s.useCallback)((e,a)=>{e.preventDefault(),e.stopPropagation(),M(a)},[]),J=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let a=e.currentTarget.getBoundingClientRect(),r=e.clientX,t=e.clientY;(r<a.left||r>a.right||t<a.top||t>a.bottom)&&M(null)},[]),V=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),Y=(0,s.useCallback)(async(e,a)=>{e.preventDefault(),e.stopPropagation(),M(null);let t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/"));if(0===t.length){E("Por favor arrastra solo archivos de imagen");return}try{L(a),E("");let e="broadcast"===a?Z:[{id:a,name:""}];for(let s of(console.log("\uD83D\uDE80 [BOOST-PAGES] Iniciando carga...",{mode:"broadcast"===a?"BROADCAST":"SINGLE",targetFoldersCount:e.length,filesCount:t.length}),t))for(let t of e){let e;let l=t.id,o=`${l}-${s.name}`;U(e=>({...e,[o]:"uploading"}));let i=new FormData;i.append("file",s),i.append("folderId",l),i.append("modelId",r),i.append("userId",d),console.log(`ðŸ“¤ [BOOST-PAGES] Subiendo archivo a folder ${l}:`,s.name);let n=await fetch("/api/google-drive/upload",{method:"POST",body:i});try{let a=await n.text();if(!a)throw Error("Respuesta vac\xeda del servidor");e=JSON.parse(a)}catch(e){throw console.error("âŒ [BOOST-PAGES] Error procesando respuesta:",e),Error(`Error al procesar respuesta del servidor: ${e.message||n.status}`)}if(!n.ok&&!e)throw Error(`Error HTTP ${n.status}: ${n.statusText}`);if(e.success)console.log(`âœ… [BOOST-PAGES] Archivo subido a ${l} exitosamente`),U(e=>({...e,[o]:"success"})),"broadcast"!==a&&(P(`Archivo ${s.name} subido correctamente`),setTimeout(()=>{P(""),U(e=>{let a={...e};return delete a[o],a})},3e3));else if(console.error(`âŒ [BOOST-PAGES] Error al subir a ${l}:`,e),U(e=>({...e,[o]:"error"})),e.requiresAuth){let e=await fetch(`/api/google-drive/auth?userId=${d}`),a=await e.json();if(a.success&&a.authUrl){window.location.href=a.authUrl;return}E("Error al iniciar autenticaci\xf3n con Google Drive")}else"broadcast"!==a&&E(e.error||`Error al subir ${s.name}`)}"broadcast"===a&&(P(`\xa1Carga masiva completada! Archivos distribuidos en ${e.length} carpetas.`),setTimeout(()=>{P(""),U({})},4e3))}catch(e){console.error("âŒ [BOOST-PAGES] Error general al subir archivos:",e),E(e.message||"Error desconocido al subir archivos")}finally{L(null)}},[r,d,Z]);return t.jsx(v.Z,{isOpen:e,onClose:a,title:"Boost Pages",maxWidthClass:"max-w-4xl",paddingClass:"p-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:l}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o})]}),t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:t.jsx(b,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",onClick:()=>B(!z),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[z?t.jsx(k.Z,{className:"w-4 h-4 text-gray-500"}):t.jsx(w,{className:"w-4 h-4 text-gray-500"}),t.jsx(N,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),t.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Configuraci\xf3n de Google Drive"})]}),!h&&c.folderUrl&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[t.jsx(n.Z,{className:"w-3 h-3"}),t.jsx("span",{children:"Conectado"})]}),t.jsx("button",{onClick:e=>{e.stopPropagation(),f(!0),B(!0)},className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 p-1",children:t.jsx(_.Z,{className:"w-4 h-4"})})]})]}),(z||h||!c.folderUrl)&&t.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:u?(0,t.jsxs)("div",{className:"text-center py-4",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Cargando configuraci\xf3n..."})]}):h?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL de la carpeta de Google Drive"}),t.jsx("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"https://drive.google.com/drive/folders/...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ingresa el enlace completo de la carpeta de Google Drive donde se encuentran las carpetas de cada plataforma"})]}),D&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded",children:[t.jsx(i.Z,{className:"w-4 h-4"}),D]}),A&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 p-2 rounded",children:[t.jsx(n.Z,{className:"w-4 h-4"}),A]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:X,disabled:x,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:x?"Guardando...":"Guardar"}),t.jsx("button",{onClick:()=>{j(c.folderUrl||""),f(!1),E("")},disabled:x,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",children:"Cancelar"})]})]}):c.folderUrl?t.jsx("div",{className:"space-y-2",children:t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded p-2",children:t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 break-all",children:c.folderUrl})})}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"text-center py-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[t.jsx(i.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No hay configuraci\xf3n de Google Drive para esta modelo"})]}),t.jsx("button",{onClick:()=>f(!0),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Configurar Google Drive"})]})})]}),c.folderId&&!h&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 flex items-center justify-between border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-gray-100 text-sm flex items-center gap-2",children:[t.jsx(N,{className:"w-4 h-4"}),"Carpetas disponibles"]}),t.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:"Arrastra archivos directamente sobre las carpetas"})]}),Z.length>0&&!O&&t.jsx("div",{className:`
                    mx-4 mt-4 mb-2 border-2 border-dashed rounded-xl p-6 transition-all duration-200 cursor-pointer text-center
                    bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20
                    ${"broadcast"===q?"border-indigo-500 scale-[1.02] shadow-lg ring-2 ring-indigo-400/30":"border-indigo-300 dark:border-indigo-700 hover:border-indigo-400 dark:hover:border-indigo-500"}
                  `,onDragEnter:e=>W(e,"broadcast"),onDragLeave:J,onDragOver:V,onDrop:e=>Y(e,"broadcast"),children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[t.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/50 rounded-full",children:t.jsx(b,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-sm font-bold text-indigo-900 dark:text-indigo-200",children:"\uD83D\uDE80 Carga Masiva / Difusi\xf3n"}),(0,t.jsxs)("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mt-1",children:["Arrastra tu foto aqu\xed para subirla a ",(0,t.jsxs)("strong",{children:["TODAS las ",Z.length," carpetas"]})," al mismo tiempo"]})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-900 p-4",style:{maxHeight:"400px",overflowY:"auto"},children:O?(0,t.jsxs)("div",{className:"flex items-center justify-center py-8",children:[t.jsx(C,{className:"w-6 h-6 animate-spin text-blue-600"}),t.jsx("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:"Cargando carpetas..."})]}):Z.length>0?t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Z.map(e=>{let a=q===e.id,r=I===e.id,s=Object.keys(T).some(a=>a.startsWith(`${e.id}-`)&&"uploading"===T[a]),l=Object.keys(T).some(a=>a.startsWith(`${e.id}-`)&&"success"===T[a]);return t.jsx("div",{onDragEnter:a=>W(a,e.id),onDragLeave:J,onDragOver:V,onDrop:a=>Y(a,e.id),className:`
                            relative border-2 rounded-lg p-4 transition-all duration-200 cursor-pointer
                            ${a?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 scale-105 shadow-lg":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 hover:border-blue-300 dark:hover:border-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700"}
                            ${r||s?"opacity-75":""}
                          `,children:(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[s?t.jsx(C,{className:"w-8 h-8 animate-spin text-blue-500 mb-2"}):l?t.jsx(n.Z,{className:"w-8 h-8 text-green-500 mb-2"}):t.jsx(N,{className:`w-8 h-8 mb-2 ${a?"text-blue-500":"text-gray-400"}`}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate w-full",children:e.name}),a&&t.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1 font-medium",children:"Suelta aqu\xed"}),s&&t.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Subiendo..."}),l&&!s&&t.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"âœ“ Subido"})]})},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-8",children:[t.jsx(i.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No se encontraron carpetas. Aseg\xfarate de que el Google Drive tenga carpetas configuradas."})]})})]}),(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 px-4 py-3 border border-blue-200 dark:border-blue-800 rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-2",children:"\uD83D\uDCCB Instrucciones:"}),(0,t.jsxs)("ul",{className:"text-xs text-blue-800 dark:text-blue-400 space-y-1 list-disc list-inside",children:[(0,t.jsxs)("li",{children:[t.jsx("strong",{children:"Carga Masiva:"})," Arrastra fotos a la zona superior para subirlas a TODAS las carpetas."]}),(0,t.jsxs)("li",{children:[t.jsx("strong",{children:"Carga Individual:"})," Arrastra fotos sobre una carpeta espec\xedfica."]}),(0,t.jsxs)("li",{children:[t.jsx("strong",{children:"Google Drive:"})," Abre el enlace para gestionar archivos manualmente."]})]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2 text-center",children:"O si prefieres, puedes abrir el Google Drive en una nueva pesta\xf1a:"}),(0,t.jsxs)("a",{href:c.folderUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"block w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-sm text-center flex items-center justify-center gap-2",children:[t.jsx(S.Z,{className:"w-4 h-4"}),t.jsx("span",{children:"Abrir Google Drive en nueva pesta\xf1a"})]})]})]}),!c.folderId&&!h&&t.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[t.jsx(i.Z,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-300",children:"Configuraci\xf3n requerida"}),t.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400 mt-1",children:"Para usar Boost Pages, primero debes configurar el enlace de Google Drive de esta modelo."})]})]})})]})})}function E(){let e=(0,l.useRouter)(),a=(0,l.useSearchParams)(),c=(a,r)=>{e.push(`/admin/calculator/view-model?modelId=${a}`)},[k,w]=(0,s.useState)(!0),[N,_]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),[E,A]=(0,s.useState)([]),[P,Z]=(0,s.useState)([]),[$,O]=(0,s.useState)([]),[G,q]=(0,s.useState)([]),[M,I]=(0,s.useState)([]),[L,T]=(0,s.useState)([]),[U,z]=(0,s.useState)(""),[B,R]=(0,s.useState)(""),[F,X]=(0,s.useState)(""),[H,W]=(0,s.useState)(""),[J,V]=(0,s.useState)("grid"),[Y,K]=(0,s.useState)(!0),[Q,ee]=(0,s.useState)(null),[ea,er]=(0,s.useState)(!1),[et,es]=(0,s.useState)("request"),[el,eo]=(0,s.useState)(""),[ed,ei]=(0,s.useState)(!1),[en,ec]=(0,s.useState)("disponible"),[em,eu]=(0,s.useState)(""),[eg,ex]=(0,s.useState)(""),[ep,eh]=(0,s.useState)(""),[eb,ef]=(0,s.useState)(!1),[ey,ev]=(0,s.useState)(!1),[ej,ek]=(0,s.useState)(!1),[ew,eN]=(0,s.useState)(new Set),[e_,eC]=(0,s.useState)(""),[eS,eD]=(0,s.useState)(""),[eE,eA]=(0,s.useState)(!1),[eP,eZ]=(0,s.useState)(!1),[e$,eO]=(0,s.useState)(!1),[eG,eq]=(0,s.useState)(!1),[eM,eI]=(0,s.useState)(null),[eL,eT]=(0,s.useState)(""),[eU,ez]=(0,s.useState)([]),[eB,eR]=(0,s.useState)("");(0,s.useEffect)(()=>{(()=>{let e=localStorage.getItem("user");if(e){let a=JSON.parse(e);eT(a.role||""),ez(a.groups?.map(e=>e.id)||[]),eR(a.id||"")}})()},[]),(0,s.useEffect)(()=>{eL&&eU.length>=0&&eF()},[eL,eU]),(0,s.useEffect)(()=>{let e=()=>{(async()=>{try{let e=await fetch("/api/plataformas-catalogo");if(e.ok){let a=await e.json();I(Array.isArray(a)?a:[])}}catch(e){console.error("Error recargando plataformas:",e)}})()};return window.addEventListener("focus",e),(()=>{let a=sessionStorage.getItem("platforms_updated");if(a){let r=parseInt(a,10);Date.now()-r<3e5&&(e(),sessionStorage.removeItem("platforms_updated"))}})(),()=>{window.removeEventListener("focus",e)}},[]),(0,s.useEffect)(()=>{let r=a.get("model"),t=a.get("email");if(r&&t&&!k){console.log("\uD83D\uDD0D Aplicando filtro autom\xe1tico por modelo:",{modelId:r,modelEmail:t}),eJ(r);let a=new URL(window.location.href);a.searchParams.delete("model"),a.searchParams.delete("email"),e.replace(a.pathname+a.search,{scroll:!1})}},[a,e,k]),(0,s.useEffect)(()=>{k||(B||U||F||H?eX():A([]))},[U,B,F,H]);let eF=async()=>{try{w(!0);let{supabase:e}=await Promise.resolve().then(r.bind(r,72829)),{data:{session:a}}=await e.auth.getSession(),t=a?.access_token;if(!t){console.error("âŒ [PORTAFOLIO] No hay token de autenticaci\xf3n"),_("No hay sesi\xf3n activa"),w(!1);return}let s=await fetch("/api/groups",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({userRole:eL,userGroups:eU})});if(s.ok){let e=await s.json();e.success&&O(e.groups)}let l=await fetch("/api/plataformas-catalogo");if(l.ok){let e=await l.json();I(Array.isArray(e)?e:[])}let o=await fetch("/api/users?role=modelo");if(o.ok){let e=await o.json(),a=(Array.isArray(e)?e:Array.isArray(e?.users)?e.users:[]).filter(e=>"modelo"===e.role);T(a.map(e=>e.id))}}catch(e){console.error("Error loading initial data:",e),_("Error al cargar los datos iniciales")}finally{w(!1)}},eX=async()=>{try{B&&await eH(B);let e=new URLSearchParams;U&&e.append("model_id",U),B&&e.append("group_id",B),F&&e.append("jornada",F),H&&e.append("platform_id",H);let a=await fetch(`/api/modelo-plataformas?${e.toString()}`);if(a.ok){let e=await a.json(),r=Array.isArray(e)?e.filter(e=>e.model_name&&!e.model_name.includes("Administrator")&&!e.model_name.includes("Super Administrator")):[];A(r),("admin"===eL||"super_admin"===eL)&&r.length>0&&await e4(r)}else _("Error al cargar las plataformas")}catch(e){console.error("Error loading platforms:",e),_("Error al cargar las plataformas")}},eH=async e=>{try{let a=await fetch(`/api/groups/${e}/models`);if(a.ok){let e=await a.json(),r=Array.isArray(e)?e:Array.isArray(e?.models)?e.models:[];Z(r)}}catch(e){console.error("Error loading models:",e)}},eW=e=>{R(e),z(""),Z([]),e&&eH(e)},eJ=async e=>{console.log("\uD83D\uDD0D Aplicando filtro por modelo:",e);let a=await fetch(`/api/modelo-plataformas?model_id=${e}`);if(a.ok){let e=await a.json(),r=Array.isArray(e)?e:Array.isArray(e?.platforms)?e.platforms:[];if(r.length>0){let e=r[0].group_id;e&&(console.log("\uD83D\uDD0D Encontrado grupo para modelo:",e),R(e),await eH(e))}}z(e)},eV=e=>{switch(e){case"disponible":return"bg-slate-200 text-slate-700 border border-slate-300 hover:bg-slate-300";case"solicitada":return"bg-blue-300 text-blue-800 border border-blue-400 hover:bg-blue-400";case"pendiente":return"bg-yellow-300 text-yellow-800 border border-yellow-400 hover:bg-yellow-400";case"entregada":return"bg-green-300 text-green-800 border border-green-400 hover:bg-green-400";case"desactivada":return"bg-gray-800 text-white border border-gray-800 hover:opacity-90";case"inviable":return"bg-red-300 text-red-800 border border-red-400 hover:bg-red-400";default:return"bg-gray-50 text-gray-600 border border-gray-200"}},eY=(e,a)=>{switch(a&&"desactivada"!==e?"confirmada":e){case"disponible":return t.jsx(o.Z,{className:"w-4 h-4"});case"solicitada":return t.jsx(d.Z,{className:"w-4 h-4"});case"pendiente":return t.jsx(i.Z,{className:"w-4 h-4"});case"entregada":case"confirmada":default:return t.jsx(n.Z,{className:"w-4 h-4"});case"desactivada":return t.jsx(m,{className:"w-4 h-4"});case"inviable":return t.jsx(u.Z,{className:"w-4 h-4"})}},eK=(e,a)=>{switch(a&&"desactivada"!==e?"confirmada":e){case"disponible":return"Disponible";case"solicitada":return"Solicitada";case"pendiente":return"Pendiente";case"entregada":return"Entregada";case"desactivada":return"Desactivada";case"inviable":return"Inviable";default:return"Confirmada"}},eQ=async(e,a)=>{console.log("\uD83D\uDFE2 handlePlatformAction llamado",{platform:e.platform_name,action:a}),ee(e),es(a),eo("");let r=e.is_initial_config&&"desactivada"!==e.status?"entregada":e.status;ec(r||"disponible"),er(!0),console.log("\uD83D\uDFE2 showActionModal establecido a true"),"entregada"===r&&("admin"===eL||"super_admin"===eL)?(await e2(e.model_id,e.platform_id),e.platform_id?.toLowerCase()==="superfoon"||e.platform_name?.toLowerCase().includes("superfoon")?await e1(e.model_id,e.platform_id):(eC(""),eD(""),eO(!1))):(eu(""),ex(""),eh(""),ek(!1),eC(""),eD(""),eO(!1))},e0=async()=>{try{let{supabase:e}=await Promise.resolve().then(r.bind(r,72829)),{data:{session:a},error:t}=await e.auth.getSession();if(t||!a)return null;let s=a.expires_at;if(s){let a=Math.floor(Date.now()/1e3);if(s-a<60){let{data:{session:a},error:r}=await e.auth.refreshSession();if(r||!a)return null;return a.access_token}}return a.access_token}catch(e){return console.error("Error obteniendo token:",e),null}},e2=async(e,a)=>{if(eB)try{ev(!0);let r=await e0();if(!r){eu(""),ex(""),eh(""),ek(!1);return}let t=await fetch("/api/calculator/platforms");if(t.ok){let e=await t.json();if(e.success&&e.config?.platforms){let r=e.config.platforms.find(e=>e.id===a);r?.login_url?eu(r.login_url):eu("")}}let s=await fetch(`/api/modelo-plataformas/credentials?model_id=${e}&platform_id=${a}`,{headers:{Authorization:`Bearer ${r}`}});if(s.ok){let e=await s.json();e.success&&e.hasCredentials&&e.data?(ex(e.data.login_username||""),eh(e.data.login_password||""),ek(!0)):(ex(""),eh(""),ek(!1))}else ex(""),eh(""),ek(!1)}catch(e){console.error("Error cargando credenciales:",e),eu(""),ex(""),eh(""),ek(!1)}finally{ev(!1)}},e1=async(e,a)=>{if(eB)try{eZ(!0);let r=await e0();if(!r){eC(""),eD(""),eO(!1);return}let t=await fetch(`/api/modelo-plataformas/credentials-3cx?model_id=${e}&platform_id=${a}`,{headers:{Authorization:`Bearer ${r}`}});if(t.ok){let e=await t.json();e.success&&e.data&&e.data.hasCredentials?(eC(e.data.app_3cx_username||""),eD(e.data.app_3cx_password||""),eO(!0)):(eC(""),eD(""),eO(!1))}else eC(""),eD(""),eO(!1)}catch(e){console.error("Error cargando credenciales 3CX:",e),eC(""),eD(""),eO(!1)}finally{eZ(!1)}},e4=async e=>{if(eB&&("admin"===eL||"super_admin"===eL))try{let a=await e0();if(!a)return;let r=new Set,t=e.filter(e=>"entregada"===e.status);for(let e=0;e<t.length;e+=10){let s=t.slice(e,e+10).map(async e=>{try{let r=await fetch(`/api/modelo-plataformas/credentials?model_id=${e.model_id}&platform_id=${e.platform_id}`,{headers:{Authorization:`Bearer ${a}`}});if(r.ok){let a=await r.json();if(a.success&&a.hasCredentials)return`${e.model_id}-${e.platform_id}`}}catch(a){console.error(`Error verificando credenciales para ${e.platform_id}:`,a)}return null});(await Promise.all(s)).forEach(e=>{e&&r.add(e)})}eN(r)}catch(e){console.error("Error cargando informaci\xf3n de credenciales:",e)}},e5=async()=>{if(Q&&eB){if(!eg.trim()||!ep.trim()){_("Usuario y contrase\xf1a son requeridos");return}if(!em.trim()){_('La plataforma no tiene URL de login configurado. Config\xfaralo en "Gesti\xf3n de Plataformas"');return}try{ei(!0),_("");let e=await e0();if(!e){_("Error de autenticaci\xf3n");return}let a=await fetch("/api/modelo-plataformas/credentials",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({platform_id:Q.platform_id,model_id:Q.model_id,login_username:eg.trim(),login_password:ep})});if(a.ok){let e=await a.json();e.success?(S("Credenciales guardadas correctamente"),ek(!0),eN(e=>{let a=new Set(e);return a.add(`${Q.model_id}-${Q.platform_id}`),a})):_(e.error||"Error al guardar credenciales")}else{let e=await a.json();_(e.error||"Error al guardar credenciales")}}catch(e){console.error("Error guardando credenciales:",e),_("Error al guardar credenciales")}finally{ei(!1)}}},e3=async()=>{if(Q&&eB){if(!e_.trim()||!eS.trim()){_("Por favor completa usuario y contrase\xf1a de 3CX");return}try{ei(!0),_("");let e=await e0();if(!e){_("Error de autenticaci\xf3n");return}let a=await fetch("/api/modelo-plataformas/credentials-3cx",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model_id:Q.model_id,platform_id:Q.platform_id,app_3cx_username:e_.trim(),app_3cx_password:eS})});if(a.ok){let e=await a.json();e.success?(S("Credenciales de 3CX guardadas correctamente"),eO(!0)):_(e.error||"Error al guardar credenciales de 3CX")}else{let e=await a.json();_(e.error||"Error al guardar credenciales de 3CX")}}catch(e){console.error("Error guardando credenciales 3CX:",e),_("Error al guardar credenciales de 3CX")}finally{ei(!1)}}},e6=async()=>{if(Q&&eB)try{ei(!0),_("");let e=await fetch("/api/modelo-plataformas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_id:Q.model_id,platform_id:Q.platform_id,new_status:en,changed_by:eB,reason:el||null})});if(e.ok)S(`Plataforma ${eK(en).toLowerCase()} correctamente`),er(!1),await eX();else{let a=await e.json();_(a.error||"Error al procesar la acci\xf3n")}}catch(e){console.error("Error executing action:",e),_("Error al procesar la acci\xf3n")}finally{ei(!1)}},e8=Object.values(E.filter(e=>0===L.length||L.includes(e.model_id)).reduce((e,a)=>{let r=a.model_id;return e[r]||(e[r]={model_id:a.model_id,model_name:a.model_name,model_email:a.model_email,group_name:a.group_name,group_id:a.group_id,platforms:[]}),e[r].platforms.push(a),e},{}));return k?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:t.jsx("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Cargando portafolio..."})]})})}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:["admin"===eL&&0===$.length&&t.jsx("div",{className:"mb-8",children:t.jsx("div",{className:"bg-gradient-to-r from-yellow-50/80 to-orange-50/80 dark:bg-yellow-900/20 dark:border-yellow-700/50 backdrop-blur-sm rounded-xl p-6 border border-yellow-200/30 dark:border-yellow-700/50",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-300",children:"Sin Sedes Asignadas"}),t.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:"No tienes sedes asignadas para ver portafolios. Contacta al Super Admin para que te asigne sedes."})]})]})})}),t.jsx("div",{className:"mb-8 sm:mb-12",children:t.jsx("div",{className:"bg-white/80 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20",children:t.jsx("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-3",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:t.jsx(g,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[t.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-bold text-gray-900 dark:text-gray-100 leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:"Portafolio Modelos"}),t.jsx("p",{className:"mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300 hidden sm:block",children:"Gesti\xf3n de plataformas por modelo y sede"})]})]})})})}),N&&t.jsx("div",{className:"mb-6 bg-red-50/80 dark:bg-red-900/20 dark:border-red-700/50 backdrop-blur-sm border border-red-200/50 dark:border-red-700/50 text-red-700 dark:text-red-400 px-4 py-3 rounded-lg shadow-sm",children:N}),C&&t.jsx("div",{className:"mb-6 bg-green-50/80 dark:bg-green-900/20 dark:border-green-700/50 backdrop-blur-sm border border-green-200/50 dark:border-green-700/50 text-green-700 dark:text-green-400 px-4 py-3 rounded-lg shadow-sm",children:C}),t.jsx("div",{className:"mb-4 sm:mb-8 z-40 relative",children:(0,t.jsxs)("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-3 sm:p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,t.jsxs)("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center",children:[t.jsx(x,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1.5 sm:mr-2"}),"Filtros"]}),t.jsx("button",{onClick:()=>K(!Y),className:"text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors active:scale-95 touch-manipulation",children:Y?"Ocultar":"Mostrar"})]}),Y&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4",children:[t.jsx(y.Z,{label:"Grupo",value:B,options:[{label:"Todos los grupos",value:""},...$.map(e=>({label:e.name,value:e.id}))],onChange:e=>eW(e),className:"text-xs sm:text-sm"}),t.jsx(y.Z,{label:"Modelo",value:U,options:[{label:"Todas las modelos",value:""},...P.map(e=>({label:(0,j.W)(e.email),value:e.id}))],onChange:e=>z(e),className:"text-xs sm:text-sm"}),t.jsx(y.Z,{label:"Jornada",value:F,options:[{label:"Todas las jornadas",value:""},...["MA\xd1ANA","TARDE","NOCHE"].map(e=>({label:e,value:e}))],onChange:e=>X(e),className:"text-xs sm:text-sm"}),t.jsx(y.Z,{label:"Plataforma",value:H,options:[{label:"Todas las plataformas",value:""},...M.map(e=>({label:e.name,value:e.id}))],onChange:e=>W(e),className:"text-xs sm:text-sm"})]})]})}),(0,t.jsxs)("div",{className:"bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-3 sm:p-6 transition-all dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[t.jsx("div",{className:"flex items-center justify-between mb-3 sm:mb-6",children:(0,t.jsxs)("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900 dark:text-gray-100",children:["Modelos (",e8.length,")"]})}),0===e8.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx(p.Z,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aplica un filtro de Grupo, Modelo, Room, Jornada o Plataforma para ver resultados."})]}):t.jsx("div",{className:"space-y-3 sm:space-y-6",children:e8.map(e=>(0,t.jsxs)("div",{className:"bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl border border-white/30 dark:border-gray-600/30 shadow-lg p-3 sm:p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0 mb-3 sm:mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[t.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-md flex-shrink-0",children:t.jsx(p.Z,{className:"w-4 h-4 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[t.jsx("h4",{className:"text-sm sm:text-lg font-semibold text-gray-900 dark:text-gray-100 cursor-pointer hover:text-blue-700 dark:hover:text-blue-400 transition-colors truncate",onClick:()=>c(e.model_id,e.model_email),title:"Ver calculadora de la modelo",children:(0,j.W)(e.model_email)}),(0,t.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 flex items-center",children:[t.jsx(h.Z,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0"}),t.jsx("span",{className:"truncate",children:e.group_name})]})]})]}),(0,t.jsxs)("button",{onClick:()=>{eI({id:e.model_id,name:(0,j.W)(e.model_email),email:e.model_email}),eq(!0)},className:"w-full sm:w-auto px-3 sm:px-4 py-1.5 sm:py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 flex items-center justify-center gap-2 text-xs sm:text-sm font-medium active:scale-95 touch-manipulation",title:"Abrir Boost Pages para subir fotos a las plataformas",children:[t.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Boost Pages"]})]}),t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:(M||[]).map(a=>{let r=e.platforms.find(e=>e.platform_id===a.id)||{id:null,model_id:e.model_id,model_name:e.model_name,model_email:e.model_email,platform_id:a.id,platform_name:a.name,platform_code:a.id,status:"disponible",requested_at:null,delivered_at:null,confirmed_at:null,deactivated_at:null,reverted_at:null,requested_by_name:null,delivered_by_name:null,confirmed_by_name:null,deactivated_by_name:null,reverted_by_name:null,notes:null,revert_reason:null,is_initial_config:!1,calculator_sync:!1,calculator_activated_at:null,group_name:e.group_name,group_id:e.group_id,created_at:null,updated_at:null},s=ew.has(`${r.model_id}-${r.platform_id}`),l=r.is_initial_config&&"desactivada"!==r.status?"entregada":r.status;return t.jsx("button",{type:"button",className:`px-2 sm:px-2.5 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-[11px] leading-4 sm:leading-5 font-medium transition-colors inline-flex items-center relative active:scale-95 touch-manipulation ${eV(l)}`,onClick:()=>eQ(r,"request"),children:(0,t.jsxs)("span",{className:"inline-flex items-center gap-0.5 sm:gap-1 align-middle",children:[eY(r.status,r.is_initial_config),r.platform_name,s&&"entregada"===l&&("admin"===eL||"super_admin"===eL)&&t.jsx("span",{className:"ml-0.5 sm:ml-1 w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full bg-blue-500 dark:bg-blue-400",title:"Credenciales guardadas","aria-label":"Credenciales guardadas"})]})},`${e.model_id}-${a.id}`)})}),t.jsx("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-200/50 dark:border-gray-600/50",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1.5 sm:gap-0 text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:[(0,t.jsxs)("span",{children:["Total: ",M.length," plataformas"]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-2 sm:gap-x-4 gap-y-1",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:(()=>{let a=e.platforms.filter(e=>{let a=e.is_initial_config&&"desactivada"!==e.status;return"entregada"===e.status||a}).length;return(0,t.jsxs)(t.Fragment,{children:["Entregadas: ",a]})})()}),(0,t.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:["Solicitadas: ",e.platforms.filter(e=>"solicitada"===e.status).length]}),(0,t.jsxs)("span",{className:"text-gray-500 dark:text-gray-500",children:["Disponibles: ",M.length-e.platforms.length]})]})]})})]},e.model_id))})]}),ea&&Q&&(0,t.jsxs)(t.Fragment,{children:[console.log("\uD83D\uDFE1 Renderizando StandardModal",{showActionModal:ea,hasPlatform:!!Q}),(0,t.jsxs)(v.Z,{isOpen:ea,onClose:()=>{console.log("\uD83D\uDD34 Cerrando modal"),er(!1)},title:"request"===et&&"Estado de Plataforma"||"deliver"===et&&"Entregar Plataforma"||"deactivate"===et&&"Desactivar Plataforma"||"revert"===et&&"Revertir Plataforma"||"Acci\xf3n",maxWidthClass:"request"===et?"max-w-4xl":"max-w-md",children:["request"===et?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Informaci\xf3n"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("strong",{children:"Plataforma:"})," ",Q.platform_name]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("strong",{children:"Modelo:"})," ",(0,j.W)(Q.model_email)]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("strong",{children:"Estado actual:"})," ",eK(Q.status)]})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Estado"}),t.jsx(y.Z,{value:en,onChange:e=>ec(e),options:[{label:"Disponible",value:"disponible",color:"#e2e8f0"},{label:"Solicitada",value:"solicitada",color:"#93c5fd"},{label:"Pendiente",value:"pendiente",color:"#fde047"},{label:"Entregada",value:"entregada",color:"#86efac"},{label:"Desactivada",value:"desactivada",color:"#1f2937"},{label:"Inviable",value:"inviable",color:"#fca5a5"}],className:"text-sm"})]})]}),t.jsx("div",{className:"space-y-4",children:(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Detalles"}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Notas (opcional)"}),t.jsx("textarea",{value:el,onChange:e=>eo(e.target.value),rows:8,className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Agregar notas sobre esta acci\xf3n..."})]})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[t.jsx("strong",{children:"Plataforma:"})," ",Q.platform_name]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[t.jsx("strong",{children:"Modelo:"})," ",(0,j.W)(Q.model_email)]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("strong",{children:"Estado actual:"})," ",eK(Q.status)]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Estado"}),t.jsx(y.Z,{value:en,onChange:e=>ec(e),options:[{label:"Disponible",value:"disponible",color:"#e2e8f0"},{label:"Solicitada",value:"solicitada",color:"#93c5fd"},{label:"Pendiente",value:"pendiente",color:"#fde047"},{label:"Entregada",value:"entregada",color:"#86efac"},{label:"Desactivada",value:"desactivada",color:"#1f2937"},{label:"Inviable",value:"inviable",color:"#fca5a5"}],className:"text-sm"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Notas (opcional)"}),t.jsx("textarea",{value:el,onChange:e=>eo(e.target.value),rows:3,className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Agregar notas sobre esta acci\xf3n..."})]})]}),(()=>{let e=Q.is_initial_config&&"desactivada"!==Q.status?"entregada":Q.status;return("entregada"===en||"entregada"===e)&&("admin"===eL||"super_admin"===eL)})()&&(0,t.jsxs)("div",{className:"mb-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Credenciales de Login"}),ej&&(0,t.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-1",children:[t.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Guardadas"]})]}),ey?t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:"Cargando credenciales..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-3",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:"URL de Login de la Plataforma"}),em?t.jsx("div",{className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:em}):t.jsx("div",{className:"w-full px-3 py-2 text-sm border border-yellow-300 dark:border-yellow-600 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400",children:'âš ï¸ URL no configurado. Config\xfaralo en "Gesti\xf3n de Plataformas"'}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Este URL es com\xfan para todas las modelos de esta plataforma"})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:["Usuario/Email ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:eg,onChange:e=>ex(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"usuario@ejemplo.com"})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:["Contrase\xf1a ",t.jsx("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("input",{type:eb?"text":"password",value:ep,onChange:e=>eh(e.target.value),className:"w-full px-3 py-2 pr-10 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),t.jsx("button",{type:"button",onClick:()=>ef(!eb),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:eb?"Ocultar contrase\xf1a":"Mostrar contrase\xf1a",children:eb?t.jsx(o.Z,{className:"w-4 h-4"}):t.jsx(f.Z,{className:"w-4 h-4"})})]})]}),t.jsx("button",{type:"button",onClick:e5,disabled:ed||!eg.trim()||!ep.trim(),className:"w-full px-3 py-2 text-xs font-medium bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ej?(0,t.jsxs)(t.Fragment,{children:[t.jsx(n.Z,{className:"w-4 h-4"}),ed?"Guardando...":"Actualizar Credenciales"]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(f.Z,{className:"w-4 h-4"}),ed?"Guardando...":"Guardar Credenciales"]})})]})]}),(()=>{let e=Q?.is_initial_config&&"desactivada"!==Q.status?"entregada":Q?.status,a="entregada"===en||"entregada"===e,r=Q&&(Q.platform_id?.toLowerCase()==="superfoon"||Q.platform_name?.toLowerCase().includes("superfoon"));return a&&("admin"===eL||"super_admin"===eL)&&r})()&&(0,t.jsxs)("div",{className:"mb-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Credenciales App 3CX"}),e$&&(0,t.jsxs)("span",{className:"text-xs text-purple-600 dark:text-purple-400 flex items-center gap-1",children:[t.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Guardadas"]})]}),eP?t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:"Cargando credenciales 3CX..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:["Usuario 3CX ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:e_,onChange:e=>eC(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"usuario@ejemplo.com"})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:["Contrase\xf1a 3CX ",t.jsx("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("input",{type:eE?"text":"password",value:eS,onChange:e=>eD(e.target.value),className:"w-full px-3 py-2 pr-10 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),t.jsx("button",{type:"button",onClick:()=>eA(!eE),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:eE?"Ocultar contrase\xf1a":"Mostrar contrase\xf1a",children:eE?t.jsx(o.Z,{className:"w-4 h-4"}):t.jsx(f.Z,{className:"w-4 h-4"})})]})]}),t.jsx("button",{type:"button",onClick:e3,disabled:ed||!e_.trim()||!eS.trim(),className:"w-full px-3 py-2 text-xs font-medium bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-200 shadow-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:e$?(0,t.jsxs)(t.Fragment,{children:[t.jsx(n.Z,{className:"w-4 h-4"}),ed?"Guardando...":"Actualizar Credenciales 3CX"]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(f.Z,{className:"w-4 h-4"}),ed?"Guardando...":"Guardar Credenciales 3CX"]})})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>er(!1),className:"flex-1 px-3 py-1.5 text-xs font-medium border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",disabled:ed,children:"Cancelar"}),t.jsx("button",{onClick:e6,disabled:ed,className:"flex-1 px-3 py-1.5 text-xs font-medium bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 shadow-md disabled:opacity-50",children:ed?"Procesando...":"Confirmar"})]})]})]}),eG&&eM&&eB&&t.jsx(D,{isOpen:eG,onClose:()=>{eq(!1),eI(null)},modelId:eM.id,modelName:eM.name,modelEmail:eM.email,userId:eB})]})})}},43995:(e,a,r)=>{"use strict";r.d(a,{Z:()=>o});var t=r(95344),s=r(3729),l=r(81202);function o({isOpen:e,onClose:a,children:r,title:o,maxWidthClass:d="max-w-lg",paddingClass:i="p-7",headerMarginClass:n="mb-5",formSpaceYClass:c="space-y-5",className:m="",showCloseButton:u=!0,closeOnBackdrop:g=!0}){let[x,p]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{if(!e)return;let a=document.body.style.overflow||"";return document.body.style.overflow="hidden",()=>{document.body.style.overflow=a}},[e]),(0,s.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,a]),(0,s.useEffect)(()=>{p(!0)},[]),!e||!x||"undefined"==typeof document||!document.body)return null;e&&console.log("\uD83D\uDD35 StandardModal: Renderizando modal",{isOpen:e,mounted:x,hasBody:!!document.body});let h=t.jsx("div",{onClick:()=>{g&&a()},"aria-modal":"true",role:"dialog",className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-[99999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99999},children:(0,t.jsxs)("div",{className:`${i} w-full ${d} max-h-[calc(100vh-2rem)] overflow-y-auto bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-2xl shadow-xl ${m}`,onClick:e=>e.stopPropagation(),style:{position:"relative",display:"block",visibility:"visible",opacity:1},children:[(o||u)&&(0,t.jsxs)("div",{className:`flex items-center justify-between ${n}`,children:[o?t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:o}):t.jsx("div",{}),u&&t.jsx("button",{onClick:a,className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Cerrar",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:c,children:r})]})});return(0,l.createPortal)(h,document.body)}},95269:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},66262:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},67970:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},2768:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},47958:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},18822:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t});let t=(0,r(97075).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},33265:(e,a,r)=>{"use strict";r.d(a,{W:()=>t});let t=e=>e?e.split("@")[0].split(".").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(""):""},24512:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>l,__esModule:()=>s,default:()=>o});let t=(0,r(86843).createProxy)(String.raw`C:\Users\camca\OneDrive\Documentos\GitHub\iam-sistema-de-gestion\app\admin\sedes\portafolio\page.tsx`),{__esModule:s,$$typeof:l}=t,o=t.default}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1638,6611,6654,1586,1582,1110,1881],()=>r(53426));module.exports=t})();