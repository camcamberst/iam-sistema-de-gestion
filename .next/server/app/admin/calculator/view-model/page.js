(()=>{var e={};e.id=8289,e.ids=[8289],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},23348:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>n});var t=a(50482),s=a(69108),l=a(62563),o=a.n(l),d=a(68300),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);a.d(r,i);let n=["",{children:["admin",{children:["calculator",{children:["view-model",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,931)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\calculator\\view-model\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,66294)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,41878)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\calculator\\view-model\\page.tsx"],m="/admin/calculator/view-model/page",u={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/calculator/view-model/page",pathname:"/admin/calculator/view-model",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},98e3:(e,r,a)=>{Promise.resolve().then(a.bind(a,91092))},91092:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>d});var t=a(95344),s=a(3729),l=a(22254),o=a(71145);function d(){let[e,r]=(0,s.useState)(null),[d,i]=(0,s.useState)([]),[n,c]=(0,s.useState)([]),[m,u]=(0,s.useState)(null),[x,g]=(0,s.useState)(!0),[p,h]=(0,s.useState)(null),[b,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)({}),[k,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[D,S]=(0,s.useState)(null),[C,M]=(0,s.useState)(null),[E,A]=(0,s.useState)(""),[I,$]=(0,s.useState)({}),[U,L]=(0,s.useState)(!1),[P,_]=(0,s.useState)([]),[O,T]=(0,s.useState)([]),[F,V]=(0,s.useState)("all"),[B,z]=(0,s.useState)(""),[q,R]=(0,s.useState)(""),G=(0,l.useRouter)(),W=a(72829).supabase;(0,s.useEffect)(()=>{if(!m||!m.calculatorData)return;let e=m.calculatorData.platforms,r=m.calculatorData.rates;if(!e||!r)return;let a=0,t=0;e.forEach(e=>{let s=f[e.id],l=m.calculatorData.values?.find(r=>r.platform_id===e.id||r.platform===e.name)?.value||0,o=void 0!==s?parseFloat(s)||0:l,d=0;"EUR"===e.currency?"big7"===e.id?d=o*(r.eur_usd||1.01)*.84:"mondo"===e.id?d=o*(r.eur_usd||1.01)*.78:(e.id,d=o*(r.eur_usd||1.01)):"GBP"===e.currency?d="aw"===e.id?o*(r.gbp_usd||1.2)*.677:o*(r.gbp_usd||1.2):"USD"===e.currency&&(d="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*o:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*o:"dxlive"===e.id?.6*o:"secretfriends"===e.id?.5*o:o),a+=d;let i="superfoon"===e.id?d:d*e.percentage/100;t+=i});let s=t*(r.usd_cop||3900),l=t/470*100,o=(m.calculatorData.periodDate||new Date().toLocaleDateString("en-CA",{timeZone:"America/Bogota"})).split("-"),d=parseInt(o[0]),i=parseInt(o[1]),n=parseInt(o[2]),c=`${d}-${String(i).padStart(2,"0")}-${n<=15?"01":"16"}`;S({usdBruto:a,usdModelo:t,copModelo:s,objetivoBasico:470,porcentajeAlcanzado:l,normalizedPeriodDate:c})},[f,m]),(0,s.useEffect)(()=>{let e=e=>{C&&!e.target.closest(".absolute.z-50")&&M(null)};if(C)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[C]),(0,s.useEffect)(()=>{(async()=>{try{g(!0);let{data:e}=await W.auth.getUser(),a=e?.user?.id;if(!a){r(null),g(!1);return}let{data:t}=await W.from("users").select("id,name,email,role").eq("id",a).single(),s=[];if(t&&"super_admin"!==t.role){let{data:e}=await W.from("user_groups").select("groups(name)").eq("user_id",a);s=(e||[]).map(e=>e.groups?.name).filter(Boolean)}r({id:t?.id||a,name:t?.name||e.user?.email?.split("@")[0]||"Usuario",email:t?.email||e.user?.email||"",role:t?.role||"modelo",groups:s,organization_id:"",is_active:!0,last_login:new Date().toISOString()}),await X(a)}catch(e){console.error("Error loading user:",e),h(e.message||"Error al cargar usuario")}finally{g(!1)}})()},[]),(0,s.useEffect)(()=>{if(n.length>0&&!m&&e){let e=new URLSearchParams(window.location.search).get("modelId");if(e){console.log("\uD83D\uDD0D [UX-FIX] Restaurando modelo desde URL:",e);let r=n.find(r=>r.id===e);if(r)console.log("✅ [UX-FIX] Modelo encontrado, restaurando:",r.name),Z(r,!1);else{console.warn("⚠️ [UX-FIX] Modelo no encontrado, limpiando URL");let e=new URL(window.location.href);e.searchParams.delete("modelId"),window.history.replaceState({},"",e.pathname+e.search)}}else console.log("\uD83D\uDD0D [UX-FIX] Entrada directa detectada, limpiando localStorage"),localStorage.removeItem("admin-selected-model-id")}},[n,m,e]);let X=async r=>{try{let a=await fetch(`/api/calculator/models?adminId=${r}`),t=await a.json();if(t.success){let r=t.models||[];c(r),i(r);let a=new Map;r.forEach(e=>{e.groups.forEach(e=>{e&&e.id&&e.name&&a.set(e.id,e)})});let s=Array.from(a.values());e&&"admin"===e.role&&(s=s.filter(r=>e.groups.includes(r.name))),T(s)}else h(t.error||"Error al cargar modelos")}catch(e){console.error("Error loading models:",e),h(e.message||"Error al cargar modelos")}},H=async r=>{try{console.log("\uD83D\uDD0D [ADMIN-TOTALS] Loading calculated totals for model:",r);let a=await fetch(`/api/calculator/admin-totals?modelId=${r}&adminId=${e?.id}`),t=await a.json();t.success?(console.log("✅ [ADMIN-TOTALS] Totals loaded:",t.totals),S(t.totals)):(console.error("❌ [ADMIN-TOTALS] Error loading totals:",t.error),S(null))}catch(e){console.error("❌ [ADMIN-TOTALS] Error loading totals:",e),S(null)}},Z=async(r,a=!0)=>{try{if(g(!0),h(null),a){let e=new URL(window.location.href);e.searchParams.set("modelId",r.id),window.history.replaceState({},"",e.pathname+e.search),localStorage.setItem("admin-selected-model-id",r.id),console.log("\uD83D\uDCBE [UX-FIX] Selecci\xf3n persistida:",r.name)}let t=await fetch(`/api/calculator/admin-view?modelId=${r.id}&adminId=${e?.id}`),s=await t.json();if(s.success){if(console.log("\uD83D\uDD0D [ADMIN-VIEW] Calculator data received:",s),console.log("\uD83D\uDD0D [ADMIN-VIEW] Platforms:",s.platforms),console.log("\uD83D\uDD0D [ADMIN-VIEW] Values:",s.values),console.log("\uD83D\uDD0D [ADMIN-VIEW] Values count:",s.values?.length||0),console.log("\uD83D\uDD0D [ADMIN-VIEW] Period date:",s.periodDate),u({...r,calculatorData:s}),s.periodDate){let e=s.periodDate.split("-"),r=parseInt(e[2],10);L(r>=16),console.log("\uD83D\uDD0D [ADMIN-VIEW] Period check:",{periodDate:s.periodDate,day:r,isP2:r>=16})}s.frozenPlatforms?(_(s.frozenPlatforms),console.log("\uD83E\uDDCA [ADMIN-VIEW] Frozen platforms:",s.frozenPlatforms)):_([]),await H(r.id)}else h(s.error||"Error al cargar datos de la calculadora")}catch(e){console.error("Error loading calculator data:",e),h(e.message||"Error al cargar datos de la calculadora")}finally{g(!1)}},J=e=>{z(e),K(F,e)},K=(e,r)=>{let a=n;if("all"!==e&&(a=a.filter(r=>r.groups.some(r=>r.id===e))),r.trim()){let e=r.toLowerCase().trim();a=a.filter(r=>r.name.toLowerCase().includes(e)||r.email.toLowerCase().includes(e)||r.email.split("@")[0].toLowerCase().includes(e))}i(a),q&&!a.find(e=>e.id===q)&&R("")},Q=(e,r)=>{console.log("\uD83D\uDD0D [VALUE-CHANGE] Platform:",e,"Value:",r),v(a=>{let t={...a,[e]:r};return console.log("\uD83D\uDD0D [VALUE-CHANGE] Updated editValues:",t),t}),j(!0)};(0,s.useEffect)(()=>{if(!m||!e||!k||b)return;console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Iniciando timer de autosave...");let r=new AbortController,a=setTimeout(async()=>{try{console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Ejecutando autosave despu\xe9s de 40 segundos de inactividad...");let e={};Object.entries(f).forEach(([r,a])=>{let t=Number.parseFloat(a)||0;e[r]=t});let a=await fetch("/api/calculator/model-values-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:m.id,values:e,periodDate:m.calculatorData.periodDate}),signal:r.signal}),t=await a.json();if(t.success){console.log("✅ [ADMIN-AUTOSAVE] Autosave completado exitosamente"),D&&(console.log("\uD83D\uDD04 [ADMIN-AUTOSAVE] Actualizando totales tambi\xe9n con fecha normalizada:",D.normalizedPeriodDate),await fetch("/api/calculator/totals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:m.id,periodDate:D.normalizedPeriodDate,totalUsdBruto:D.usdBruto,totalUsdModelo:D.usdModelo,totalCopModelo:D.copModelo}),signal:r.signal})),j(!1);let e=document.createElement("div");e.className="fixed top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50",e.innerHTML="Guardado autom\xe1tico completado",document.body.appendChild(e),setTimeout(()=>e.style.transform="translateX(0)",100),setTimeout(()=>{e.style.transform="translateX(100%)",setTimeout(()=>document.body.removeChild(e),300)},2e3)}else console.warn("⚠️ [ADMIN-AUTOSAVE] Error en autosave:",t.error)}catch(e){console.warn("⚠️ [ADMIN-AUTOSAVE] Excepci\xf3n en autosave:",e)}},4e4);return()=>{clearTimeout(a),r.abort()}},[f,m,e,k,b]);let Y=async()=>{if(m&&e){console.log("\uD83D\uDD0D [ADMIN-SAVE] Starting save process"),console.log("\uD83D\uDD0D [ADMIN-SAVE] Current editValues:",f),console.log("\uD83D\uDD0D [ADMIN-SAVE] Has changes:",k);try{y(!0),h(null);let e={};Object.entries(f).forEach(([r,a])=>{let t=Number.parseFloat(a)||0;e[r]=t}),console.log("\uD83D\uDD0D [ADMIN-EDIT] Saving values:",e);let r=await fetch("/api/calculator/model-values-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:m.id,values:e,periodDate:m.calculatorData.periodDate})}),a=await r.json();if(console.log("\uD83D\uDD0D [ADMIN-EDIT] Save result:",a),!a.success)throw Error(a.error||"Error al guardar");console.log("✅ [ADMIN-EDIT] Values saved successfully"),D&&(console.log("\uD83D\uDCBE [ADMIN-EDIT] Updating calculator_totals with normalized date:",{date:D.normalizedPeriodDate,totalUsdBruto:D.usdBruto,totalUsdModelo:D.usdModelo,totalCopModelo:D.copModelo}),await fetch("/api/calculator/totals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:m.id,periodDate:D.normalizedPeriodDate,totalUsdBruto:D.usdBruto,totalUsdModelo:D.usdModelo,totalCopModelo:D.copModelo})}),console.log("✅ [ADMIN-EDIT] Totals updated successfully")),v({}),j(!1),await Z(m);let t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50",t.innerHTML="Valores guardados correctamente",document.body.appendChild(t),setTimeout(()=>{t.style.transform="translateX(0)"},100),setTimeout(()=>{t.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(t)},300)},3e3)}catch(e){console.error("❌ [ADMIN-EDIT] Save error:",e),h(e.message||"Error al guardar valores")}finally{y(!1)}}};return x?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Cargando..."})]})}):p?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:t.jsx("div",{className:"relative bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 dark:border-gray-600/20 p-8 max-w-md dark:shadow-lg dark:shadow-red-900/15 dark:ring-0.5 dark:ring-red-400/20",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4 text-sm",children:p}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 text-sm shadow-md hover:shadow-lg transform hover:scale-105",children:"Reintentar"})]})})}):e&&("admin"===e.role||"super_admin"===e.role||"superadmin_aff"===e.role)?m?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-6 pt-16",children:[(0,t.jsxs)("div",{className:"mb-4 sm:mb-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:(0,t.jsxs)("button",{onClick:()=>{u(null),R(""),v({}),j(!1),L(!1),_([]),localStorage.removeItem("admin-selected-model-id");let e=new URL(window.location.href);e.searchParams.delete("modelId"),window.history.replaceState({},"",e.pathname+e.search),console.log("\uD83E\uDDF9 [UX-FIX] Selecci\xf3n limpiada")},className:"flex items-center space-x-1.5 sm:space-x-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors active:scale-95 touch-manipulation",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Volver"})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("h1",{className:"text-base sm:text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:["Calculadora de ",m.name]}),(0,t.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 text-xs sm:text-sm truncate",children:[m.email," • ",m.groups.map(e=>e.name).join(", ")]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 flex-shrink-0",children:[t.jsx("button",{onClick:()=>G.push(`/admin/model/calculator/historial?modelId=${m.id}`),className:"px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs font-medium bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:scale-95 touch-manipulation",children:"Historial"}),t.jsx("button",{onClick:Y,disabled:b||!k,className:`px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs font-medium rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-300 shadow-md transform hover:-translate-y-0.5 whitespace-nowrap active:scale-95 touch-manipulation ${k&&!b?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:b?"Guardando...":"Guardar"})]})]})]}),m.calculatorData?(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-4 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h2",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3 flex items-center",children:[t.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-blue-500 rounded-full mr-1.5 sm:mr-2"}),"Tasas Actualizadas"]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg sm:rounded-xl border border-blue-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-blue-700 mb-0.5 sm:mb-1",children:["$",m.calculatorData.rates?.usd_cop||3900]}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-blue-600 bg-blue-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD→COP"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg sm:rounded-xl border border-green-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[t.jsx("div",{className:"text-base sm:text-xl font-bold text-green-700 mb-0.5 sm:mb-1",children:m.calculatorData.rates?.eur_usd||1.01}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-green-600 bg-green-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"EUR→USD"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg sm:rounded-xl border border-purple-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[t.jsx("div",{className:"text-base sm:text-xl font-bold text-purple-700 mb-0.5 sm:mb-1",children:m.calculatorData.rates?.gbp_usd||1.2}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-purple-600 bg-purple-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"GBP→USD"})]})]}),t.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 mt-2 sm:mt-3 text-center font-medium",children:"Configuradas por tu administrador"})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-6 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h2",{className:"text-sm sm:text-base font-semibold text-gray-900 dark:text-gray-100 mb-3 sm:mb-4 flex items-center",children:[t.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-green-500 rounded-full mr-1.5 sm:mr-2"}),"Calculadora de Ingresos"]}),m.calculatorData.isConfigured&&m.calculatorData.platforms&&0!==m.calculatorData.platforms.length?(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"md:hidden space-y-3",children:m.calculatorData.platforms.map(e=>{let r=m.calculatorData.values?.find(r=>r.platform_id===e.id||r.platform===e.name)?.value||0,a=m.calculatorData.rates,s=0;"EUR"===e.currency?"big7"===e.id?s=r*(a?.eur_usd||1.01)*.84:"mondo"===e.id?s=r*(a?.eur_usd||1.01)*.78:(e.id,s=r*(a?.eur_usd||1.01)):"GBP"===e.currency?s="aw"===e.id?r*(a?.gbp_usd||1.2)*.677:r*(a?.gbp_usd||1.2):"USD"===e.currency&&(s="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*r:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*r:"dxlive"===e.id?.6*r:"secretfriends"===e.id?.5*r:r);let l="superfoon"===e.id?s:s*e.percentage/100,o=l*(a?.usd_cop||3900),d=P.includes(e.id);return I[e.id],(0,t.jsxs)("div",{className:`p-3 bg-gray-50 dark:bg-gray-600/50 rounded-lg border ${d?"border-gray-200 dark:border-gray-500":"border-gray-200 dark:border-gray-600"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Reparto: ","superfoon"===e.id?"100%":`${e.percentage}%`]})]}),d&&t.jsx("span",{className:"text-[10px] font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 px-1.5 py-0.5 rounded",children:"\uD83D\uDD12 Cerrado"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-1 block",children:"Valor"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",inputMode:"decimal",disabled:d,value:void 0!==f[e.id]?f[e.id]:r.toFixed(2),onChange:r=>{if(d)return;let a=r.target.value.replace(/[^0-9.,]/g,"").replace(",","."),t=a.split("."),s=t.length>2?`${t[0]}.${t.slice(1).join("")}`:a;Q(e.id,s)},className:`flex-1 px-2 py-1.5 text-sm font-medium rounded-lg border transition-all ${d?"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-500 cursor-not-allowed":"text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:d?"Locked":"0.00"}),t.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-600 px-2 py-1 rounded-md",children:e.currency||"USD"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"USD Bruto"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",s.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"USD Modelo"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",l.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-0.5",children:"COP Modelo"}),(0,t.jsxs)("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:["$",o.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})]})]},e.id)})}),t.jsx("div",{className:"hidden md:block overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[t.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"PLATAFORMAS"}),t.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"VALORES"}),t.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"USD BRUTO"}),t.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"USD MODELO"}),t.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700 dark:text-white text-sm",children:"COP MODELO"})]})}),t.jsx("tbody",{children:m.calculatorData.platforms.map(e=>{let r=m.calculatorData.values?.find(r=>r.platform_id===e.id||r.platform===e.name)?.value||0;console.log("\uD83D\uDD0D [ADMIN-VIEW] Platform:",e.name,"ID:",e.id,"Value:",r);let a=m.calculatorData.rates,s=0;"EUR"===e.currency?"big7"===e.id?s=r*(a?.eur_usd||1.01)*.84:"mondo"===e.id?s=r*(a?.eur_usd||1.01)*.78:(e.id,s=r*(a?.eur_usd||1.01)):"GBP"===e.currency?s="aw"===e.id?r*(a?.gbp_usd||1.2)*.677:r*(a?.gbp_usd||1.2):"USD"===e.currency&&(s="cmd"===e.id||"camlust"===e.id||"skypvt"===e.id?.75*r:"chaturbate"===e.id||"myfreecams"===e.id||"stripchat"===e.id?.05*r:"dxlive"===e.id?.6*r:"secretfriends"===e.id?.5*r:r);let l="superfoon"===e.id?s:s*e.percentage/100,o=l*(a?.usd_cop||3900),d=P.includes(e.id),i=I[e.id]||0;return(0,t.jsxs)("tr",{className:`border-b border-gray-100 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors duration-200 group ${d?"bg-gray-50/50 dark:bg-gray-800/50":""}`,children:[(0,t.jsxs)("td",{className:"py-3 px-3 relative",children:[(0,t.jsxs)("div",{className:`font-medium text-sm text-left transition-colors flex items-center gap-2 group ${d?"text-gray-400 dark:text-gray-500 cursor-not-allowed":U?"text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer":"text-gray-900 dark:text-gray-100 cursor-default"}`,onClick:r=>{r.stopPropagation(),!d&&U&&(M(e.id),A(String(I[e.id]||"")))},title:d?"Plataforma cerrada por horario europeo":U?"Click para ingresar valor de P1":"Solo disponible en el segundo periodo (16-Fin de mes)",children:[t.jsx("span",{className:`${!d&&U&&"underline decoration-dotted decoration-gray-400 underline-offset-2 hover:decoration-blue-500"}`,children:e.name}),!d&&U&&t.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-xs text-blue-500 transition-all duration-200 transform translate-x-[-4px] group-hover:translate-x-0",children:"✎"}),d&&t.jsx("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",children:"\uD83D\uDD12 Cerrado"})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Reparto: ","superfoon"===e.id?"100%":`${e.percentage}%`]}),i>0&&(0,t.jsxs)("div",{className:"mt-1 flex items-center gap-1 bg-blue-50 dark:bg-blue-900/20 px-1.5 py-0.5 rounded border border-blue-100 dark:border-blue-800/30 w-fit",children:[t.jsx("span",{className:"text-[10px] font-semibold text-blue-600 dark:text-blue-400",children:"P1:"}),t.jsx("span",{className:"text-[10px] font-mono text-blue-700 dark:text-blue-300",children:i.toLocaleString("es-CO")})]}),C===e.id&&!d&&U&&t.jsx("div",{className:"absolute z-50 bg-white dark:bg-gray-800 border border-blue-400 dark:border-blue-500 rounded-lg shadow-lg p-2",style:{top:"100%",left:"12px",marginTop:"4px"},onClick:e=>e.stopPropagation(),children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-[10px] font-medium text-gray-600 dark:text-gray-400 whitespace-nowrap",children:"P1:"}),t.jsx("input",{type:"text",inputMode:"decimal",value:E,onChange:e=>{A(e.target.value.replace(",","."))},onKeyDown:r=>{if("Enter"===r.key){let r=Number.parseFloat(E)||0;$(a=>({...a,[e.id]:r})),M(null)}else"Escape"===r.key&&M(null)},autoFocus:!0,className:"w-16 px-1.5 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"0.00"}),t.jsx("button",{onClick:()=>{let r=Number.parseFloat(E)||0;$(a=>({...a,[e.id]:r})),M(null)},className:"px-2 py-1 bg-blue-500 text-white rounded text-[10px] font-medium hover:bg-blue-600 transition-colors",title:"Guardar",children:"✓"}),t.jsx("button",{onClick:()=>{M(null)},className:"px-2 py-1 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded text-[10px] font-medium hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",title:"Cancelar",children:"✕"})]})})]}),t.jsx("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"text",inputMode:"decimal",disabled:d,value:void 0!==f[e.id]?f[e.id]:r.toFixed(2),onChange:r=>{if(d)return;let a=r.target.value.replace(/[^0-9.,]/g,"").replace(",","."),t=a.split("."),s=t.length>2?`${t[0]}.${t.slice(1).join("")}`:a;Q(e.id,s)},className:`w-24 px-3 py-2 text-sm font-medium transition-all duration-200 rounded-lg ${d?"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-500 cursor-not-allowed":"text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-300 dark:hover:border-gray-500 focus:shadow-lg focus:shadow-blue-100"}`,placeholder:d?"Locked":"0.00",title:d?"Plataforma cerrada por horario europeo":"Ingresa el valor generado"}),t.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-600 px-2 py-1 rounded-md",children:e.currency||"USD"})]}),void 0!==f[e.id]&&f[e.id]!==r.toFixed(2)&&t.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"})]})}),t.jsx("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",s.toFixed(2)," USD"]})}),t.jsx("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",l.toFixed(2)," USD"]})}),t.jsx("td",{className:"py-3 px-3",children:(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-300 font-medium text-sm",children:["$",o.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})," COP"]})})]},e.id)})})]})})]}):(0,t.jsxs)("div",{className:"text-center py-6 sm:py-8",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4"}),t.jsx("h4",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No hay plataformas habilitadas"}),t.jsx("p",{className:"text-sm sm:text-base text-gray-500 dark:text-gray-400 mb-3 sm:mb-4",children:"Esta modelo no tiene configuraci\xf3n de calculadora o plataformas habilitadas."}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-400 dark:text-gray-500",children:"Contacta al administrador para que configure las plataformas."})]})]}),m.calculatorData.platforms&&m.calculatorData.platforms.length>0&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-700/80 rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 dark:border-gray-600/20 p-3 sm:p-4 mb-3 sm:mb-4 hover:shadow-md transition-all duration-300 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[(0,t.jsxs)("h3",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3 flex items-center",children:[t.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-green-500 rounded-full mr-1.5 sm:mr-2"}),"Totales y Alertas"]}),D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg sm:rounded-xl border border-blue-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-blue-700 mb-0.5 sm:mb-1",children:["$",D.usdBruto.toFixed(2)]}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-blue-600 bg-blue-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD Bruto"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg sm:rounded-xl border border-green-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-green-700 mb-0.5 sm:mb-1",children:["$",D.usdModelo.toFixed(2)]}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-green-600 bg-green-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"USD Modelo"})]}),(0,t.jsxs)("div",{className:"text-center p-2 sm:p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg sm:rounded-xl border border-purple-200 hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[(0,t.jsxs)("div",{className:"text-base sm:text-xl font-bold text-purple-700 mb-0.5 sm:mb-1",children:["$",D.copModelo.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})]}),t.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-purple-600 bg-purple-200 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"COP Modelo"})]})]}),t.jsx("div",{className:"mb-6",children:(()=>{let e=Math.max(0,Math.min(100,D.porcentajeAlcanzado||0)),r={r:16,g:185,b:129},a=(e,r,a)=>({r:Math.round(e.r+(r.r-e.r)*a),g:Math.round(e.g+(r.g-e.g)*a),b:Math.round(e.b+(r.b-e.b)*a)}),s=e=>`#${[e.r,e.g,e.b].map(e=>e.toString(16).padStart(2,"0")).join("")}`,l=(e,r)=>a(e,{r:0,g:0,b:0},r),o=(e,r)=>a(e,{r:255,g:255,b:255},r),d=e/100,i=d<=.5?a({r:59,g:130,b:246},r,d/.5):a(r,{r:168,g:85,b:247},(d-.5)/.5),n=o(i,.35),c=s(o(n,.1)),m=s(l(n,.05));return(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-50/80 to-gray-100/80 dark:from-gray-700/50 dark:to-gray-800/50 backdrop-blur-sm rounded-lg sm:rounded-xl p-2.5 sm:p-4 border border-gray-200/50 dark:border-gray-600/30 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[t.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center shadow-sm",style:{background:`linear-gradient(135deg, ${s(l(i,0))}, ${s(l(i,.2))})`},children:t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100",children:["Objetivo B\xe1sico ",D.estaPorDebajo?"en Progreso":"Alcanzado"]}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:["Meta: $",D.cuotaMinima," USD"]})]})]}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-0.5 sm:py-1 rounded-lg text-white shadow-sm",style:{background:`linear-gradient(135deg, ${s(l(n,.05))}, ${s(l(n,.12))})`,border:`1px solid ${s(l(n,.25))}`},children:[e.toFixed(1),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200/80 dark:bg-gray-700/80 rounded-full h-3 sm:h-4 overflow-hidden shadow-inner mb-1.5 sm:mb-2",children:t.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out relative overflow-hidden",style:{width:`${e}%`,background:`linear-gradient(90deg, ${c}, ${m})`},children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent"})})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 pt-1.5 sm:pt-2 border-t border-gray-200/50 dark:border-gray-600/30",children:[(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-[9px] sm:text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-0.5 sm:mb-1",children:"Alcanzado"}),(0,t.jsxs)("div",{className:"inline-block px-2 sm:px-2.5 py-0.5 sm:py-1 rounded-md text-[10px] sm:text-xs font-bold text-white shadow-sm",style:{background:`linear-gradient(135deg, ${s(l(i,.15))}, ${s(l(i,.3))})`,border:`1px solid ${s(l(i,.45))}`},children:["$",Math.max(0,D.usdModelo).toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[t.jsx("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1",children:"Faltante"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:["$",Math.max(0,D.cuotaMinima-D.usdModelo).toFixed(2)," USD"]})]})]})]})})()}),t.jsx("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[t.jsx("strong",{children:"90% de anticipo disponible:"})," $",D.anticipoDisponible.toLocaleString("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0})," COP"]})})]}):(0,t.jsxs)("div",{className:"text-center py-4",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Calculando totales..."})]})]})]}):t.jsx("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-gray-400 mb-4"}),(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:["Calculadora de ",m.name]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Cargando datos de la calculadora..."}),t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})]})})]})}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-16",children:[t.jsx("div",{className:"mb-8 sm:mb-12",children:(0,t.jsxs)("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-indigo-600/10 rounded-xl blur-xl"}),t.jsx("div",{className:"relative bg-white/80 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-white/20 dark:border-gray-600/20 shadow-lg dark:shadow-lg dark:shadow-blue-900/15 dark:ring-0.5 dark:ring-blue-400/20",children:t.jsx("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-3",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:t.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[t.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:"Ver Calculadora de Modelo"}),t.jsx("p",{className:"mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300 hidden sm:block",children:"Selecciona un modelo para ver y editar su calculadora"})]})]})})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 space-y-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15 z-[99999]",children:[O.length>0&&(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Filtrar por Grupo"}),t.jsx(o.Z,{options:[{value:"all",label:"Todos los grupos"},...O.map(e=>({value:e.id,label:e.name}))],value:F,onChange:e=>{V(e),K(e,B)},placeholder:"Selecciona un grupo",className:"text-sm"})]}),(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Buscar por Nombre"}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("input",{type:"text",value:B,onChange:e=>J(e.target.value),placeholder:"Buscar modelo...",className:"w-full px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:shadow-lg focus:shadow-blue-100 pr-10 text-gray-900 dark:text-gray-100"}),B&&t.jsx("button",{onClick:()=>J(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition-colors",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),B&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:['\uD83D\uDD0D Filtrando por: "',B,'" - ',d.length," resultado",1!==d.length?"s":""]})]}),(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Seleccionar Modelo"}),t.jsx(o.Z,{options:[{value:"",label:0===d.length?"No hay modelos disponibles":"Selecciona un modelo"},...d.map(e=>({value:e.id,label:e.email.split("@")[0],badge:e.currentConfig?.active?"Configurada":"Sin configurar",badgeColor:e.currentConfig?.active?"green":"gray"}))],value:q,onChange:e=>{if(R(e),e){let r=d.find(r=>r.id===e);r&&Z(r)}},placeholder:0===d.length?B?`No hay modelos que contengan "${B}"`:"No hay modelos disponibles":`${d.length} modelo${1!==d.length?"s":""} disponible${1!==d.length?"s":""}`,autoOpen:B.length>0&&d.length>0,className:"text-sm"}),q&&d.find(e=>e.id===q)&&t.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:(()=>{let e=d.find(e=>e.id===q);return e?(0,t.jsxs)(t.Fragment,{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:e.email.split("@")[0]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:e.email}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.groups.map(e=>t.jsx("span",{className:"inline-block px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 text-xs rounded-full",children:e.name},e.id))})]}):null})()}),0===d.length&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-600/80 rounded-lg text-center",children:[t.jsx("div",{className:"text-gray-400 mb-2 text-2xl",children:"\uD83D\uDC65"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:B||"all"!==F?"No se encontraron modelos con los filtros aplicados":"No hay modelos disponibles"}),(B||"all"!==F)&&t.jsx("button",{onClick:()=>{z(""),V("all"),R(""),i(n)},className:"px-3 py-1.5 text-xs font-medium bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 shadow-md",children:"Limpiar filtros"})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-600/80 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Mostrando ",d.length," de ",n.length," modelos"]}),"all"!==F&&(0,t.jsxs)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Filtrado por: ",O.find(e=>e.id===F)?.name]}),B&&(0,t.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:['B\xfasqueda: "',B,'"']})]})]})}),t.jsx("div",{className:"hidden lg:block lg:col-span-2",children:(0,t.jsxs)("div",{className:"relative bg-white/70 dark:bg-gray-700/70 backdrop-blur-sm rounded-xl shadow-md border border-white/20 dark:border-gray-600/20 p-6 dark:shadow-lg dark:shadow-blue-900/10 dark:ring-0.5 dark:ring-blue-500/15",children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Informaci\xf3n"}),q&&d.find(e=>e.id===q)?(0,t.jsxs)("div",{className:"text-center py-8",children:[t.jsx("div",{className:"text-green-500 mb-4 text-4xl",children:"✅"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Modelo seleccionado"}),(0,t.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:[d.find(e=>e.id===q)?.email.split("@")[0]," est\xe1 listo para ver su calculadora"]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"La calculadora se abrir\xe1 autom\xe1ticamente"})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-gray-400 mb-4 text-4xl",children:"\uD83D\uDC48"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Selecciona un modelo"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Usa los filtros de la izquierda para encontrar y seleccionar un modelo"})]})]})})]})]})}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center pt-16",children:t.jsx("div",{className:"relative bg-white/80 dark:bg-gray-700/80 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 dark:border-gray-600/20 p-8 max-w-md dark:shadow-lg dark:shadow-red-900/15 dark:ring-0.5 dark:ring-red-400/20",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),t.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4 text-sm",children:"No tienes permisos para acceder a esta funci\xf3n"}),t.jsx("button",{onClick:()=>G.push("/admin/dashboard"),className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 text-sm shadow-md hover:shadow-lg transform hover:scale-105",children:"Volver al Dashboard"})]})})})}},71145:(e,r,a)=>{"use strict";a.d(r,{Z:()=>o});var t=a(95344),s=a(3729);let l={green:"bg-green-100 text-green-800",blue:"bg-blue-100 text-blue-800",red:"bg-red-100 text-red-800",yellow:"bg-yellow-100 text-yellow-800",gray:"bg-gray-100 text-gray-800"};function o({options:e,value:r,onChange:a,placeholder:o="Selecciona una opci\xf3n",className:d="",disabled:i=!1,maxHeight:n="max-h-60",autoOpen:c=!1}){let[m,u]=(0,s.useState)(!1),x=(0,s.useRef)(null);(0,s.useEffect)(()=>{c&&e.length>1?u(!0):c||u(!1)},[c,e.length]),(0,s.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&u(!1)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,s.useEffect)(()=>{m&&x.current&&setTimeout(()=>{x.current?.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[m]);let g=e.find(e=>e.value===r),p=e=>{a(e),u(!1)};return(0,t.jsxs)("div",{className:`relative ${d}`,ref:x,children:[t.jsx("button",{type:"button",className:`w-full px-3 py-2 text-sm text-left border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 cursor-pointer flex items-center justify-between hover:border-gray-400 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/50 transition-all duration-200 ${i?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!i&&u(!m),disabled:i,"aria-haspopup":"listbox","aria-expanded":m,children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[t.jsx("span",{className:g?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:g?g.label:o}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[g?.badge&&t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${l[g.badgeColor||"gray"]}`,children:g.badge}),t.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),m&&t.jsx("div",{className:`absolute z-[99998] w-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg dark:shadow-lg dark:shadow-cyan-900/10 dark:ring-0.5 dark:ring-cyan-500/15 ${n} overflow-auto apple-scroll`,children:0===e.length?t.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:"No hay opciones disponibles"}):e.map((e,a)=>(0,t.jsxs)("div",{children:[a>0&&t.jsx("div",{className:"w-full h-px bg-gray-100 dark:bg-gray-600/50 dark:shadow-sm dark:shadow-blue-900/10"}),(0,t.jsxs)("div",{className:`px-4 py-3 text-sm cursor-pointer transition-colors duration-150 flex items-center justify-between ${e.disabled?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"} ${e.value===r?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100":""}`,onClick:()=>!e.disabled&&p(e.value),children:[t.jsx("span",{children:e.label}),e.badge&&t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${l[e.badgeColor||"gray"]}`,children:e.badge})]})]},e.value))})]})}},97075:(e,r,a)=>{"use strict";a.d(r,{Z:()=>m});var t=a(3729);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),o=e=>{let r=l(e);return r.charAt(0).toUpperCase()+r.slice(1)},d=(...e)=>e.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim(),i=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:l="",children:o,iconNode:c,...m},u)=>(0,t.createElement)("svg",{ref:u,...n,width:r,height:r,stroke:e,strokeWidth:s?24*Number(a)/Number(r):a,className:d("lucide",l),...!o&&!i(m)&&{"aria-hidden":"true"},...m},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),m=(e,r)=>{let a=(0,t.forwardRef)(({className:a,...l},i)=>(0,t.createElement)(c,{ref:i,iconNode:r,className:d(`lucide-${s(o(e))}`,`lucide-${e}`,a),...l}));return a.displayName=o(e),a}},25545:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(97075).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},931:(e,r,a)=>{"use strict";a.r(r),a.d(r,{$$typeof:()=>l,__esModule:()=>s,default:()=>o});let t=(0,a(86843).createProxy)(String.raw`C:\Users\camca\OneDrive\Documentos\GitHub\iam-sistema-de-gestion\app\admin\calculator\view-model\page.tsx`),{__esModule:s,$$typeof:l}=t,o=t.default}};var r=require("../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[1638,6611,6654,1586,1582,1110],()=>a(23348));module.exports=t})();