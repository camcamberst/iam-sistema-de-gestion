(()=>{var e={};e.id=3708,e.ids=[3708],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},68084:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o});var s=r(50482),a=r(69108),i=r(62563),l=r.n(i),n=r(68300),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(t,d);let o=["",{children:["admin",{children:["audit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,70663)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\audit\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,66294)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,41878)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\audit\\page.tsx"],u="/admin/audit/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/audit/page",pathname:"/admin/audit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},94703:(e,t,r)=>{Promise.resolve().then(r.bind(r,74704))},74704:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(95344),a=r(3729),i=r(71145);function l(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[n,d]=(0,a.useState)({severity:"",action:"",success:""});(0,a.useEffect)(()=>{o()},[n]);let o=async()=>{try{l(!0);let e=await fetch("/api/audit"),r=await e.json();r.success&&t(r.logs)}catch(e){console.error("Error cargando logs:",e)}finally{l(!1)}},c=e=>{switch(e){case"critical":return"text-red-500 bg-red-900";case"high":return"text-orange-500 bg-orange-900";case"medium":return"text-yellow-500 bg-yellow-900";case"low":return"text-green-500 bg-green-900";default:return"text-gray-500 bg-gray-900"}},u=e.filter(e=>(!n.severity||e.severity===n.severity)&&(!n.action||!!e.action.includes(n.action))&&(""===n.success||e.success.toString()===n.success));return s.jsx("div",{className:"min-h-screen",style:{background:"radial-gradient(1200px 800px at 10% -10%, rgba(255,255,255,0.08), transparent), linear-gradient(180deg, rgb(16 18 27), rgb(16 18 27))"},children:(0,s.jsxs)("div",{className:"p-6",children:[s.jsx("h1",{className:"text-4xl font-bold text-white mb-6",children:"Auditor\xeda del Sistema"}),(0,s.jsxs)("div",{className:"bg-aim-card border border-aim-border rounded-xl p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Filtros"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Severidad"}),s.jsx(i.Z,{options:[{value:"",label:"Todas"},{value:"low",label:"Baja",badgeColor:"green"},{value:"medium",label:"Media",badgeColor:"yellow"},{value:"high",label:"Alta",badgeColor:"red"},{value:"critical",label:"Cr\xedtica",badgeColor:"red"}],value:n.severity,onChange:e=>d({...n,severity:e}),placeholder:"Todas las severidades",className:"bg-gray-800 border-gray-600 text-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Acci\xf3n"}),s.jsx("input",{type:"text",value:n.action,onChange:e=>d({...n,action:e.target.value}),placeholder:"Buscar acci\xf3n...",className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Estado"}),s.jsx(i.Z,{options:[{value:"",label:"Todos"},{value:"true",label:"Exitoso",badgeColor:"green"},{value:"false",label:"Fallido",badgeColor:"red"}],value:n.success,onChange:e=>d({...n,success:e}),placeholder:"Todos los estados",className:"bg-gray-800 border-gray-600 text-white"})]})]})]}),s.jsx("div",{className:"bg-aim-card border border-aim-border rounded-xl",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-white mb-4",children:["Logs de Auditor\xeda (",u.length,")"]}),r?s.jsx("div",{className:"text-center py-12",children:s.jsx("div",{className:"text-white text-xl",children:"Cargando logs..."})}):0===u.length?s.jsx("div",{className:"text-center py-12",children:s.jsx("div",{className:"text-gray-400 text-lg",children:"No hay logs disponibles"})}):s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-left text-sm",children:[s.jsx("thead",{className:"border-b border-aim-border",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Timestamp"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Usuario"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Acci\xf3n"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Severidad"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Descripci\xf3n"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"Estado"}),s.jsx("th",{className:"px-6 py-4 text-gray-300 font-medium",children:"IP"})]})}),s.jsx("tbody",{children:u.map(e=>(0,s.jsxs)("tr",{className:"border-b border-aim-border hover:bg-gray-800/50",children:[s.jsx("td",{className:"px-6 py-4 text-gray-400",children:new Date(e.timestamp).toLocaleString()}),(0,s.jsxs)("td",{className:"px-6 py-4 text-white",children:[e.user_id.slice(0,8),"..."]}),s.jsx("td",{className:"px-6 py-4 text-white",children:e.action}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${c(e.severity)}`,children:e.severity.toUpperCase()})}),s.jsx("td",{className:"px-6 py-4 text-white",children:e.description}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.success?"text-green-400 bg-green-900":"text-red-400 bg-red-900"}`,children:e.success?"\xc9XITO":"FALLIDO"})}),s.jsx("td",{className:"px-6 py-4 text-gray-400",children:e.ip_address||"N/A"})]},e.id))})]})})]})})]})})}},71145:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(95344),a=r(3729);let i={green:"bg-green-100 text-green-800",blue:"bg-blue-100 text-blue-800",red:"bg-red-100 text-red-800",yellow:"bg-yellow-100 text-yellow-800",gray:"bg-gray-100 text-gray-800"};function l({options:e,value:t,onChange:r,placeholder:l="Selecciona una opci\xf3n",className:n="",disabled:d=!1,maxHeight:o="max-h-60",autoOpen:c=!1}){let[u,x]=(0,a.useState)(!1),m=(0,a.useRef)(null);(0,a.useEffect)(()=>{c&&e.length>1?x(!0):c||x(!1)},[c,e.length]),(0,a.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&x(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&x(!1)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,a.useEffect)(()=>{u&&m.current&&setTimeout(()=>{m.current?.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[u]);let g=e.find(e=>e.value===t),p=e=>{r(e),x(!1)};return(0,s.jsxs)("div",{className:`relative ${n}`,ref:m,children:[s.jsx("button",{type:"button",className:`w-full px-3 py-2 text-sm text-left border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 cursor-pointer flex items-center justify-between hover:border-gray-400 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/50 transition-all duration-200 ${d?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!d&&x(!u),disabled:d,"aria-haspopup":"listbox","aria-expanded":u,children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[s.jsx("span",{className:g?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:g?g.label:l}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[g?.badge&&s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${i[g.badgeColor||"gray"]}`,children:g.badge}),s.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),u&&s.jsx("div",{className:`absolute z-[99998] w-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg dark:shadow-lg dark:shadow-cyan-900/10 dark:ring-0.5 dark:ring-cyan-500/15 ${o} overflow-auto apple-scroll`,children:0===e.length?s.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:"No hay opciones disponibles"}):e.map((e,r)=>(0,s.jsxs)("div",{children:[r>0&&s.jsx("div",{className:"w-full h-px bg-gray-100 dark:bg-gray-600/50 dark:shadow-sm dark:shadow-blue-900/10"}),(0,s.jsxs)("div",{className:`px-4 py-3 text-sm cursor-pointer transition-colors duration-150 flex items-center justify-between ${e.disabled?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"} ${e.value===t?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100":""}`,onClick:()=>!e.disabled&&p(e.value),children:[s.jsx("span",{children:e.label}),e.badge&&s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${i[e.badgeColor||"gray"]}`,children:e.badge})]})]},e.value))})]})}},97075:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(3729);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),l=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:i="",children:l,iconNode:c,...u},x)=>(0,s.createElement)("svg",{ref:x,...o,width:t,height:t,stroke:e,strokeWidth:a?24*Number(r)/Number(t):r,className:n("lucide",i),...!l&&!d(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(l)?l:[l]])),u=(e,t)=>{let r=(0,s.forwardRef)(({className:r,...i},d)=>(0,s.createElement)(c,{ref:d,iconNode:t,className:n(`lucide-${a(l(e))}`,`lucide-${e}`,r),...i}));return r.displayName=l(e),r}},25545:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(97075).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},70663:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let s=(0,r(86843).createProxy)(String.raw`C:\Users\camca\OneDrive\Documentos\GitHub\iam-sistema-de-gestion\app\admin\audit\page.tsx`),{__esModule:a,$$typeof:i}=s,l=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6611,6654,1586,1582,1110],()=>r(68084));module.exports=s})();