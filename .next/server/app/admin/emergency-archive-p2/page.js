(()=>{var e={};e.id=6035,e.ids=[6035],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},61474:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>n});var a=s(50482),o=s(69108),t=s(62563),l=s.n(t),i=s(68300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(r,d);let n=["",{children:["admin",{children:["emergency-archive-p2",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,34488)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\emergency-archive-p2\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,66294)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,41878)),"C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\camca\\OneDrive\\Documentos\\GitHub\\iam-sistema-de-gestion\\app\\admin\\emergency-archive-p2\\page.tsx"],u="/admin/emergency-archive-p2/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/admin/emergency-archive-p2/page",pathname:"/admin/emergency-archive-p2",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},46415:(e,r,s)=>{Promise.resolve().then(s.bind(s,21365))},21365:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>i});var a=s(95344),o=s(3729),t=s(22254),l=s(72829);function i(){let[e,r]=(0,o.useState)(!1),[s,i]=(0,o.useState)(!1),[d,n]=(0,o.useState)(!1),[c,u]=(0,o.useState)(!1),[m,h]=(0,o.useState)(null),[x,p]=(0,o.useState)(null),[b,g]=(0,o.useState)(null);(0,t.useRouter)();let v=async()=>{try{let{data:{session:e},error:r}=await l.supabase.auth.getSession();if(r)return console.error("Error obteniendo sesi\xf3n:",r),null;if(!e)return console.error("No hay sesi\xf3n activa"),null;let s=e.expires_at;if(s){let r=Math.floor(Date.now()/1e3);if(s-r<60){let{data:{session:r},error:s}=await l.supabase.auth.refreshSession();if(s)return console.error("Error refrescando sesi\xf3n:",s),e.access_token;if(r)return r.access_token}}return e.access_token}catch(e){return console.error("Error obteniendo token:",e),null}},y=async()=>{i(!0),g(null),p(null);try{let e=await v();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDD0D Verificando estado...");let r=await fetch("/api/admin/emergency-archive-p2/verify",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch{e={error:s||`Error ${r.status}: ${r.statusText}`}}throw console.error("âŒ Error en respuesta:",e),Error(e.error||`Error ${r.status}: ${r.statusText}`)}let s=await r.json();console.log("âœ… Verificaci\xf3n exitosa:",s),p(s)}catch(e){console.error("âŒ Error en handleVerify:",e),g(e.message||"Error desconocido")}finally{i(!1)}},D=async(e=!1)=>{if(confirm(e?'\uD83D\uDD25 \xbfEst\xe1s seguro de que quieres FORZAR la eliminaci\xf3n de TODOS los valores de P2 de diciembre?\n\nâš ï¸ PELIGRO: Esto eliminar\xe1 valores INCLUSO si NO est\xe1n archivados.\n\nSolo usa esto si est\xe1s seguro de que los valores ya fueron archivados o si necesitas resetear las calculadoras a "0".':'âš ï¸ \xbfEst\xe1s seguro de que quieres eliminar los valores de P2 de diciembre de "Mi Calculadora"?\n\nEsto eliminar\xe1 los valores de model_values SOLO si est\xe1n archivados en calculator_history.\n\nLos valores archivados en "Mi Historial" NO se ver\xe1n afectados.')){u(!0),g(null),h(null);try{let r;let s=await v();if(!s)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDDD1ï¸ Eliminando valores..."),console.log("\uD83D\uDD10 Token obtenido:",s.substring(0,20)+"...");let a=await fetch(e?"/api/admin/emergency-archive-p2/delete?force=true":"/api/admin/emergency-archive-p2/delete",{method:"DELETE",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});405===a.status&&(console.log("âš ï¸ DELETE no permitido, intentando con POST..."),a=await fetch(e?"/api/admin/emergency-archive-p2/delete?force=true":"/api/admin/emergency-archive-p2/delete",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:e?JSON.stringify({force:!0}):void 0})),console.log("\uD83D\uDCE1 Respuesta status:",a.status),console.log("\uD83D\uDCE1 Respuesta headers:",Object.fromEntries(a.headers.entries()));let o=await a.text();if(console.log("\uD83D\uDCE1 Respuesta body (raw):",o.substring(0,500)),!a.ok){let e;try{e=JSON.parse(o)}catch{e={error:o||`Error ${a.status}: ${a.statusText}`}}throw console.error("âŒ Error en respuesta:",e),Error(e.error||e.message||`Error ${a.status}: ${a.statusText}`)}try{r=JSON.parse(o)}catch{throw Error("Respuesta no v\xe1lida del servidor")}console.log("âœ… Eliminaci\xf3n exitosa:",r),h(r),setTimeout(()=>{y()},1e3)}catch(e){console.error("âŒ Error en handleDelete:",e),g(e.message||e.toString()||"Error desconocido"),console.error("âŒ Stack trace:",e.stack)}finally{u(!1)}}},f=async()=>{if(confirm("âš ï¸ \xbfEst\xe1s seguro de que quieres eliminar los registros archivados del per\xedodo P2 de diciembre?\n\nEsto permitir\xe1 volver a archivar con los valores correctos.")){n(!0),g(null),h(null);try{let e=await v();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83E\uDDF9 Limpiando registros incorrectos...");let r=await fetch("/api/admin/emergency-archive-p2/clean",{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch{e={error:s||`Error ${r.status}: ${r.statusText}`}}throw console.error("âŒ Error en respuesta:",e),Error(e.error||`Error ${r.status}: ${r.statusText}`)}let s=await r.json();console.log("âœ… Limpieza exitosa:",s),h(s),setTimeout(()=>{y()},1e3)}catch(e){console.error("âŒ Error en handleClean:",e),g(e.message||"Error desconocido")}finally{n(!1)}}},j=async()=>{if(confirm("\xbfEst\xe1s seguro de que quieres archivar el per\xedodo 16-31 de diciembre?\n\nEsto archivar\xe1 los valores en calculator_history pero NO eliminar\xe1 los valores de model_values.")){r(!0),g(null),h(null);try{let e=await v();if(!e)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDE80 Iniciando archivado...");let r=await fetch("/api/admin/emergency-archive-p2",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(console.log("\uD83D\uDCE1 Respuesta status:",r.status),!r.ok){let e;let s=await r.text();try{e=JSON.parse(s)}catch{e={error:s||`Error ${r.status}: ${r.statusText}`}}throw console.error("âŒ Error en respuesta:",e),Error(e.error||`Error ${r.status}: ${r.statusText}`)}let s=await r.json();console.log("âœ… Archivado exitoso:",s),h(s),setTimeout(()=>{y()},1e3)}catch(e){console.error("âŒ Error en handleArchive:",e),g(e.message||"Error desconocido")}finally{r(!1)}}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4 sm:p-6 lg:p-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 sm:p-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDEA8 Archivado de Emergencia: P2 de Diciembre 2025"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Archiva los valores por plataforma del per\xedodo 16-31 de diciembre en calculator_history"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6",children:[a.jsx("h2",{className:"font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"âš ï¸ IMPORTANTE:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-sm text-yellow-700 dark:text-yellow-300 space-y-1",children:[a.jsx("li",{children:"Este proceso SOLO archiva, NO elimina valores de model_values"}),a.jsx("li",{children:"Los valores se mantienen en model_values para verificaci\xf3n"}),a.jsx("li",{children:"Solo archiva valores hasta las 23:59:59 del 31 de diciembre"}),a.jsx("li",{children:"Una vez verificado, puedes eliminar los valores residuales manualmente"})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-3",children:[a.jsx("button",{onClick:y,disabled:s||e||d||c,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:s?"â³ Verificando...":"\uD83D\uDD0D Verificar Estado"}),a.jsx("button",{onClick:f,disabled:e||s||d||c,className:"px-6 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:d?"â³ Limpiando...":"\uD83E\uDDF9 Limpiar Registros Incorrectos"}),a.jsx("button",{onClick:j,disabled:e||s||d||c,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:e?"â³ Archivando...":"\uD83D\uDE80 Archivar P2 de Diciembre"}),a.jsx("button",{onClick:()=>D(!1),disabled:e||s||d||c,className:"px-6 py-3 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:c?"â³ Eliminando...":"\uD83D\uDDD1ï¸ Eliminar Valores de Mi Calculadora"}),a.jsx("button",{onClick:()=>D(!0),disabled:e||s||d||c,className:"px-6 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed active:scale-95 touch-manipulation",children:c?"â³ Eliminando...":"\uD83D\uDD25 Forzar Eliminaci\xf3n (Sin Verificar Archivo)"})]}),(0,a.jsxs)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border-2 border-red-300 dark:border-red-700 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:"\uD83D\uDD04 Reset Completo de Calculadora:"}),(0,a.jsxs)("p",{className:"text-sm text-red-700 dark:text-red-300 mb-3",children:[a.jsx("strong",{children:"âš ï¸ PELIGRO:"})," Esto eliminar\xe1 TODOS los valores y totales de la calculadora, sin importar el per\xedodo. \xdasalo solo si necesitas resetear completamente una calculadora a cero."]}),a.jsx("div",{className:"space-y-3",children:(0,a.jsxs)("div",{children:[a.jsx("input",{type:"text",placeholder:"ID del modelo (UUID) - Dejar vac\xedo para resetear TODOS",id:"reset-model-id",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("button",{onClick:async()=>{let e=document.getElementById("reset-model-id")?.value.trim(),r=!e,s=r?"\uD83D\uDD25 \xbfEst\xe1s seguro de que quieres RESETEAR COMPLETAMENTE TODAS las calculadoras?\n\nâš ï¸ PELIGRO EXTREMO: Esto eliminar\xe1 TODOS los valores y totales de TODAS las calculadoras, sin importar el per\xedodo.\n\nEsta acci\xf3n NO se puede deshacer.":`ðŸ”¥ \xbfEst\xe1s seguro de que quieres RESETEAR COMPLETAMENTE esta calculadora?

âš ï¸ PELIGRO: Esto eliminar\xe1 TODOS los valores y totales de esta calculadora, sin importar el per\xedodo.

Esta acci\xf3n NO se puede deshacer.`;if(confirm(s)){u(!0),g(null),h(null);try{let s=await v();if(!s)throw Error("No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.");console.log("\uD83D\uDD04 Reseteando calculadora(s)...");let a=await fetch("/api/admin/emergency-archive-p2/reset-calculator",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({modelId:e||null,resetAll:r})});if(!a.ok){let e;let r=await a.text();try{e=JSON.parse(r)}catch{e={error:r||`Error ${a.status}`}}throw Error(e.error||`Error ${a.status}`)}let o=await a.json();h(o),console.log("âœ… Reset completado:",o),setTimeout(()=>{y()},1e3)}catch(e){g(e.message||"Error desconocido")}finally{u(!1)}}},disabled:e||s||d||c,className:"w-full px-4 py-2 bg-red-700 hover:bg-red-800 disabled:bg-gray-400 text-white font-semibold rounded-lg shadow-md transition-colors duration-200 disabled:cursor-not-allowed",children:c?"â³ Reseteando...":"\uD83D\uDD04 Resetear Calculadora(s) a Cero"})]})})]}),(0,a.jsxs)("div",{className:"mb-6 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-amber-800 dark:text-amber-200 mb-2",children:"\uD83D\uDD0D Diagn\xf3stico:"}),a.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300 mb-3",children:"Si las calculadoras no quedan en cero despu\xe9s de eliminar, usa estas herramientas para diagnosticar el problema."}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{children:a.jsx("button",{onClick:async()=>{try{let e=await v();if(!e)throw Error("No hay sesi\xf3n activa");let r=await fetch("/api/admin/emergency-archive-p2/list-models-with-values?period=p2-december",{headers:{Authorization:`Bearer ${e}`}}),s=await r.json();console.log("\uD83D\uDCCB Modelos con valores P2:",s),s.success&&s.models?alert(`Se encontraron ${s.models.length} modelo(s) con valores en P2 de diciembre.

Revisa la consola del navegador para ver los detalles completos.`):alert("No se encontraron modelos con valores o hubo un error.")}catch(e){alert(`Error: ${e.message}`)}},className:"w-full px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg mb-2",children:"\uD83D\uDCCB Listar Modelos con Valores (P2 Diciembre)"})}),(0,a.jsxs)("div",{children:[a.jsx("input",{type:"text",placeholder:"ID del modelo (UUID) para diagn\xf3stico detallado",id:"diagnose-model-id",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("button",{onClick:async()=>{let e=document.getElementById("diagnose-model-id")?.value;if(!e){alert("Por favor ingresa un ID de modelo");return}try{let r=await v();if(!r)throw Error("No hay sesi\xf3n activa");let s=await fetch(`/api/admin/emergency-archive-p2/diagnose?modelId=${e}`,{headers:{Authorization:`Bearer ${r}`}}),a=await s.json();console.log("\uD83D\uDD0D Diagn\xf3stico detallado:",a),alert(`Diagn\xf3stico completado. Revisa la consola del navegador para ver los detalles.

Resumen:
- Total valores (todos per\xedodos): ${a.diagnostic?.summary?.total_values_all_periods||0}
- Valores P2 (todos): ${a.diagnostic?.summary?.p2_values_total||0}
- Valores P2 despu\xe9s del l\xedmite: ${a.diagnostic?.summary?.p2_values_after_limit||0}
- Total totales: ${a.diagnostic?.all_totals?.total||0}`)}catch(e){alert(`Error: ${e.message}`)}},className:"w-full px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg",children:"\uD83D\uDD0D Diagnosticar Modelo Espec\xedfico"})]})]})]}),x&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-3",children:"\uD83D\uDCCA Estado Actual:"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[a.jsx("strong",{children:"Registros en calculator_history:"})," ",x.resumen?.registros_en_history||0]}),(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[a.jsx("strong",{children:"Modelos archivados:"})," ",x.resumen?.modelos_en_history||0]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[a.jsx("strong",{children:"Valores en model_values:"})," ",x.resumen?.registros_en_model_values||0]}),(0,a.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[a.jsx("strong",{children:"Modelos con valores:"})," ",x.resumen?.modelos_en_model_values||0]})]})]}),x.resumen?.modelos_solo_en_model_values>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:[(0,a.jsxs)("p",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:["âš ï¸ ",x.resumen.modelos_solo_en_model_values," modelo(s) necesitan archivado"]}),x.detalles&&x.detalles.filter(e=>e.necesita_archivado).length>0&&(0,a.jsxs)("ul",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400 space-y-1 max-h-40 overflow-y-auto",children:[x.detalles.filter(e=>e.necesita_archivado).slice(0,10).map((e,r)=>(0,a.jsxs)("li",{children:["â€¢ ",e.email,": ",e.plataformas_en_model_values," plataforma(s)"]},r)),x.detalles.filter(e=>e.necesita_archivado).length>10&&(0,a.jsxs)("li",{children:["... y ",x.detalles.filter(e=>e.necesita_archivado).length-10," m\xe1s"]})]})]}),x.resumen?.registros_en_history===0&&a.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:a.jsx("p",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:"âš ï¸ No hay registros archivados. Ejecuta el archivado para crear el historial."})})]}),b&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:"âŒ Error:"}),a.jsx("p",{className:"text-red-700 dark:text-red-300",children:b})]}),m&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-green-800 dark:text-green-200 mb-2",children:"âœ… Resultado:"}),(0,a.jsxs)("div",{className:"text-sm text-green-700 dark:text-green-300 space-y-1",children:[m.mensaje&&a.jsx("p",{className:"font-semibold text-base mb-2",children:m.mensaje}),m.resumen&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Total modelos procesados:"})," ",m.resumen.total_modelos||0]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"âœ… Exitosos:"})," ",m.resumen.exitosos||0]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"âŒ Errores:"})," ",m.resumen.errores||0]}),void 0!==m.resumen.total_eliminados&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"\uD83D\uDDD1ï¸ Valores eliminados:"})," ",m.resumen.total_eliminados||0]}),void 0!==m.resumen.total_archivados&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"\uD83D\uDCE6 Registros archivados:"})," ",m.resumen.total_archivados||0]}),void 0!==m.resumen.modelos_omitidos&&m.resumen.modelos_omitidos>0&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"â­ï¸ Modelos omitidos (sin archivo):"})," ",m.resumen.modelos_omitidos||0]}),void 0!==m.resumen.modelos_sin_archivo&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"âš ï¸ Modelos sin archivo:"})," ",m.resumen.modelos_sin_archivo||0]}),void 0!==m.resumen.residuales_restantes&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"\uD83D\uDD0D Valores residuales restantes:"})," ",m.resumen.residuales_restantes||0]})]}),void 0!==m.eliminados&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"\uD83D\uDDD1ï¸ Total eliminados:"})," ",m.eliminados]})]})]}),m.resultados&&m.resultados.length>0&&(0,a.jsxs)(a.Fragment,{children:[m.resultados.filter(e=>!e.tiene_archivo).length>0&&(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:["â­ï¸ Modelos omitidos (sin archivo) (",m.resultados.filter(e=>!e.tiene_archivo).length,"):"]}),a.jsx("div",{className:"text-sm text-yellow-700 dark:text-yellow-300 space-y-2 max-h-60 overflow-y-auto",children:m.resultados.filter(e=>!e.tiene_archivo).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-yellow-200 dark:border-yellow-700 pb-2 last:border-0",children:[a.jsx("p",{className:"font-semibold",children:e.email}),a.jsx("p",{className:"text-xs opacity-90 mt-1",children:"â­ï¸ Omitido: No tiene archivo en calculator_history"}),void 0!==e.valores_en_model_values&&e.valores_en_model_values>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["\uD83D\uDCCA Valores en model_values: ",e.valores_en_model_values," (no eliminados por seguridad)"]})]},r))}),a.jsx("div",{className:"mt-3 pt-3 border-t border-yellow-200 dark:border-yellow-700",children:a.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:'\uD83D\uDCA1 Estos modelos fueron omitidos por seguridad. Si necesitas eliminar sus valores, primero arch\xedvalos con "\uD83D\uDE80 Archivar P2 de Diciembre".'})})]}),m.resultados.filter(e=>e.tiene_archivo&&e.error).length>0&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:["âŒ Modelos con errores (",m.resultados.filter(e=>e.tiene_archivo&&e.error).length,"):"]}),a.jsx("div",{className:"text-sm text-red-700 dark:text-red-300 space-y-2 max-h-60 overflow-y-auto",children:m.resultados.filter(e=>e.tiene_archivo&&e.error).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-red-200 dark:border-red-700 pb-2 last:border-0",children:[a.jsx("p",{className:"font-semibold",children:e.email}),a.jsx("p",{className:"text-xs opacity-90 mt-1 break-words",children:e.error}),e.plataformas>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["Plataformas: ",e.plataformas]}),void 0!==e.registros_archivados&&e.registros_archivados>0&&(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["Registros archivados: ",e.registros_archivados]})]},r))})]}),m.resultados.filter(e=>!e.error&&e.valores_eliminados>0).length>0&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"âœ… Modelos con valores eliminados exitosamente:"}),a.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-2 max-h-60 overflow-y-auto",children:m.resultados.filter(e=>!e.error&&e.valores_eliminados>0).map((e,r)=>(0,a.jsxs)("div",{className:"border-b border-blue-200 dark:border-blue-700 pb-2 last:border-0",children:[a.jsx("p",{className:"font-semibold",children:e.email}),(0,a.jsxs)("p",{className:"text-xs opacity-90 mt-1",children:["âœ… ",e.valores_eliminados," valor(es) eliminado(s)",e.registros_archivados>0&&` â€¢ ${e.registros_archivados} registro(s) archivado(s)`]})]},r))})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"\uD83D\uDCCB Pr\xf3ximos pasos:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside text-sm text-gray-700 dark:text-gray-300 space-y-1",children:[a.jsx("li",{children:'Verificar en "Mi Historial" que los datos se muestran correctamente'}),a.jsx("li",{children:"Verificar en calculator_history que los registros est\xe1n completos"}),a.jsx("li",{children:"Una vez verificado, puedes eliminar los valores residuales de model_values si lo deseas"})]})]})]})]})})})}},97075:(e,r,s)=>{"use strict";s.d(r,{Z:()=>u});var a=s(3729);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,s)=>s?s.toUpperCase():r.toLowerCase()),l=e=>{let r=t(e);return r.charAt(0).toUpperCase()+r.slice(1)},i=(...e)=>e.filter((e,r,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===r).join(" ").trim(),d=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,a.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:t="",children:l,iconNode:c,...u},m)=>(0,a.createElement)("svg",{ref:m,...n,width:r,height:r,stroke:e,strokeWidth:o?24*Number(s)/Number(r):s,className:i("lucide",t),...!l&&!d(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,r])=>(0,a.createElement)(e,r)),...Array.isArray(l)?l:[l]])),u=(e,r)=>{let s=(0,a.forwardRef)(({className:s,...t},d)=>(0,a.createElement)(c,{ref:d,iconNode:r,className:i(`lucide-${o(l(e))}`,`lucide-${e}`,s),...t}));return s.displayName=l(e),s}},25545:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});let a=(0,s(97075).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},34488:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>t,__esModule:()=>o,default:()=>l});let a=(0,s(86843).createProxy)(String.raw`C:\Users\camca\OneDrive\Documentos\GitHub\iam-sistema-de-gestion\app\admin\emergency-archive-p2\page.tsx`),{__esModule:o,$$typeof:t}=a,l=a.default}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[1638,6611,6654,1586,1582,1110],()=>s(61474));module.exports=a})();